import{aC as Sa,as as Ea,a0 as Sr,a7 as Pa,af as po,bC as Ct,a1 as ho,aF as mo,aR as In,bd as yo,aS as He,J as vo,b5 as $e,q as Qe,bf as qe,bD as Er,bi as go,ak as bo,bP as On,M as wo,bs as _o,u as To,v as xo,aK as So,aQ as Eo}from"./index-Ba6Rwkca.js";function Pr(s){return ho()?(mo(s),!0):!1}function ua(){const s=new Set,l=I=>{s.delete(I)};return{on:I=>{s.add(I);const F=()=>l(I);return Pr(F),{off:F}},off:l,trigger:(...I)=>Promise.all(Array.from(s).map(F=>F(...I))),clear:()=>{s.clear()}}}const dr=new WeakMap,Po=(...s)=>{var l;const d=s[0],f=(l=Sr())==null?void 0:l.proxy;if(f==null&&!Pa())throw new Error("injectLocal must be called in setup");return f&&dr.has(f)&&d in dr.get(f)?dr.get(f)[d]:po(...s)},Da=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Do=Object.prototype.toString,Io=s=>Do.call(s)==="[object Object]",Ia=()=>{},Oo=(s,l)=>Object.prototype.hasOwnProperty.call(s,l);function Co(...s){if(s.length!==1)return yo(...s);const l=s[0];return typeof l=="function"?In(vo(()=>({get:l,set:Ia}))):He(l)}function Ao(s,l){function d(...f){return new Promise((D,I)=>{Promise.resolve(s(()=>l.apply(this,f),{fn:l,thisArg:this,args:f})).then(D).catch(I)})}return d}const Oa=s=>s();function No(s=Oa,l={}){const{initialState:d="active"}=l,f=Co(d==="active");function D(){f.value=!1}function I(){f.value=!0}const F=(...C)=>{f.value&&s(...C)};return{isActive:In(f),pause:D,resume:I,eventFilter:F}}function Ro(s,l){var d;if(typeof s=="number")return s+l;const f=((d=s.match(/^-?\d+\.?\d*/))==null?void 0:d[0])||"",D=s.slice(f.length),I=Number.parseFloat(f)+l;return Number.isNaN(I)?s:I+D}function $t(s){return s.endsWith("rem")?Number.parseFloat(s)*16:Number.parseFloat(s)}function pr(s){return Array.isArray(s)?s:[s]}function ko(s){return Sr()}function Fo(s,l,d={}){const{eventFilter:f=Oa,...D}=d;return Ct(s,Ao(f,l),D)}function Lo(s,l,d={}){const{eventFilter:f,initialState:D="active",...I}=d,{eventFilter:F,pause:C,resume:B,isActive:$}=No(f,{initialState:D});return{stop:Fo(s,l,{...I,eventFilter:F}),pause:C,resume:B,isActive:$}}function Ca(s,l=!0,d){ko()?Sa(s,d):l?s():Ea(s)}function jo(s,l,d){return Ct(s,l,{...d,immediate:!0})}function fs(s,l,d){let f;bo(d)?f={evaluating:d}:f={};const{lazy:D=!1,flush:I="pre",evaluating:F=void 0,shallow:C=!0,onError:B=Ia}=f,$=$e(!D),Q=C?$e(l):He(l);let z=0;return Er(async ne=>{if(!$.value)return;z++;const W=z;let k=!1;F&&Promise.resolve().then(()=>{F.value=!0});try{const R=await s(H=>{ne(()=>{F&&(F.value=!1),k||H()})});W===z&&(Q.value=R)}catch(R){B(R)}finally{F&&W===z&&(F.value=!1),k=!0}},{flush:I}),D?Qe(()=>($.value=!0,Q.value)):Q}const Qt=Da?window:void 0,Mo=Da?window.document:void 0;function Aa(s){var l;const d=qe(s);return(l=d?.$el)!=null?l:d}function br(...s){const l=[],d=()=>{l.forEach(C=>C()),l.length=0},f=(C,B,$,Q)=>(C.addEventListener(B,$,Q),()=>C.removeEventListener(B,$,Q)),D=Qe(()=>{const C=pr(qe(s[0])).filter(B=>B!=null);return C.every(B=>typeof B!="string")?C:void 0}),I=jo(()=>{var C,B;return[(B=(C=D.value)==null?void 0:C.map($=>Aa($)))!=null?B:[Qt].filter($=>$!=null),pr(qe(D.value?s[1]:s[0])),pr(go(D.value?s[2]:s[1])),qe(D.value?s[3]:s[2])]},([C,B,$,Q])=>{if(d(),!C?.length||!B?.length||!$?.length)return;const z=Io(Q)?{...Q}:Q;l.push(...C.flatMap(ne=>B.flatMap(W=>$.map(k=>f(ne,W,k,z)))))},{flush:"post"}),F=()=>{I(),d()};return Pr(d),F}function Bo(){const s=$e(!1),l=Sr();return l&&Sa(()=>{s.value=!0},l),s}function Ko(s){const l=Bo();return Qe(()=>(l.value,!!s()))}const qo=Symbol("vueuse-ssr-width");function Na(){const s=Pa()?Po(qo,null):null;return typeof s=="number"?s:void 0}function Xt(s,l={}){const{window:d=Qt,ssrWidth:f=Na()}=l,D=Ko(()=>d&&"matchMedia"in d&&typeof d.matchMedia=="function"),I=$e(typeof f=="number"),F=$e(),C=$e(!1),B=$=>{C.value=$.matches};return Er(()=>{if(I.value){I.value=!D.value;const $=qe(s).split(",");C.value=$.some(Q=>{const z=Q.includes("not all"),ne=Q.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),W=Q.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let k=!!(ne||W);return ne&&k&&(k=f>=$t(ne[1])),W&&k&&(k=f<=$t(W[1])),z?!k:k});return}D.value&&(F.value=d.matchMedia(qe(s)),C.value=F.value.matches)}),br(F,"change",B,{passive:!0}),Qe(()=>C.value)}const ds={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};function ps(s,l={}){function d(W,k){let R=qe(s[qe(W)]);return k!=null&&(R=Ro(R,k)),typeof R=="number"&&(R=`${R}px`),R}const{window:f=Qt,strategy:D="min-width",ssrWidth:I=Na()}=l,F=typeof I=="number",C=F?$e(!1):{value:!0};F&&Ca(()=>C.value=!!f);function B(W,k){return!C.value&&F?W==="min"?I>=$t(k):I<=$t(k):f?f.matchMedia(`(${W}-width: ${k})`).matches:!1}const $=W=>Xt(()=>`(min-width: ${d(W)})`,l),Q=W=>Xt(()=>`(max-width: ${d(W)})`,l),z=Object.keys(s).reduce((W,k)=>(Object.defineProperty(W,k,{get:()=>D==="min-width"?$(k):Q(k),enumerable:!0,configurable:!0}),W),{});function ne(){const W=Object.keys(s).map(k=>[k,z[k],$t(d(k))]).sort((k,R)=>k[2]-R[2]);return Qe(()=>W.filter(([,k])=>k.value).map(([k])=>k))}return Object.assign(z,{greaterOrEqual:$,smallerOrEqual:Q,greater(W){return Xt(()=>`(min-width: ${d(W,.1)})`,l)},smaller(W){return Xt(()=>`(max-width: ${d(W,-.1)})`,l)},between(W,k){return Xt(()=>`(min-width: ${d(W)}) and (max-width: ${d(k,-.1)})`,l)},isGreater(W){return B("min",d(W,.1))},isGreaterOrEqual(W){return B("min",d(W))},isSmaller(W){return B("max",d(W,-.1))},isSmallerOrEqual(W){return B("max",d(W))},isInBetween(W,k){return B("min",d(W))&&B("max",d(k,-.1))},current:ne,active(){const W=ne();return Qe(()=>W.value.length===0?"":W.value.at(D==="min-width"?-1:0))}})}const En=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Pn="__vueuse_ssr_handlers__",Uo=Vo();function Vo(){return Pn in En||(En[Pn]=En[Pn]||{}),En[Pn]}function Go(s,l){return Uo[s]||l}function Wo(s){return s==null?"any":s instanceof Set?"set":s instanceof Map?"map":s instanceof Date?"date":typeof s=="boolean"?"boolean":typeof s=="string"?"string":typeof s=="object"?"object":Number.isNaN(s)?"any":"number"}const zo={boolean:{read:s=>s==="true",write:s=>String(s)},object:{read:s=>JSON.parse(s),write:s=>JSON.stringify(s)},number:{read:s=>Number.parseFloat(s),write:s=>String(s)},any:{read:s=>s,write:s=>String(s)},string:{read:s=>s,write:s=>String(s)},map:{read:s=>new Map(JSON.parse(s)),write:s=>JSON.stringify(Array.from(s.entries()))},set:{read:s=>new Set(JSON.parse(s)),write:s=>JSON.stringify(Array.from(s))},date:{read:s=>new Date(s),write:s=>s.toISOString()}},ca="vueuse-storage";function la(s,l,d,f={}){var D;const{flush:I="pre",deep:F=!0,listenToStorageChanges:C=!0,writeDefaults:B=!0,mergeDefaults:$=!1,shallow:Q,window:z=Qt,eventFilter:ne,onError:W=se=>{console.error(se)},initOnMounted:k}=f,R=(Q?$e:He)(typeof l=="function"?l():l),H=Qe(()=>qe(s));if(!d)try{d=Go("getDefaultStorage",()=>{var se;return(se=Qt)==null?void 0:se.localStorage})()}catch(se){W(se)}if(!d)return R;const ae=qe(l),be=Wo(ae),J=(D=f.serializer)!=null?D:zo[be],{pause:Y,resume:ie}=Lo(R,()=>ut(R.value),{flush:I,deep:F,eventFilter:ne});Ct(H,()=>de(),{flush:I});let fe=!1;const oe=se=>{k&&!fe||de(se)},Ie=se=>{k&&!fe||Re(se)};z&&C&&(d instanceof Storage?br(z,"storage",oe,{passive:!0}):br(z,ca,Ie)),k?Ca(()=>{fe=!0,de()}):de();function P(se,me){if(z){const Ee={key:H.value,oldValue:se,newValue:me,storageArea:d};z.dispatchEvent(d instanceof Storage?new StorageEvent("storage",Ee):new CustomEvent(ca,{detail:Ee}))}}function ut(se){try{const me=d.getItem(H.value);if(se==null)P(me,null),d.removeItem(H.value);else{const Ee=J.write(se);me!==Ee&&(d.setItem(H.value,Ee),P(me,Ee))}}catch(me){W(me)}}function Ue(se){const me=se?se.newValue:d.getItem(H.value);if(me==null)return B&&ae!=null&&d.setItem(H.value,J.write(ae)),ae;if(!se&&$){const Ee=J.read(me);return typeof $=="function"?$(Ee,ae):be==="object"&&!Array.isArray(Ee)?{...ae,...Ee}:Ee}else return typeof me!="string"?me:J.read(me)}function de(se){if(!(se&&se.storageArea!==d)){if(se&&se.key==null){R.value=ae;return}if(!(se&&se.key!==H.value)){Y();try{se?.newValue!==J.write(R.value)&&(R.value=Ue(se))}catch(me){W(me)}finally{se?Ea(ie):ie()}}}}function Re(se){de(se.detail)}return R}const Yo={multiple:!0,accept:"*",reset:!1,directory:!1};function Xo(s){if(!s)return null;if(s instanceof FileList)return s;const l=new DataTransfer;for(const d of s)l.items.add(d);return l.files}function fa(s={}){const{document:l=Mo}=s,d=He(Xo(s.initialFiles)),{on:f,trigger:D}=ua(),{on:I,trigger:F}=ua();let C;l&&(C=Aa(s.input)||l.createElement("input"),C.type="file",C.onchange=Q=>{const z=Q.target;d.value=z.files,D(d.value)},C.oncancel=()=>{F()});const B=()=>{d.value=null,C&&C.value&&(C.value="",D(null))},$=Q=>{if(!C)return;const z={...Yo,...s,...Q};C.multiple=z.multiple,C.accept=z.accept,C.webkitdirectory=z.directory,Oo(z,"capture")&&(C.capture=z.capture),z.reset&&B(),C.click()};return{files:In(d),open:$,reset:B,onCancel:I,onChange:f}}function $o(s){const l=$e(),d=()=>{l.value&&URL.revokeObjectURL(l.value),l.value=void 0};return Ct(()=>qe(s),f=>{d(),f&&(l.value=URL.createObjectURL(f))},{immediate:!0}),Pr(d),In(l)}const Ho=(s,l)=>{const d=s.__vccOpts||s;for(const[f,D]of l)d[f]=D;return d},Dr=On("extension",()=>{const s=He(null),l=He([]);return{extensions:l,setExtensions:D,activeExtensionId:s,setActiveExtension:d,clearActiveExtension:f};function d(I){s.value=I}function f(){s.value=null}function D(I){l.value=I}}),Qo=Ra("mainArea"),Jo=Ra("primarySidebar"),hs=On("menuContributionStore",()=>{const s=Dr();return{contributions:Qe(()=>s.extensions.map(d=>d.contributions.filter(f=>f.type==="menu").map(f=>f)).flat())}});function Ra(s){return On(`${s}Store`,()=>{const l=Dr(),d=He(),f=He();return{widgets:Qe(()=>l.extensions.map(F=>F.contributions.filter(C=>C.type==="widget"&&C.location===s).map(C=>C)).flat()),get activeWidget(){return d},activateWidget:I,unmountExtension:f};function I(F){d.value=F}})}function wr(s,l){const d=new URL(l),f=s.replace("/",""),D=d.pathname.split("/").filter(Boolean);return D.push(f),D.unshift(d.origin),D.join("/")}async function ms(s){const l=Dr(),d=await Zo(s);l.setExtensions(d)}async function Zo(s){const l=[];for(const d of s){let f,D="",I;try{if(I=Ir(window.location.href,d),f=await ti(I),D=await ni(I),!f)throw new Error(`could not fetch extension definition from ${d}`)}catch(C){console.error("Error fetching extension definition from",d,C);continue}const F={id:f.name,version:f.version,label:f.displayName,changelog:D,contributions:[...f.contributes.customEditors?.map(C=>da(C,I,"mainArea"))??[],...f.contributes.primarySidebars?.map(C=>da(C,I,"primarySidebar"))??[],...f.contributes.menu?.map(C=>ei(C,I))??[]]};l.push(F)}return l}function da(s,l,d){const f=ai(s);return{id:s.id,type:"widget",label:s.displayName,icon:s.icon?wr(s.icon,l):s.icon,location:d,startFnUrl:wr(s.entryPoint,l),iframe:f,defaultActive:s.defaultActive}}function ei(s,l){return{id:s.id,type:"menu",label:s.displayName,icon:s.icon,menuPath:s.path??[],actionFnUrl:wr(s.entryPoint,l)}}async function ti(s){try{const l=Ir(window.location.href,s),d=new URL("package.json",l).toString(),f=await fetch(d);if(!f.ok)throw new Error(`Failed to fetch package.json from ${d}`);return await f.json()}catch(l){throw console.error("Error fetching package.json:",l),l}}async function ni(s){try{const l=Ir(window.location.href,s),d=new URL("CHANGELOG.md",l).toString(),f=await fetch(d);if(!f.ok)throw new Error(`Failed to fetch CHANGELOG.md from ${d}`);return await f.text()}catch(l){throw console.error("Error fetching CHANGELOG.md:",l),l}}function Ir(s,l){if(ri(l)){const d=new URL(s);return new URL(l,d.origin).toString()}else return l}function ri(s){return s.startsWith("/")}function ai(s){let l=!1;return s.iframe!==void 0&&(l=s.iframe??!1),l}async function oi(s){const l=await import(s);if(!l.default)throw new Error(`Default export not found in the loaded module from ${s}`);return l.default}var ii=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ka(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function si(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var l=s.default;if(typeof l=="function"){var d=function f(){var D=!1;try{D=this instanceof f}catch{}return D?Reflect.construct(l,arguments,this.constructor):l.apply(this,arguments)};d.prototype=l.prototype}else d={};return Object.defineProperty(d,"__esModule",{value:!0}),Object.keys(s).forEach(function(f){var D=Object.getOwnPropertyDescriptor(s,f);Object.defineProperty(d,f,D.get?D:{enumerable:!0,get:function(){return s[f]}})}),d}var pa={};const ui={},ci=Object.freeze(Object.defineProperty({__proto__:null,default:ui},Symbol.toStringTag,{value:"Module"})),ha=si(ci);var ma;function li(){return ma||(ma=1,function(s){(function(l){l.parser=function(u,i){return new f(u,i)},l.SAXParser=f,l.SAXStream=Q,l.createStream=$,l.MAX_BUFFER_LENGTH=64*1024;var d=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];l.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function f(u,i){if(!(this instanceof f))return new f(u,i);var E=this;I(E),E.q=E.c="",E.bufferCheckPosition=l.MAX_BUFFER_LENGTH,E.opt=i||{},E.opt.lowercase=E.opt.lowercase||E.opt.lowercasetags,E.looseCase=E.opt.lowercase?"toLowerCase":"toUpperCase",E.tags=[],E.closed=E.closedRoot=E.sawRoot=!1,E.tag=E.error=null,E.strict=!!u,E.noscript=!!(u||E.opt.noscript),E.state=P.BEGIN,E.strictEntities=E.opt.strictEntities,E.ENTITIES=E.strictEntities?Object.create(l.XML_ENTITIES):Object.create(l.ENTITIES),E.attribList=[],E.opt.xmlns&&(E.ns=Object.create(R)),E.opt.unquotedAttributeValues===void 0&&(E.opt.unquotedAttributeValues=!u),E.trackPosition=E.opt.position!==!1,E.trackPosition&&(E.position=E.line=E.column=0),Ue(E,"onready")}Object.create||(Object.create=function(u){function i(){}i.prototype=u;var E=new i;return E}),Object.keys||(Object.keys=function(u){var i=[];for(var E in u)u.hasOwnProperty(E)&&i.push(E);return i});function D(u){for(var i=Math.max(l.MAX_BUFFER_LENGTH,10),E=0,x=0,ce=d.length;x<ce;x++){var Z=u[d[x]].length;if(Z>i)switch(d[x]){case"textNode":Re(u);break;case"cdata":de(u,"oncdata",u.cdata),u.cdata="";break;case"script":de(u,"onscript",u.script),u.script="";break;default:me(u,"Max buffer length exceeded: "+d[x])}E=Math.max(E,Z)}var ye=l.MAX_BUFFER_LENGTH-E;u.bufferCheckPosition=ye+u.position}function I(u){for(var i=0,E=d.length;i<E;i++)u[d[i]]=""}function F(u){Re(u),u.cdata!==""&&(de(u,"oncdata",u.cdata),u.cdata=""),u.script!==""&&(de(u,"onscript",u.script),u.script="")}f.prototype={end:function(){Ee(this)},write:Ze,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){F(this)}};var C;try{C=ha.Stream}catch{C=function(){}}C||(C=function(){});var B=l.EVENTS.filter(function(u){return u!=="error"&&u!=="end"});function $(u,i){return new Q(u,i)}function Q(u,i){if(!(this instanceof Q))return new Q(u,i);C.apply(this),this._parser=new f(u,i),this.writable=!0,this.readable=!0;var E=this;this._parser.onend=function(){E.emit("end")},this._parser.onerror=function(x){E.emit("error",x),E._parser.error=null},this._decoder=null,B.forEach(function(x){Object.defineProperty(E,"on"+x,{get:function(){return E._parser["on"+x]},set:function(ce){if(!ce)return E.removeAllListeners(x),E._parser["on"+x]=ce,ce;E.on(x,ce)},enumerable:!0,configurable:!1})})}Q.prototype=Object.create(C.prototype,{constructor:{value:Q}}),Q.prototype.write=function(u){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(u)){if(!this._decoder){var i=ha.StringDecoder;this._decoder=new i("utf8")}u=this._decoder.write(u)}return this._parser.write(u.toString()),this.emit("data",u),!0},Q.prototype.end=function(u){return u&&u.length&&this.write(u),this._parser.end(),!0},Q.prototype.on=function(u,i){var E=this;return!E._parser["on"+u]&&B.indexOf(u)!==-1&&(E._parser["on"+u]=function(){var x=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);x.splice(0,0,u),E.emit.apply(E,x)}),C.prototype.on.call(E,u,i)};var z="[CDATA[",ne="DOCTYPE",W="http://www.w3.org/XML/1998/namespace",k="http://www.w3.org/2000/xmlns/",R={xml:W,xmlns:k},H=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,ae=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,be=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,J=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function Y(u){return u===" "||u===`
`||u==="\r"||u==="	"}function ie(u){return u==='"'||u==="'"}function fe(u){return u===">"||Y(u)}function oe(u,i){return u.test(i)}function Ie(u,i){return!oe(u,i)}var P=0;l.STATE={BEGIN:P++,BEGIN_WHITESPACE:P++,TEXT:P++,TEXT_ENTITY:P++,OPEN_WAKA:P++,SGML_DECL:P++,SGML_DECL_QUOTED:P++,DOCTYPE:P++,DOCTYPE_QUOTED:P++,DOCTYPE_DTD:P++,DOCTYPE_DTD_QUOTED:P++,COMMENT_STARTING:P++,COMMENT:P++,COMMENT_ENDING:P++,COMMENT_ENDED:P++,CDATA:P++,CDATA_ENDING:P++,CDATA_ENDING_2:P++,PROC_INST:P++,PROC_INST_BODY:P++,PROC_INST_ENDING:P++,OPEN_TAG:P++,OPEN_TAG_SLASH:P++,ATTRIB:P++,ATTRIB_NAME:P++,ATTRIB_NAME_SAW_WHITE:P++,ATTRIB_VALUE:P++,ATTRIB_VALUE_QUOTED:P++,ATTRIB_VALUE_CLOSED:P++,ATTRIB_VALUE_UNQUOTED:P++,ATTRIB_VALUE_ENTITY_Q:P++,ATTRIB_VALUE_ENTITY_U:P++,CLOSE_TAG:P++,CLOSE_TAG_SAW_WHITE:P++,SCRIPT:P++,SCRIPT_ENDING:P++},l.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},l.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(l.ENTITIES).forEach(function(u){var i=l.ENTITIES[u],E=typeof i=="number"?String.fromCharCode(i):i;l.ENTITIES[u]=E});for(var ut in l.STATE)l.STATE[l.STATE[ut]]=ut;P=l.STATE;function Ue(u,i,E){u[i]&&u[i](E)}function de(u,i,E){u.textNode&&Re(u),Ue(u,i,E)}function Re(u){u.textNode=se(u.opt,u.textNode),u.textNode&&Ue(u,"ontext",u.textNode),u.textNode=""}function se(u,i){return u.trim&&(i=i.trim()),u.normalize&&(i=i.replace(/\s+/g," ")),i}function me(u,i){return Re(u),u.trackPosition&&(i+=`
Line: `+u.line+`
Column: `+u.column+`
Char: `+u.c),i=new Error(i),u.error=i,Ue(u,"onerror",i),u}function Ee(u){return u.sawRoot&&!u.closedRoot&&he(u,"Unclosed root tag"),u.state!==P.BEGIN&&u.state!==P.BEGIN_WHITESPACE&&u.state!==P.TEXT&&me(u,"Unexpected end"),Re(u),u.c="",u.closed=!0,Ue(u,"onend"),f.call(u,u.strict,u.opt),u}function he(u,i){if(typeof u!="object"||!(u instanceof f))throw new Error("bad call to strictFail");u.strict&&me(u,i)}function ze(u){u.strict||(u.tagName=u.tagName[u.looseCase]());var i=u.tags[u.tags.length-1]||u,E=u.tag={name:u.tagName,attributes:{}};u.opt.xmlns&&(E.ns=i.ns),u.attribList.length=0,de(u,"onopentagstart",E)}function Ve(u,i){var E=u.indexOf(":"),x=E<0?["",u]:u.split(":"),ce=x[0],Z=x[1];return i&&u==="xmlns"&&(ce="xmlns",Z=""),{prefix:ce,local:Z}}function Le(u){if(u.strict||(u.attribName=u.attribName[u.looseCase]()),u.attribList.indexOf(u.attribName)!==-1||u.tag.attributes.hasOwnProperty(u.attribName)){u.attribName=u.attribValue="";return}if(u.opt.xmlns){var i=Ve(u.attribName,!0),E=i.prefix,x=i.local;if(E==="xmlns")if(x==="xml"&&u.attribValue!==W)he(u,"xml: prefix must be bound to "+W+`
Actual: `+u.attribValue);else if(x==="xmlns"&&u.attribValue!==k)he(u,"xmlns: prefix must be bound to "+k+`
Actual: `+u.attribValue);else{var ce=u.tag,Z=u.tags[u.tags.length-1]||u;ce.ns===Z.ns&&(ce.ns=Object.create(Z.ns)),ce.ns[x]=u.attribValue}u.attribList.push([u.attribName,u.attribValue])}else u.tag.attributes[u.attribName]=u.attribValue,de(u,"onattribute",{name:u.attribName,value:u.attribValue});u.attribName=u.attribValue=""}function Be(u,i){if(u.opt.xmlns){var E=u.tag,x=Ve(u.tagName);E.prefix=x.prefix,E.local=x.local,E.uri=E.ns[x.prefix]||"",E.prefix&&!E.uri&&(he(u,"Unbound namespace prefix: "+JSON.stringify(u.tagName)),E.uri=x.prefix);var ce=u.tags[u.tags.length-1]||u;E.ns&&ce.ns!==E.ns&&Object.keys(E.ns).forEach(function(Rt){de(u,"onopennamespace",{prefix:Rt,uri:E.ns[Rt]})});for(var Z=0,ye=u.attribList.length;Z<ye;Z++){var Oe=u.attribList[Z],we=Oe[0],et=Oe[1],Se=Ve(we,!0),Ke=Se.prefix,An=Se.local,_t=Ke===""?"":E.ns[Ke]||"",Fe={name:we,value:et,prefix:Ke,local:An,uri:_t};Ke&&Ke!=="xmlns"&&!_t&&(he(u,"Unbound namespace prefix: "+JSON.stringify(Ke)),Fe.uri=Ke),u.tag.attributes[we]=Fe,de(u,"onattribute",Fe)}u.attribList.length=0}u.tag.isSelfClosing=!!i,u.sawRoot=!0,u.tags.push(u.tag),de(u,"onopentag",u.tag),i||(!u.noscript&&u.tagName.toLowerCase()==="script"?u.state=P.SCRIPT:u.state=P.TEXT,u.tag=null,u.tagName=""),u.attribName=u.attribValue="",u.attribList.length=0}function At(u){if(!u.tagName){he(u,"Weird empty close tag."),u.textNode+="</>",u.state=P.TEXT;return}if(u.script){if(u.tagName!=="script"){u.script+="</"+u.tagName+">",u.tagName="",u.state=P.SCRIPT;return}de(u,"onscript",u.script),u.script=""}var i=u.tags.length,E=u.tagName;u.strict||(E=E[u.looseCase]());for(var x=E;i--;){var ce=u.tags[i];if(ce.name!==x)he(u,"Unexpected close tag");else break}if(i<0){he(u,"Unmatched closing tag: "+u.tagName),u.textNode+="</"+u.tagName+">",u.state=P.TEXT;return}u.tagName=E;for(var Z=u.tags.length;Z-- >i;){var ye=u.tag=u.tags.pop();u.tagName=u.tag.name,de(u,"onclosetag",u.tagName);var Oe={};for(var we in ye.ns)Oe[we]=ye.ns[we];var et=u.tags[u.tags.length-1]||u;u.opt.xmlns&&ye.ns!==et.ns&&Object.keys(ye.ns).forEach(function(Se){var Ke=ye.ns[Se];de(u,"onclosenamespace",{prefix:Se,uri:Ke})})}i===0&&(u.closedRoot=!0),u.tagName=u.attribValue=u.attribName="",u.attribList.length=0,u.state=P.TEXT}function Je(u){var i=u.entity,E=i.toLowerCase(),x,ce="";return u.ENTITIES[i]?u.ENTITIES[i]:u.ENTITIES[E]?u.ENTITIES[E]:(i=E,i.charAt(0)==="#"&&(i.charAt(1)==="x"?(i=i.slice(2),x=parseInt(i,16),ce=x.toString(16)):(i=i.slice(1),x=parseInt(i,10),ce=x.toString(10))),i=i.replace(/^0+/,""),isNaN(x)||ce.toLowerCase()!==i?(he(u,"Invalid character entity"),"&"+u.entity+";"):String.fromCodePoint(x))}function Nt(u,i){i==="<"?(u.state=P.OPEN_WAKA,u.startTagPosition=u.position):Y(i)||(he(u,"Non-whitespace before first tag."),u.textNode=i,u.state=P.TEXT)}function ct(u,i){var E="";return i<u.length&&(E=u.charAt(i)),E}function Ze(u){var i=this;if(this.error)throw this.error;if(i.closed)return me(i,"Cannot write after close. Assign an onready handler.");if(u===null)return Ee(i);typeof u=="object"&&(u=u.toString());for(var E=0,x="";x=ct(u,E++),i.c=x,!!x;)switch(i.trackPosition&&(i.position++,x===`
`?(i.line++,i.column=0):i.column++),i.state){case P.BEGIN:if(i.state=P.BEGIN_WHITESPACE,x==="\uFEFF")continue;Nt(i,x);continue;case P.BEGIN_WHITESPACE:Nt(i,x);continue;case P.TEXT:if(i.sawRoot&&!i.closedRoot){for(var ce=E-1;x&&x!=="<"&&x!=="&";)x=ct(u,E++),x&&i.trackPosition&&(i.position++,x===`
`?(i.line++,i.column=0):i.column++);i.textNode+=u.substring(ce,E-1)}x==="<"&&!(i.sawRoot&&i.closedRoot&&!i.strict)?(i.state=P.OPEN_WAKA,i.startTagPosition=i.position):(!Y(x)&&(!i.sawRoot||i.closedRoot)&&he(i,"Text data outside of root node."),x==="&"?i.state=P.TEXT_ENTITY:i.textNode+=x);continue;case P.SCRIPT:x==="<"?i.state=P.SCRIPT_ENDING:i.script+=x;continue;case P.SCRIPT_ENDING:x==="/"?i.state=P.CLOSE_TAG:(i.script+="<"+x,i.state=P.SCRIPT);continue;case P.OPEN_WAKA:if(x==="!")i.state=P.SGML_DECL,i.sgmlDecl="";else if(!Y(x))if(oe(H,x))i.state=P.OPEN_TAG,i.tagName=x;else if(x==="/")i.state=P.CLOSE_TAG,i.tagName="";else if(x==="?")i.state=P.PROC_INST,i.procInstName=i.procInstBody="";else{if(he(i,"Unencoded <"),i.startTagPosition+1<i.position){var Z=i.position-i.startTagPosition;x=new Array(Z).join(" ")+x}i.textNode+="<"+x,i.state=P.TEXT}continue;case P.SGML_DECL:if(i.sgmlDecl+x==="--"){i.state=P.COMMENT,i.comment="",i.sgmlDecl="";continue}i.doctype&&i.doctype!==!0&&i.sgmlDecl?(i.state=P.DOCTYPE_DTD,i.doctype+="<!"+i.sgmlDecl+x,i.sgmlDecl=""):(i.sgmlDecl+x).toUpperCase()===z?(de(i,"onopencdata"),i.state=P.CDATA,i.sgmlDecl="",i.cdata=""):(i.sgmlDecl+x).toUpperCase()===ne?(i.state=P.DOCTYPE,(i.doctype||i.sawRoot)&&he(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):x===">"?(de(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=P.TEXT):(ie(x)&&(i.state=P.SGML_DECL_QUOTED),i.sgmlDecl+=x);continue;case P.SGML_DECL_QUOTED:x===i.q&&(i.state=P.SGML_DECL,i.q=""),i.sgmlDecl+=x;continue;case P.DOCTYPE:x===">"?(i.state=P.TEXT,de(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=x,x==="["?i.state=P.DOCTYPE_DTD:ie(x)&&(i.state=P.DOCTYPE_QUOTED,i.q=x));continue;case P.DOCTYPE_QUOTED:i.doctype+=x,x===i.q&&(i.q="",i.state=P.DOCTYPE);continue;case P.DOCTYPE_DTD:x==="]"?(i.doctype+=x,i.state=P.DOCTYPE):x==="<"?(i.state=P.OPEN_WAKA,i.startTagPosition=i.position):ie(x)?(i.doctype+=x,i.state=P.DOCTYPE_DTD_QUOTED,i.q=x):i.doctype+=x;continue;case P.DOCTYPE_DTD_QUOTED:i.doctype+=x,x===i.q&&(i.state=P.DOCTYPE_DTD,i.q="");continue;case P.COMMENT:x==="-"?i.state=P.COMMENT_ENDING:i.comment+=x;continue;case P.COMMENT_ENDING:x==="-"?(i.state=P.COMMENT_ENDED,i.comment=se(i.opt,i.comment),i.comment&&de(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+x,i.state=P.COMMENT);continue;case P.COMMENT_ENDED:x!==">"?(he(i,"Malformed comment"),i.comment+="--"+x,i.state=P.COMMENT):i.doctype&&i.doctype!==!0?i.state=P.DOCTYPE_DTD:i.state=P.TEXT;continue;case P.CDATA:x==="]"?i.state=P.CDATA_ENDING:i.cdata+=x;continue;case P.CDATA_ENDING:x==="]"?i.state=P.CDATA_ENDING_2:(i.cdata+="]"+x,i.state=P.CDATA);continue;case P.CDATA_ENDING_2:x===">"?(i.cdata&&de(i,"oncdata",i.cdata),de(i,"onclosecdata"),i.cdata="",i.state=P.TEXT):x==="]"?i.cdata+="]":(i.cdata+="]]"+x,i.state=P.CDATA);continue;case P.PROC_INST:x==="?"?i.state=P.PROC_INST_ENDING:Y(x)?i.state=P.PROC_INST_BODY:i.procInstName+=x;continue;case P.PROC_INST_BODY:if(!i.procInstBody&&Y(x))continue;x==="?"?i.state=P.PROC_INST_ENDING:i.procInstBody+=x;continue;case P.PROC_INST_ENDING:x===">"?(de(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=P.TEXT):(i.procInstBody+="?"+x,i.state=P.PROC_INST_BODY);continue;case P.OPEN_TAG:oe(ae,x)?i.tagName+=x:(ze(i),x===">"?Be(i):x==="/"?i.state=P.OPEN_TAG_SLASH:(Y(x)||he(i,"Invalid character in tag name"),i.state=P.ATTRIB));continue;case P.OPEN_TAG_SLASH:x===">"?(Be(i,!0),At(i)):(he(i,"Forward-slash in opening tag not followed by >"),i.state=P.ATTRIB);continue;case P.ATTRIB:if(Y(x))continue;x===">"?Be(i):x==="/"?i.state=P.OPEN_TAG_SLASH:oe(H,x)?(i.attribName=x,i.attribValue="",i.state=P.ATTRIB_NAME):he(i,"Invalid attribute name");continue;case P.ATTRIB_NAME:x==="="?i.state=P.ATTRIB_VALUE:x===">"?(he(i,"Attribute without value"),i.attribValue=i.attribName,Le(i),Be(i)):Y(x)?i.state=P.ATTRIB_NAME_SAW_WHITE:oe(ae,x)?i.attribName+=x:he(i,"Invalid attribute name");continue;case P.ATTRIB_NAME_SAW_WHITE:if(x==="=")i.state=P.ATTRIB_VALUE;else{if(Y(x))continue;he(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",de(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",x===">"?Be(i):oe(H,x)?(i.attribName=x,i.state=P.ATTRIB_NAME):(he(i,"Invalid attribute name"),i.state=P.ATTRIB)}continue;case P.ATTRIB_VALUE:if(Y(x))continue;ie(x)?(i.q=x,i.state=P.ATTRIB_VALUE_QUOTED):(i.opt.unquotedAttributeValues||me(i,"Unquoted attribute value"),i.state=P.ATTRIB_VALUE_UNQUOTED,i.attribValue=x);continue;case P.ATTRIB_VALUE_QUOTED:if(x!==i.q){x==="&"?i.state=P.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=x;continue}Le(i),i.q="",i.state=P.ATTRIB_VALUE_CLOSED;continue;case P.ATTRIB_VALUE_CLOSED:Y(x)?i.state=P.ATTRIB:x===">"?Be(i):x==="/"?i.state=P.OPEN_TAG_SLASH:oe(H,x)?(he(i,"No whitespace between attributes"),i.attribName=x,i.attribValue="",i.state=P.ATTRIB_NAME):he(i,"Invalid attribute name");continue;case P.ATTRIB_VALUE_UNQUOTED:if(!fe(x)){x==="&"?i.state=P.ATTRIB_VALUE_ENTITY_U:i.attribValue+=x;continue}Le(i),x===">"?Be(i):i.state=P.ATTRIB;continue;case P.CLOSE_TAG:if(i.tagName)x===">"?At(i):oe(ae,x)?i.tagName+=x:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=P.SCRIPT):(Y(x)||he(i,"Invalid tagname in closing tag"),i.state=P.CLOSE_TAG_SAW_WHITE);else{if(Y(x))continue;Ie(H,x)?i.script?(i.script+="</"+x,i.state=P.SCRIPT):he(i,"Invalid tagname in closing tag."):i.tagName=x}continue;case P.CLOSE_TAG_SAW_WHITE:if(Y(x))continue;x===">"?At(i):he(i,"Invalid characters in closing tag");continue;case P.TEXT_ENTITY:case P.ATTRIB_VALUE_ENTITY_Q:case P.ATTRIB_VALUE_ENTITY_U:var ye,Oe;switch(i.state){case P.TEXT_ENTITY:ye=P.TEXT,Oe="textNode";break;case P.ATTRIB_VALUE_ENTITY_Q:ye=P.ATTRIB_VALUE_QUOTED,Oe="attribValue";break;case P.ATTRIB_VALUE_ENTITY_U:ye=P.ATTRIB_VALUE_UNQUOTED,Oe="attribValue";break}if(x===";"){var we=Je(i);i.opt.unparsedEntities&&!Object.values(l.XML_ENTITIES).includes(we)?(i.entity="",i.state=ye,i.write(we)):(i[Oe]+=we,i.entity="",i.state=ye)}else oe(i.entity.length?J:be,x)?i.entity+=x:(he(i,"Invalid character in entity name"),i[Oe]+="&"+i.entity+x,i.entity="",i.state=ye);continue;default:throw new Error(i,"Unknown state: "+i.state)}return i.position>=i.bufferCheckPosition&&D(i),i}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var u=String.fromCharCode,i=Math.floor,E=function(){var x=16384,ce=[],Z,ye,Oe=-1,we=arguments.length;if(!we)return"";for(var et="";++Oe<we;){var Se=Number(arguments[Oe]);if(!isFinite(Se)||Se<0||Se>1114111||i(Se)!==Se)throw RangeError("Invalid code point: "+Se);Se<=65535?ce.push(Se):(Se-=65536,Z=(Se>>10)+55296,ye=Se%1024+56320,ce.push(Z,ye)),(Oe+1===we||ce.length>x)&&(et+=u.apply(null,ce),ce.length=0)}return et};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:E,configurable:!0,writable:!0}):String.fromCodePoint=E}()})(s)}(pa)),pa}var fi=li();const Ht={};function di(s){const{parentId:l,child:d}=s;Ht[l]||(Ht[l]=[]);const f={id:d.id,tagName:d.tagName};Ht[l].push(f)}function pi(s){const{currentBatch:l}=s,d=[...l];for(const[f,D]of d.entries()){const I=Ht[D.id]||[];I.length>0&&(d[f].children.push(...I),hi({parentId:D.id}))}return d}function hi(s){const{parentId:l}=s;delete Ht[l]}function mi(s){return"prefix"in s&&"uri"in s&&!!s.prefix&&!!s.uri}const yi=[".fsd",".asd",".ssd",".scd",".isd",".icd",".xml"],Ot="sclElements",hr="id, tagName, [id+tagName], parent.id, parent.tagName, *children.id, *children.tagName",mr="attachedFiles",ya="id, filename, file",Cn={default:{prefix:"",uri:"http://www.iec.ch/61850/2003/SCL"},test:{prefix:"dev"}},vi="db-id",Fa=`${Cn.test.prefix}:${vi}`;function gi(s){return s!==null&&typeof s=="object"&&"namespace"in s&&s.namespace!==null}function bi(s){const{useTestIds:l}=s;let d={defaultNamespace:null,stack:[],recordsBatch:[]};const f=fi.parser(!0,{lowercase:!1,trim:!0,normalize:!0,position:!1,xmlns:!0});f.onopentag=F=>d=wi({node:F,state:d,useTestIds:l}),f.ontext=F=>d=_i({text:F,state:d}),f.onclosetag=()=>({updatedState:d}=Ti({state:d})),f.onerror=xi;function D(){const F=d.recordsBatch;return d.recordsBatch=[],F}function I(){return d.recordsBatch.length}return{parser:f,drainBatch:D,getSize:I}}function wi(s){const{node:l,state:d,useTestIds:f}=s,D={...d},I=Si(l);D.defaultNamespace||(D.defaultNamespace=Ei(l));const F=Pi(l,D.defaultNamespace),C=Oi({attributes:l.attributes,useTestIds:f}),B=Ci({attributes:l.attributes,useTestIds:f}),$=Di(B),Q=Ii(d.stack),z={id:C,tagName:I,namespace:F,attributes:$,value:"",parent:Q,children:[]};return D.stack.push(z),D}function _i(s){const{text:l,state:d}=s;return l&&d.stack.length>0&&(d.stack[d.stack.length-1].value+=l),d}function Ti(s){const{state:l}=s,d=l.stack.at(-1);let f=l.stack.slice(0,-1);const D=[...l.recordsBatch];if(d){if(f.length){const I=f.length-1;f=f.map((F,C)=>C===I?{...F,children:[...F.children,{id:d.id,tagName:d.tagName}]}:F)}else d.parent&&di({parentId:d.parent.id,child:{id:d.id,tagName:d.tagName}});D.push(d)}return{updatedState:{defaultNamespace:l.defaultNamespace,stack:f,recordsBatch:D}}}function xi(s){return new Error(`XML parsing error: ${s}`)}function Si(s){return s.local||null}function Ei(s){if(s.name!=="SCL")throw new Error("Default namespace can only be set on SCL element");return s.attributes?.xmlns?.value?{prefix:"",uri:s.attributes.xmlns.value}:Cn.default}function Pi(s,l){return mi(s)?{prefix:s.prefix,uri:s.uri}:l}function Di(s){return s.map(l=>{const d=l.prefix&&l.uri?{prefix:l.prefix,uri:l.uri}:void 0;return{name:d?l.local:l.name,value:l.value,...d&&{namespace:d}}})}function Ii(s){if(s.length===0)return null;const l=s[s.length-1];return l?{id:l.id,tagName:l.tagName}:null}function Oi(s){const{attributes:l,useTestIds:d}=s,f=l[Fa];return d&&f&&f.value?f.value:crypto.randomUUID()}function Ci(s){const{attributes:l,useTestIds:d}=s;return d?Object.values(l).filter(f=>f.name!==Fa):Object.values(l)}var _r={exports:{}},Ai=_r.exports,va;function Ni(){return va||(va=1,function(s,l){(function(d,f){s.exports=f()})(Ai,function(){var d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])})(e,t)},f=function(){return(f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function D(e,t,n){for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||((r=r||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var I=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ii,F=Object.keys,C=Array.isArray;function B(e,t){return typeof t!="object"||F(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||I.Promise||(I.Promise=Promise);var $=Object.getPrototypeOf,Q={}.hasOwnProperty;function z(e,t){return Q.call(e,t)}function ne(e,t){typeof t=="function"&&(t=t($(e))),(typeof Reflect>"u"?F:Reflect.ownKeys)(t).forEach(function(n){k(e,n,t[n])})}var W=Object.defineProperty;function k(e,t,n,r){W(e,t,B(n&&z(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function R(e){return{from:function(t){return e.prototype=Object.create(t.prototype),k(e.prototype,"constructor",e),{extend:ne.bind(null,e.prototype)}}}}var H=Object.getOwnPropertyDescriptor,ae=[].slice;function be(e,t,n){return ae.call(e,t,n)}function J(e,t){return t(e)}function Y(e){if(!e)throw new Error("Assertion Failed")}function ie(e){I.setImmediate?setImmediate(e):setTimeout(e,0)}function fe(e,t){if(typeof t=="string"&&z(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,a=t.length;r<a;++r){var o=fe(e,t[r]);n.push(o)}return n}var c=t.indexOf(".");if(c!==-1){var p=e[t.substr(0,c)];return p==null?void 0:fe(p,t.substr(c+1))}}function oe(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Y(typeof n!="string"&&"length"in n);for(var r=0,a=t.length;r<a;++r)oe(e,t[r],n[r])}else{var o,c,p=t.indexOf(".");p!==-1?(o=t.substr(0,p),(c=t.substr(p+1))===""?n===void 0?C(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n:oe(p=!(p=e[o])||!z(e,o)?e[o]={}:p,c,n)):n===void 0?C(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Ie(e){var t,n={};for(t in e)z(e,t)&&(n[t]=e[t]);return n}var P=[].concat;function ut(e){return P.apply([],e)}var lt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ut([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return I[e]}),Ue=new Set(lt.map(function(e){return I[e]})),de=null;function Re(e){return de=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var r=de.get(n);if(r)return r;if(C(n)){r=[],de.set(n,r);for(var a=0,o=n.length;a<o;++a)r.push(t(n[a]))}else if(Ue.has(n.constructor))r=n;else{var c,p=$(n);for(c in r=p===Object.prototype?{}:Object.create(p),de.set(n,r),n)z(n,c)&&(r[c]=t(n[c]))}return r}(e),de=null,e}var se={}.toString;function me(e){return se.call(e).slice(8,-1)}var Ee=typeof Symbol<"u"?Symbol.iterator:"@@iterator",he=typeof Ee=="symbol"?function(e){var t;return e!=null&&(t=e[Ee])&&t.apply(e)}:function(){return null};function ze(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Ve={};function Le(e){var t,n,r,a;if(arguments.length===1){if(C(e))return e.slice();if(this===Ve&&typeof e=="string")return[e];if(a=he(e)){for(n=[];!(r=a.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Be=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ft=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Me=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ft),At={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Je(e,t){this.name=e,this.message=t}function Nt(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,a){return a.indexOf(n)===r}).join(`
`)}function ct(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Nt(e,t)}function Ze(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Nt(e,this.failures)}R(Je).from(Error).extend({toString:function(){return this.name+": "+this.message}}),R(ct).from(Je),R(Ze).from(Je);var u=Me.reduce(function(e,t){return e[t]=t+"Error",e},{}),i=Je,E=Me.reduce(function(e,t){var n=t+"Error";function r(a,o){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(o?`
 `+o:""),this.inner=o||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=At[t]||n,this.inner=null)}return R(r).from(i),e[t]=r,e},{});E.Syntax=SyntaxError,E.Type=TypeError,E.Range=RangeError;var x=Ft.reduce(function(e,t){return e[t+"Error"]=E[t],e},{}),ce=Me.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=E[t]),e},{});function Z(){}function ye(e){return e}function Oe(e,t){return e==null||e===ye?t:function(n){return t(e(n))}}function we(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function et(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?we(r,this.onsuccess):r),a&&(this.onerror=this.onerror?we(a,this.onerror):a),o!==void 0?o:n}}function Se(e,t){return e===Z?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?we(n,this.onsuccess):n),r&&(this.onerror=this.onerror?we(r,this.onerror):r)}}function Ke(e,t){return e===Z?t:function(n){var r=e.apply(this,arguments);B(n,r);var a=this.onsuccess,o=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?we(a,this.onsuccess):a),o&&(this.onerror=this.onerror?we(o,this.onerror):o),r===void 0?n===void 0?void 0:n:B(r,n)}}function An(e,t){return e===Z?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function _t(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,a=arguments.length,o=new Array(a);a--;)o[a]=arguments[a];return n.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}ce.ModifyError=ct,ce.DexieError=Je,ce.BulkError=Ze;var Fe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Rt(e){Fe=e}var kt={},Or=100,lt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,$(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,$(t),e]}(),Ft=lt[0],Me=lt[1],lt=lt[2],Me=Me&&Me.then,ft=Ft&&Ft.constructor,Nn=!!lt,Lt=function(e,t){jt.push([e,t]),Jt&&(queueMicrotask(Ua),Jt=!1)},Rn=!0,Jt=!0,dt=[],Zt=[],kn=ye,tt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Z,pgp:!1,env:{},finalize:Z},X=tt,jt=[],pt=0,en=[];function V(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=X;if(typeof e!="function"){if(e!==kt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ln(this,this._value))}this._state=null,this._value=null,++t.ref,function n(r,a){try{a(function(o){if(r._state===null){if(o===r)throw new TypeError("A promise cannot be resolved with itself.");var c=r._lib&&Tt();o&&typeof o.then=="function"?n(r,function(p,m){o instanceof V?o._then(p,m):o.then(p,m)}):(r._state=!0,r._value=o,Ar(r)),c&&xt()}},Ln.bind(null,r))}catch(o){Ln(r,o)}}(this,e)}var Fn={get:function(){var e=X,t=an;function n(r,a){var o=this,c=!e.global&&(e!==X||t!==an),p=c&&!rt(),m=new V(function(v,b){jn(o,new Cr(Rr(r,e,c,p),Rr(a,e,c,p),v,b,e))});return this._consoleTask&&(m._consoleTask=this._consoleTask),m}return n.prototype=kt,n},set:function(e){k(this,"then",e&&e.prototype===kt?Fn:{get:function(){return e},set:Fn.set})}};function Cr(e,t,n,r,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=a}function Ln(e,t){var n,r;Zt.push(t),e._state===null&&(n=e._lib&&Tt(),t=kn(t),e._state=!1,e._value=t,r=e,dt.some(function(a){return a._value===r._value})||dt.push(r),Ar(e),n&&xt())}function Ar(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)jn(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),pt===0&&(++pt,Lt(function(){--pt==0&&Mn()},[]))}function jn(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++pt,Lt(qa,[n,e,t])}else e._listeners.push(t)}function qa(e,t,n){try{var r,a=t._value;!t._state&&Zt.length&&(Zt=[]),r=Fe&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||Zt.indexOf(a)!==-1||function(o){for(var c=dt.length;c;)if(dt[--c]._value===o._value)return dt.splice(c,1)}(t),n.resolve(r)}catch(o){n.reject(o)}finally{--pt==0&&Mn(),--n.psd.ref||n.psd.finalize()}}function Ua(){ht(tt,function(){Tt()&&xt()})}function Tt(){var e=Rn;return Jt=Rn=!1,e}function xt(){var e,t,n;do for(;0<jt.length;)for(e=jt,jt=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<jt.length);Jt=Rn=!0}function Mn(){var e=dt;dt=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=en.slice(0),n=t.length;n;)t[--n]()}function tn(e){return new V(kt,!1,e)}function ge(e,t){var n=X;return function(){var r=Tt(),a=X;try{return at(n,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{at(a,!1),r&&xt()}}}ne(V.prototype,{then:Fn,_then:function(e,t){jn(this,new Cr(null,null,e,t,X))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:tn)(r)}):this.then(null,function(r){return(r&&r.name===t?n:tn)(r)})},finally:function(e){return this.then(function(t){return V.resolve(e()).then(function(){return t})},function(t){return V.resolve(e()).then(function(){return tn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new V(function(r,a){var o=setTimeout(function(){return a(new E.Timeout(t))},e);n.then(r,a).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&k(V.prototype,Symbol.toStringTag,"Dexie.Promise"),tt.env=Nr(),ne(V,{all:function(){var e=Le.apply(null,arguments).map(on);return new V(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(a,o){return V.resolve(a).then(function(c){e[o]=c,--r||t(e)},n)})})},resolve:function(e){return e instanceof V?e:e&&typeof e.then=="function"?new V(function(t,n){e.then(t,n)}):new V(kt,!0,e)},reject:tn,race:function(){var e=Le.apply(null,arguments).map(on);return new V(function(t,n){e.map(function(r){return V.resolve(r).then(t,n)})})},PSD:{get:function(){return X},set:function(e){return X=e}},totalEchoes:{get:function(){return an}},newPSD:nt,usePSD:ht,scheduler:{get:function(){return Lt},set:function(e){Lt=e}},rejectionMapper:{get:function(){return kn},set:function(e){kn=e}},follow:function(e,t){return new V(function(n,r){return nt(function(a,o){var c=X;c.unhandleds=[],c.onunhandled=o,c.finalize=we(function(){var p,m=this;p=function(){m.unhandleds.length===0?a():o(m.unhandleds[0])},en.push(function v(){p(),en.splice(en.indexOf(v),1)}),++pt,Lt(function(){--pt==0&&Mn()},[])},c.finalize),e()},t,n,r)})}}),ft&&(ft.allSettled&&k(V,"allSettled",function(){var e=Le.apply(null,arguments).map(on);return new V(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(a,o){return V.resolve(a).then(function(c){return r[o]={status:"fulfilled",value:c}},function(c){return r[o]={status:"rejected",reason:c}}).then(function(){return--n||t(r)})})})}),ft.any&&typeof AggregateError<"u"&&k(V,"any",function(){var e=Le.apply(null,arguments).map(on);return new V(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,a=new Array(r);e.forEach(function(o,c){return V.resolve(o).then(function(p){return t(p)},function(p){a[c]=p,--r||n(new AggregateError(a))})})})}),ft.withResolvers&&(V.withResolvers=ft.withResolvers));var Pe={awaits:0,echoes:0,id:0},Va=0,nn=[],rn=0,an=0,Ga=0;function nt(e,t,n,r){var a=X,o=Object.create(a);return o.parent=a,o.ref=0,o.global=!1,o.id=++Ga,tt.env,o.env=Nn?{Promise:V,PromiseProp:{value:V,configurable:!0,writable:!0},all:V.all,race:V.race,allSettled:V.allSettled,any:V.any,resolve:V.resolve,reject:V.reject}:{},t&&B(o,t),++a.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()},r=ht(o,e,n,r),o.ref===0&&o.finalize(),r}function St(){return Pe.id||(Pe.id=++Va),++Pe.awaits,Pe.echoes+=Or,Pe.id}function rt(){return!!Pe.awaits&&(--Pe.awaits==0&&(Pe.id=0),Pe.echoes=Pe.awaits*Or,!0)}function on(e){return Pe.echoes&&e&&e.constructor===ft?(St(),e.then(function(t){return rt(),t},function(t){return rt(),Te(t)})):e}function Wa(){var e=nn[nn.length-1];nn.pop(),at(e,!1)}function at(e,t){var n,r=X;(t?!Pe.echoes||rn++&&e===X:!rn||--rn&&e===X)||queueMicrotask(t?(function(a){++an,Pe.echoes&&--Pe.echoes!=0||(Pe.echoes=Pe.awaits=Pe.id=0),nn.push(X),at(a,!0)}).bind(null,e):Wa),e!==X&&(X=e,r===tt&&(tt.env=Nr()),Nn&&(n=tt.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(I,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Nr(){var e=I.Promise;return Nn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(I,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ht(e,t,n,r,a){var o=X;try{return at(e,!0),t(n,r,a)}finally{at(o,!1)}}function Rr(e,t,n,r){return typeof e!="function"?e:function(){var a=X;n&&St(),at(t,!0);try{return e.apply(this,arguments)}finally{at(a,!1),r&&queueMicrotask(rt)}}}function Bn(e){Promise===ft&&Pe.echoes===0?rn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Me).indexOf("[native code]")===-1&&(St=rt=Z);var Te=V.reject,mt="",Ye="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",kr="String expected.",Et=[],sn="__dbnames",Kn="readonly",qn="readwrite";function yt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Fr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function un(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=Re(t))[e],t}}function Lr(){throw E.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ue(e,t){try{var n=jr(e),r=jr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(a,o){for(var c=a.length,p=o.length,m=c<p?c:p,v=0;v<m;++v)if(a[v]!==o[v])return a[v]<o[v]?-1:1;return c===p?0:c<p?-1:1}(Mr(e),Mr(t));case"Array":return function(a,o){for(var c=a.length,p=o.length,m=c<p?c:p,v=0;v<m;++v){var b=ue(a[v],o[v]);if(b!==0)return b}return c===p?0:c<p?-1:1}(e,t)}}catch{}return NaN}function jr(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=me(e),e==="ArrayBuffer"?"binary":e)}function Mr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function cn(e,t,n){var r=e.schema.yProps;return r?(t&&0<n.numFailures&&(t=t.filter(function(a,o){return!n.failures[o]})),Promise.all(r.map(function(a){return a=a.updatesTable,t?e.db.table(a).where("k").anyOf(t).delete():e.db.table(a).clear()})).then(function(){return n})):n}var Br=(ve.prototype._trans=function(e,t,n){var r=this._tx||X.trans,a=this.name,o=Fe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function c(v,b,h){if(!h.schema[a])throw new E.NotFound("Table "+a+" not part of transaction");return t(h.idbtrans,h)}var p=Tt();try{var m=r&&r.db._novip===this.db._novip?r===X.trans?r._promise(e,c,n):nt(function(){return r._promise(e,c,n)},{trans:r,transless:X.transless||X}):function v(b,h,T,y){if(b.idbdb&&(b._state.openComplete||X.letThrough||b._vip)){var g=b._createTransaction(h,T,b._dbSchema);try{g.create(),b._state.PR1398_maxLoop=3}catch(_){return _.name===u.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return v(b,h,T,y)})):Te(_)}return g._promise(h,function(_,w){return nt(function(){return X.trans=g,y(_,w,g)})}).then(function(_){if(h==="readwrite")try{g.idbtrans.commit()}catch{}return h==="readonly"?_:g._completion.then(function(){return _})})}if(b._state.openComplete)return Te(new E.DatabaseClosed(b._state.dbOpenError));if(!b._state.isBeingOpened){if(!b._state.autoOpen)return Te(new E.DatabaseClosed);b.open().catch(Z)}return b._state.dbReadyPromise.then(function(){return v(b,h,T,y)})}(this.db,e,[this.name],c);return o&&(m._consoleTask=o,m=m.catch(function(v){return console.trace(v),Te(v)})),m}finally{p&&xt()}},ve.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Te(new E.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(a){return n.hook.reading.fire(a)})}).then(t)},ve.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(C(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=F(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(p){if(p.compound&&t.every(function(v){return 0<=p.keyPath.indexOf(v)})){for(var m=0;m<t.length;++m)if(t.indexOf(p.keyPath[m])===-1)return!1;return!0}return!1}).sort(function(p,m){return p.keyPath.length-m.keyPath.length})[0];if(n&&this.db._maxKey!==mt){var o=n.keyPath.slice(0,t.length);return this.where(o).equals(o.map(function(m){return e[m]}))}!n&&Fe&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName;function a(p,m){return ue(p,m)===0}var c=t.reduce(function(h,m){var v=h[0],b=h[1],h=r[m],T=e[m];return[v||h,v||!h?yt(b,h&&h.multi?function(y){return y=fe(y,m),C(y)&&y.some(function(g){return a(T,g)})}:function(y){return a(T,fe(y,m))}):b]},[null,null]),o=c[0],c=c[1];return o?this.where(o.name).equals(e[o.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")},ve.prototype.filter=function(e){return this.toCollection().and(e)},ve.prototype.count=function(e){return this.toCollection().count(e)},ve.prototype.offset=function(e){return this.toCollection().offset(e)},ve.prototype.limit=function(e){return this.toCollection().limit(e)},ve.prototype.each=function(e){return this.toCollection().each(e)},ve.prototype.toArray=function(e){return this.toCollection().toArray(e)},ve.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ve.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,C(e)?"[".concat(e.join("+"),"]"):e))},ve.prototype.reverse=function(){return this.toCollection().reverse()},ve.prototype.mapToClass=function(e){var t,n=this.db,r=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Lr&&(function(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function b(){this.constructor=m}d(m,v),m.prototype=v===null?Object.create(v):(b.prototype=v.prototype,new b)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),a.prototype.table=function(){return r},e=a);for(var o=new Set,c=e.prototype;c;c=$(c))Object.getOwnPropertyNames(c).forEach(function(m){return o.add(m)});function p(m){if(!m)return m;var v,b=Object.create(e.prototype);for(v in m)if(!o.has(v))try{b[v]=m[v]}catch{}return b}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),e},ve.prototype.defineClass=function(){return this.mapToClass(function(e){B(this,e)})},ve.prototype.add=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,o=r.keyPath,c=e;return o&&a&&(c=un(o)(e)),this._trans("readwrite",function(p){return n.core.mutate({trans:p,type:"add",keys:t!=null?[t]:null,values:[c]})}).then(function(p){return p.numFailures?V.reject(p.failures[0]):p.lastResult}).then(function(p){if(o)try{oe(e,o,p)}catch{}return p})},ve.prototype.update=function(e,t){return typeof e!="object"||C(e)?this.where(":id").equals(e).modify(t):(e=fe(e,this.schema.primKey.keyPath),e===void 0?Te(new E.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},ve.prototype.put=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,o=r.keyPath,c=e;return o&&a&&(c=un(o)(e)),this._trans("readwrite",function(p){return n.core.mutate({trans:p,type:"put",values:[c],keys:t!=null?[t]:null})}).then(function(p){return p.numFailures?V.reject(p.failures[0]):p.lastResult}).then(function(p){if(o)try{oe(e,o,p)}catch{}return p})},ve.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(r){return cn(t,[e],r)}).then(function(r){return r.numFailures?V.reject(r.failures[0]):void 0})})},ve.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Fr}).then(function(n){return cn(e,null,n)})}).then(function(t){return t.numFailures?V.reject(t.failures[0]):void 0})},ve.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(a){return t.hook.reading.fire(a)})})})},ve.prototype.bulkAdd=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,o=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var v=r.schema.primKey,p=v.auto,v=v.keyPath;if(v&&a)throw new E.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new E.InvalidArgument("Arguments objects and keys must have the same length");var m=e.length,v=v&&p?e.map(un(v)):e;return r.core.mutate({trans:c,type:"add",keys:a,values:v,wantResults:o}).then(function(g){var h=g.numFailures,T=g.results,y=g.lastResult,g=g.failures;if(h===0)return o?T:y;throw new Ze("".concat(r.name,".bulkAdd(): ").concat(h," of ").concat(m," operations failed"),g)})})},ve.prototype.bulkPut=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,o=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var v=r.schema.primKey,p=v.auto,v=v.keyPath;if(v&&a)throw new E.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new E.InvalidArgument("Arguments objects and keys must have the same length");var m=e.length,v=v&&p?e.map(un(v)):e;return r.core.mutate({trans:c,type:"put",keys:a,values:v,wantResults:o}).then(function(g){var h=g.numFailures,T=g.results,y=g.lastResult,g=g.failures;if(h===0)return o?T:y;throw new Ze("".concat(r.name,".bulkPut(): ").concat(h," of ").concat(m," operations failed"),g)})})},ve.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(c){return c.key}),a=e.map(function(c){return c.changes}),o=[];return this._trans("readwrite",function(c){return n.getMany({trans:c,keys:r,cache:"clone"}).then(function(p){var m=[],v=[];e.forEach(function(h,T){var y=h.key,g=h.changes,_=p[T];if(_){for(var w=0,S=Object.keys(g);w<S.length;w++){var O=S[w],A=g[O];if(O===t.schema.primKey.keyPath){if(ue(A,y)!==0)throw new E.Constraint("Cannot update primary key in bulkUpdate()")}else oe(_,O,A)}o.push(T),m.push(y),v.push(_)}});var b=m.length;return n.mutate({trans:c,type:"put",keys:m,values:v,updates:{keys:r,changeSpecs:a}}).then(function(h){var T=h.numFailures,y=h.failures;if(T===0)return b;for(var g=0,_=Object.keys(y);g<_.length;g++){var w,S=_[g],O=o[Number(S)];O!=null&&(w=y[S],delete y[S],y[O]=w)}throw new Ze("".concat(t.name,".bulkUpdate(): ").concat(T," of ").concat(b," operations failed"),y)})})})},ve.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e}).then(function(a){return cn(t,e,a)})}).then(function(c){var a=c.numFailures,o=c.lastResult,c=c.failures;if(a===0)return o;throw new Ze("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(n," operations failed"),c)})},ve);function ve(){}function Mt(e){function t(c,p){if(p){for(var m=arguments.length,v=new Array(m-1);--m;)v[m-1]=arguments[m];return n[c].subscribe.apply(null,v),e}if(typeof c=="string")return n[c]}var n={};t.addEventType=o;for(var r=1,a=arguments.length;r<a;++r)o(arguments[r]);return t;function o(c,p,m){if(typeof c!="object"){var v;p=p||An;var b={subscribers:[],fire:m=m||Z,subscribe:function(h){b.subscribers.indexOf(h)===-1&&(b.subscribers.push(h),b.fire=p(b.fire,h))},unsubscribe:function(h){b.subscribers=b.subscribers.filter(function(T){return T!==h}),b.fire=b.subscribers.reduce(p,m)}};return n[c]=t[c]=b}F(v=c).forEach(function(h){var T=v[h];if(C(T))o(h,v[h][0],v[h][1]);else{if(T!=="asap")throw new E.InvalidArgument("Invalid event config");var y=o(h,ye,function(){for(var g=arguments.length,_=new Array(g);g--;)_[g]=arguments[g];y.subscribers.forEach(function(w){ie(function(){w.apply(null,_)})})})}})}}function Bt(e,t){return R(t).from({prototype:e}),t}function Pt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Un(e,t){e.filter=yt(e.filter,t)}function Vn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return yt(r(),t())}:t,e.justLimit=n&&!r}function ln(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new E.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Kr(e,t,n){var r=ln(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function fn(e,t,n,r){var a=e.replayFilter?yt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},c=function(p,m,v){var b,h;a&&!a(m,v,function(T){return m.stop(T)},function(T){return m.fail(T)})||((h=""+(b=m.primaryKey))=="[object ArrayBuffer]"&&(h=""+new Uint8Array(b)),z(o,h)||(o[h]=!0,t(p,m,v)))};return Promise.all([e.or._iterate(c,n),qr(Kr(e,r,n),e.algorithm,c,!e.keysOnly&&e.valueMapper)])}return qr(Kr(e,r,n),yt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function qr(e,t,n,r){var a=ge(r?function(o,c,p){return n(r(o),c,p)}:n);return e.then(function(o){if(o)return o.start(function(){var c=function(){return o.continue()};t&&!t(o,function(p){return c=p},function(p){o.stop(p),c=Z},function(p){o.fail(p),c=Z})||a(o.value,o,function(p){return c=p}),c()})})}var Kt=(Ur.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(C(n))return D(D([],C(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var r=t.remove;if(C(r))return C(e)?e.filter(function(a){return!r.includes(a)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},Ur);function Ur(e){this["@@propmod"]=e}var za=(pe.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Te.bind(null,n.error)):n.table._trans("readonly",e).then(t)},pe.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Te.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},pe.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=yt(t.algorithm,e)},pe.prototype._iterate=function(e,t){return fn(this._ctx,e,t,this._ctx.table.core)},pe.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&B(n,e),t._ctx=n,t},pe.prototype.raw=function(){return this._ctx.valueMapper=null,this},pe.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return fn(t,e,n,t.table.core)})},pe.prototype.count=function(e){var t=this;return this._read(function(n){var r=t._ctx,a=r.table.core;if(Pt(r,!0))return a.count({trans:n,query:{index:ln(r,a.schema),range:r.range}}).then(function(c){return Math.min(c,r.limit)});var o=0;return fn(r,function(){return++o,!1},n,a).then(function(){return o})}).then(e)},pe.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],a=n.length-1;function o(m,v){return v?o(m[n[v]],v-1):m[r]}var c=this._ctx.dir==="next"?1:-1;function p(m,v){return ue(o(m,a),o(v,a))*c}return this.toArray(function(m){return m.sort(p)}).then(t)},pe.prototype.toArray=function(e){var t=this;return this._read(function(n){var r=t._ctx;if(r.dir==="next"&&Pt(r,!0)&&0<r.limit){var a=r.valueMapper,o=ln(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:o,range:r.range}}).then(function(p){return p=p.result,a?p.map(a):p})}var c=[];return fn(r,function(p){return c.push(p)},n,r.table.core).then(function(){return c})},e)},pe.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Pt(t)?Vn(t,function(){var n=e;return function(r,a){return n===0||(n===1?--n:a(function(){r.advance(n),n=0}),!1)}}):Vn(t,function(){var n=e;return function(){return--n<0}})),this},pe.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Vn(this._ctx,function(){var t=e;return function(n,r,a){return--t<=0&&r(a),0<=t}},!0),this},pe.prototype.until=function(e,t){return Un(this._ctx,function(n,r,a){return!e(n.value)||(r(a),t)}),this},pe.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},pe.prototype.last=function(e){return this.reverse().first(e)},pe.prototype.filter=function(e){var t;return Un(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=yt(t.isMatch,e),this},pe.prototype.and=function(e){return this.filter(e)},pe.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},pe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},pe.prototype.desc=function(){return this.reverse()},pe.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},pe.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},pe.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},pe.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,a){n.push(a.key)}).then(function(){return n}).then(e)},pe.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Pt(t,!0)&&0<t.limit)return this._read(function(r){var a=ln(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,a){n.push(a.primaryKey)}).then(function(){return n}).then(e)},pe.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},pe.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},pe.prototype.lastKey=function(e){return this.reverse().firstKey(e)},pe.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return Un(this._ctx,function(a){var r=a.primaryKey.toString(),a=z(t,r);return t[r]=!0,!a}),this},pe.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var a,o,c;c=typeof e=="function"?e:(a=F(e),o=a.length,function(S){for(var O=!1,A=0;A<o;++A){var N=a[A],L=e[N],K=fe(S,N);L instanceof Kt?(oe(S,N,L.execute(K)),O=!0):K!==L&&(oe(S,N,L),O=!0)}return O});var p=n.table.core,h=p.schema.primaryKey,m=h.outbound,v=h.extractKey,b=200,h=t.db._options.modifyChunkSize;h&&(b=typeof h=="object"?h[p.name]||h["*"]||200:h);function T(S,N){var A=N.failures,N=N.numFailures;g+=S-N;for(var L=0,K=F(A);L<K.length;L++){var j=K[L];y.push(A[j])}}var y=[],g=0,_=[],w=e===Vr;return t.clone().primaryKeys().then(function(S){function O(N){var L=Math.min(b,S.length-N),K=S.slice(N,N+L);return(w?Promise.resolve([]):p.getMany({trans:r,keys:K,cache:"immutable"})).then(function(j){var M=[],U=[],q=m?[]:null,G=w?K:[];if(!w)for(var re=0;re<L;++re){var le=j[re],te={value:Re(le),primKey:S[N+re]};c.call(te,te.value,te)!==!1&&(te.value==null?G.push(S[N+re]):m||ue(v(le),v(te.value))===0?(U.push(te.value),m&&q.push(S[N+re])):(G.push(S[N+re]),M.push(te.value)))}return Promise.resolve(0<M.length&&p.mutate({trans:r,type:"add",values:M}).then(function(_e){for(var ee in _e.failures)G.splice(parseInt(ee),1);T(M.length,_e)})).then(function(){return(0<U.length||A&&typeof e=="object")&&p.mutate({trans:r,type:"put",keys:q,values:U,criteria:A,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<N}).then(function(_e){return T(U.length,_e)})}).then(function(){return(0<G.length||A&&w)&&p.mutate({trans:r,type:"delete",keys:G,criteria:A,isAdditionalChunk:0<N}).then(function(_e){return cn(n.table,G,_e)}).then(function(_e){return T(G.length,_e)})}).then(function(){return S.length>N+L&&O(N+b)})})}var A=Pt(n)&&n.limit===1/0&&(typeof e!="function"||w)&&{index:n.index,range:n.range};return O(0).then(function(){if(0<y.length)throw new ct("Error modifying one or more objects",y,g,_);return S.length})})})},pe.prototype.delete=function(){var e=this._ctx,t=e.range;return!Pt(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Vr):this._write(function(n){var r=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:n,query:{index:r,range:a}}).then(function(o){return e.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(function(m){var p=m.failures,m=m.numFailures;if(m)throw new ct("Could not delete some values",Object.keys(p).map(function(v){return p[v]}),o-m);return o-m})})})},pe);function pe(){}var Vr=function(e,t){return t.value=null};function Ya(e,t){return e<t?-1:e===t?0:1}function Xa(e,t){return t<e?-1:e===t?0:1}function je(e,t,n){return e=e instanceof Wr?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function Dt(e){return new e.Collection(e,function(){return Gr("")}).limit(0)}function dn(e,t,n,r){var a,o,c,p,m,v,b,h=n.length;if(!n.every(function(g){return typeof g=="string"}))return je(e,kr);function T(g){a=g==="next"?function(w){return w.toUpperCase()}:function(w){return w.toLowerCase()},o=g==="next"?function(w){return w.toLowerCase()}:function(w){return w.toUpperCase()},c=g==="next"?Ya:Xa;var _=n.map(function(w){return{lower:o(w),upper:a(w)}}).sort(function(w,S){return c(w.lower,S.lower)});p=_.map(function(w){return w.upper}),m=_.map(function(w){return w.lower}),b=(v=g)==="next"?"":r}T("next"),e=new e.Collection(e,function(){return ot(p[0],m[h-1]+r)}),e._ondirectionchange=function(g){T(g)};var y=0;return e._addAlgorithm(function(g,_,w){var S=g.key;if(typeof S!="string")return!1;var O=o(S);if(t(O,m,y))return!0;for(var A=null,N=y;N<h;++N){var L=function(K,j,M,U,q,G){for(var re=Math.min(K.length,U.length),le=-1,te=0;te<re;++te){var _e=j[te];if(_e!==U[te])return q(K[te],M[te])<0?K.substr(0,te)+M[te]+M.substr(te+1):q(K[te],U[te])<0?K.substr(0,te)+U[te]+M.substr(te+1):0<=le?K.substr(0,le)+j[le]+M.substr(le+1):null;q(K[te],_e)<0&&(le=te)}return re<U.length&&G==="next"?K+M.substr(K.length):re<K.length&&G==="prev"?K.substr(0,M.length):le<0?null:K.substr(0,le)+U[le]+M.substr(le+1)}(S,O,p[N],m[N],c,v);L===null&&A===null?y=N+1:(A===null||0<c(A,L))&&(A=L)}return _(A!==null?function(){g.continue(A+b)}:w),!1}),e}function ot(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Gr(e){return{type:1,lower:e,upper:e}}var Wr=(Object.defineProperty(De.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),De.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?Dt(this):new this.Collection(this,function(){return ot(e,t,!n,!r)})}catch{return je(this,Ye)}},De.prototype.equals=function(e){return e==null?je(this,Ye):new this.Collection(this,function(){return Gr(e)})},De.prototype.above=function(e){return e==null?je(this,Ye):new this.Collection(this,function(){return ot(e,void 0,!0)})},De.prototype.aboveOrEqual=function(e){return e==null?je(this,Ye):new this.Collection(this,function(){return ot(e,void 0,!1)})},De.prototype.below=function(e){return e==null?je(this,Ye):new this.Collection(this,function(){return ot(void 0,e,!1,!0)})},De.prototype.belowOrEqual=function(e){return e==null?je(this,Ye):new this.Collection(this,function(){return ot(void 0,e)})},De.prototype.startsWith=function(e){return typeof e!="string"?je(this,kr):this.between(e,e+mt,!0,!0)},De.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):dn(this,function(t,n){return t.indexOf(n[0])===0},[e],mt)},De.prototype.equalsIgnoreCase=function(e){return dn(this,function(t,n){return t===n[0]},[e],"")},De.prototype.anyOfIgnoreCase=function(){var e=Le.apply(Ve,arguments);return e.length===0?Dt(this):dn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},De.prototype.startsWithAnyOfIgnoreCase=function(){var e=Le.apply(Ve,arguments);return e.length===0?Dt(this):dn(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,mt)},De.prototype.anyOf=function(){var e=this,t=Le.apply(Ve,arguments),n=this._cmp;try{t.sort(n)}catch{return je(this,Ye)}if(t.length===0)return Dt(this);var r=new this.Collection(this,function(){return ot(t[0],t[t.length-1])});r._ondirectionchange=function(o){n=o==="next"?e._ascending:e._descending,t.sort(n)};var a=0;return r._addAlgorithm(function(o,c,p){for(var m=o.key;0<n(m,t[a]);)if(++a===t.length)return c(p),!1;return n(m,t[a])===0||(c(function(){o.continue(t[a])}),!1)}),r},De.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},De.prototype.noneOf=function(){var e=Le.apply(Ve,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return je(this,Ye)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},De.prototype.inAnyRange=function(S,t){var n=this,r=this._cmp,a=this._ascending,o=this._descending,c=this._min,p=this._max;if(S.length===0)return Dt(this);if(!S.every(function(O){return O[0]!==void 0&&O[1]!==void 0&&a(O[0],O[1])<=0}))return je(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",E.InvalidArgument);var m=!t||t.includeLowers!==!1,v=t&&t.includeUppers===!0,b,h=a;function T(O,A){return h(O[0],A[0])}try{(b=S.reduce(function(O,A){for(var N=0,L=O.length;N<L;++N){var K=O[N];if(r(A[0],K[1])<0&&0<r(A[1],K[0])){K[0]=c(K[0],A[0]),K[1]=p(K[1],A[1]);break}}return N===L&&O.push(A),O},[])).sort(T)}catch{return je(this,Ye)}var y=0,g=v?function(O){return 0<a(O,b[y][1])}:function(O){return 0<=a(O,b[y][1])},_=m?function(O){return 0<o(O,b[y][0])}:function(O){return 0<=o(O,b[y][0])},w=g,S=new this.Collection(this,function(){return ot(b[0][0],b[b.length-1][1],!m,!v)});return S._ondirectionchange=function(O){h=O==="next"?(w=g,a):(w=_,o),b.sort(T)},S._addAlgorithm(function(O,A,N){for(var L,K=O.key;w(K);)if(++y===b.length)return A(N),!1;return!g(L=K)&&!_(L)||(n._cmp(K,b[y][1])===0||n._cmp(K,b[y][0])===0||A(function(){h===a?O.continue(b[y][0]):O.continue(b[y][1])}),!1)}),S},De.prototype.startsWithAnyOf=function(){var e=Le.apply(Ve,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Dt(this):this.inAnyRange(e.map(function(t){return[t,t+mt]})):je(this,"startsWithAnyOf() only works with strings")},De);function De(){}function Ge(e){return ge(function(t){return qt(t),e(t.target.error),!1})}function qt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ut="storagemutated",Gn="x-storagemutated-1",it=Mt(null,Ut),$a=(We.prototype._lock=function(){return Y(!X.global),++this._reculock,this._reculock!==1||X.global||(X.lockOwnerFor=this),this},We.prototype._unlock=function(){if(Y(!X.global),--this._reculock==0)for(X.global||(X.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{ht(e[1],e[0])}catch{}}return this},We.prototype._locked=function(){return this._reculock&&X.lockOwnerFor!==this},We.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(Y(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new E.DatabaseClosed(r);case"MissingAPIError":throw new E.MissingAPI(r.message,r);default:throw new E.OpenFailed(r)}if(!this.active)throw new E.TransactionInactive;return Y(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ge(function(a){qt(a),t._reject(e.error)}),e.onabort=ge(function(a){qt(a),t.active&&t._reject(new E.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=ge(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&it.storagemutated.fire(e.mutatedParts)}),this},We.prototype._promise=function(e,t,n){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return Te(new E.ReadOnly("Transaction is readonly"));if(!this.active)return Te(new E.TransactionInactive);if(this._locked())return new V(function(o,c){r._blockedFuncs.push([function(){r._promise(e,t,n).then(o,c)},X])});if(n)return nt(function(){var o=new V(function(c,p){r._lock();var m=t(c,p,r);m&&m.then&&m.then(c,p)});return o.finally(function(){return r._unlock()}),o._lib=!0,o});var a=new V(function(o,c){var p=t(o,c,r);p&&p.then&&p.then(o,c)});return a._lib=!0,a},We.prototype._root=function(){return this.parent?this.parent._root():this},We.prototype.waitFor=function(e){var t,n=this._root(),r=V.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=o)}());var a=n._waitingFor;return new V(function(o,c){r.then(function(p){return n._waitingQueue.push(ge(o.bind(null,p)))},function(p){return n._waitingQueue.push(ge(c.bind(null,p)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},We.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new E.Abort))},We.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(z(t,e))return t[e];var n=this.schema[e];if(!n)throw new E.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},We);function We(){}function Wn(e,t,n,r,a,o,c,p){return{name:e,keyPath:t,unique:n,multi:r,auto:a,compound:o,src:(n&&!c?"&":"")+(r?"*":"")+(a?"++":"")+zr(t),type:p}}function zr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function zn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(a){return[a.name,a]},n.reduce(function(a,o,c){return c=r(o,c),c&&(a[c[0]]=c[1]),a},{}))};var r}var Vt=function(e){try{return e.only([[]]),Vt=function(){return[[]]},[[]]}catch{return Vt=function(){return mt},mt}};function Yn(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return fe(n,t)}:function(n){return fe(n,e)};var t}function Yr(e){return[].slice.call(e)}var Ha=0;function Gt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Qa(e,t,m){function r(w){if(w.type===3)return null;if(w.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=w.lower,g=w.upper,_=w.lowerOpen,w=w.upperOpen;return y===void 0?g===void 0?null:t.upperBound(g,!!w):g===void 0?t.lowerBound(y,!!_):t.bound(y,g,!!_,!!w)}function a(T){var y,g=T.name;return{name:g,schema:T,mutate:function(_){var w=_.trans,S=_.type,O=_.keys,A=_.values,N=_.range;return new Promise(function(L,K){L=ge(L);var j=w.objectStore(g),M=j.keyPath==null,U=S==="put"||S==="add";if(!U&&S!=="delete"&&S!=="deleteRange")throw new Error("Invalid operation type: "+S);var q,G=(O||A||{length:1}).length;if(O&&A&&O.length!==A.length)throw new Error("Given keys array must have same length as given values array.");if(G===0)return L({numFailures:0,failures:{},results:[],lastResult:void 0});function re(ke){++_e,qt(ke)}var le=[],te=[],_e=0;if(S==="deleteRange"){if(N.type===4)return L({numFailures:_e,failures:te,results:[],lastResult:void 0});N.type===3?le.push(q=j.clear()):le.push(q=j.delete(r(N)))}else{var M=U?M?[A,O]:[A,null]:[O,null],ee=M[0],Ae=M[1];if(U)for(var Ne=0;Ne<G;++Ne)le.push(q=Ae&&Ae[Ne]!==void 0?j[S](ee[Ne],Ae[Ne]):j[S](ee[Ne])),q.onerror=re;else for(Ne=0;Ne<G;++Ne)le.push(q=j[S](ee[Ne])),q.onerror=re}function Sn(ke){ke=ke.target.result,le.forEach(function(bt,fr){return bt.error!=null&&(te[fr]=bt.error)}),L({numFailures:_e,failures:te,results:S==="delete"?O:le.map(function(bt){return bt.result}),lastResult:ke})}q.onerror=function(ke){re(ke),Sn(ke)},q.onsuccess=Sn})},getMany:function(_){var w=_.trans,S=_.keys;return new Promise(function(O,A){O=ge(O);for(var N,L=w.objectStore(g),K=S.length,j=new Array(K),M=0,U=0,q=function(le){le=le.target,j[le._pos]=le.result,++U===M&&O(j)},G=Ge(A),re=0;re<K;++re)S[re]!=null&&((N=L.get(S[re]))._pos=re,N.onsuccess=q,N.onerror=G,++M);M===0&&O(j)})},get:function(_){var w=_.trans,S=_.key;return new Promise(function(O,A){O=ge(O);var N=w.objectStore(g).get(S);N.onsuccess=function(L){return O(L.target.result)},N.onerror=Ge(A)})},query:(y=v,function(_){return new Promise(function(w,S){w=ge(w);var O,A,N,M=_.trans,L=_.values,K=_.limit,q=_.query,j=K===1/0?void 0:K,U=q.index,q=q.range,M=M.objectStore(g),U=U.isPrimaryKey?M:M.index(U.name),q=r(q);if(K===0)return w({result:[]});y?((j=L?U.getAll(q,j):U.getAllKeys(q,j)).onsuccess=function(G){return w({result:G.target.result})},j.onerror=Ge(S)):(O=0,A=!L&&"openKeyCursor"in U?U.openKeyCursor(q):U.openCursor(q),N=[],A.onsuccess=function(G){var re=A.result;return re?(N.push(L?re.value:re.primaryKey),++O===K?w({result:N}):void re.continue()):w({result:N})},A.onerror=Ge(S))})}),openCursor:function(_){var w=_.trans,S=_.values,O=_.query,A=_.reverse,N=_.unique;return new Promise(function(L,K){L=ge(L);var U=O.index,j=O.range,M=w.objectStore(g),M=U.isPrimaryKey?M:M.index(U.name),U=A?N?"prevunique":"prev":N?"nextunique":"next",q=!S&&"openKeyCursor"in M?M.openKeyCursor(r(j),U):M.openCursor(r(j),U);q.onerror=Ge(K),q.onsuccess=ge(function(G){var re,le,te,_e,ee=q.result;ee?(ee.___id=++Ha,ee.done=!1,re=ee.continue.bind(ee),le=(le=ee.continuePrimaryKey)&&le.bind(ee),te=ee.advance.bind(ee),_e=function(){throw new Error("Cursor not stopped")},ee.trans=w,ee.stop=ee.continue=ee.continuePrimaryKey=ee.advance=function(){throw new Error("Cursor not started")},ee.fail=ge(K),ee.next=function(){var Ae=this,Ne=1;return this.start(function(){return Ne--?Ae.continue():Ae.stop()}).then(function(){return Ae})},ee.start=function(Ae){function Ne(){if(q.result)try{Ae()}catch(ke){ee.fail(ke)}else ee.done=!0,ee.start=function(){throw new Error("Cursor behind last entry")},ee.stop()}var Sn=new Promise(function(ke,bt){ke=ge(ke),q.onerror=Ge(bt),ee.fail=bt,ee.stop=function(fr){ee.stop=ee.continue=ee.continuePrimaryKey=ee.advance=_e,ke(fr)}});return q.onsuccess=ge(function(ke){q.onsuccess=Ne,Ne()}),ee.continue=re,ee.continuePrimaryKey=le,ee.advance=te,Ne(),Sn},L(ee)):L(null)},K)})},count:function(_){var w=_.query,S=_.trans,O=w.index,A=w.range;return new Promise(function(N,L){var K=S.objectStore(g),j=O.isPrimaryKey?K:K.index(O.name),K=r(A),j=K?j.count(K):j.count();j.onsuccess=ge(function(M){return N(M.target.result)}),j.onerror=Ge(L)})}}}var o,c,p,b=(c=m,p=Yr((o=e).objectStoreNames),{schema:{name:o.name,tables:p.map(function(T){return c.objectStore(T)}).map(function(T){var y=T.keyPath,w=T.autoIncrement,g=C(y),_={},w={name:T.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y==null,compound:g,keyPath:y,autoIncrement:w,unique:!0,extractKey:Yn(y)},indexes:Yr(T.indexNames).map(function(S){return T.index(S)}).map(function(N){var O=N.name,A=N.unique,L=N.multiEntry,N=N.keyPath,L={name:O,compound:C(N),keyPath:N,unique:A,multiEntry:L,extractKey:Yn(N)};return _[Gt(N)]=L}),getIndexByKeyPath:function(S){return _[Gt(S)]}};return _[":id"]=w.primaryKey,y!=null&&(_[Gt(y)]=w.primaryKey),w})},hasGetAll:0<p.length&&"getAll"in c.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),m=b.schema,v=b.hasGetAll,b=m.tables.map(a),h={};return b.forEach(function(T){return h[T.name]=T}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(T){if(!h[T])throw new Error("Table '".concat(T,"' not found"));return h[T]},MIN_KEY:-1/0,MAX_KEY:Vt(t),schema:m}}function Ja(e,t,n,r){var a=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=Qa(t,a,r),e.dbcore.reduce(function(o,c){return c=c.create,f(f({},o),c(o))},r))}}function pn(e,r){var n=r.db,r=Ja(e._middlewares,n,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(a){var o=a.name;e.core.schema.tables.some(function(c){return c.name===o})&&(a.core=e.core.table(o),e[o]instanceof e.Table&&(e[o].core=a.core))})}function hn(e,t,n,r){n.forEach(function(a){var o=r[a];t.forEach(function(c){var p=function m(v,b){return H(v,b)||(v=$(v))&&m(v,b)}(c,a);(!p||"value"in p&&p.value===void 0)&&(c===e.Transaction.prototype||c instanceof e.Transaction?k(c,a,{get:function(){return this.table(a)},set:function(m){W(this,a,{value:m,writable:!0,configurable:!0,enumerable:!0})}}):c[a]=new e.Table(a,o))})})}function Xn(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function Za(e,t){return e._cfg.version-t._cfg.version}function eo(e,t,n,r){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=zn("$meta",$r("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,a);o.create(n),o._completion.catch(r);var c=o._reject.bind(o),p=X.transless||X;nt(function(){return X.trans=o,X.transless=p,t!==0?(pn(e,n),v=t,((m=o).storeNames.includes("$meta")?m.table("$meta").get("version").then(function(b){return b??v}):V.resolve(v)).then(function(b){return T=b,y=o,g=n,_=[],b=(h=e)._versions,w=h._dbSchema=yn(0,h.idbdb,g),(b=b.filter(function(S){return S._cfg.version>=T})).length!==0?(b.forEach(function(S){_.push(function(){var O=w,A=S._cfg.dbschema;vn(h,O,g),vn(h,A,g),w=h._dbSchema=A;var N=$n(O,A);N.add.forEach(function(U){Hn(g,U[0],U[1].primKey,U[1].indexes)}),N.change.forEach(function(U){if(U.recreate)throw new E.Upgrade("Not yet support for changing primary key");var q=g.objectStore(U.name);U.add.forEach(function(G){return mn(q,G)}),U.change.forEach(function(G){q.deleteIndex(G.name),mn(q,G)}),U.del.forEach(function(G){return q.deleteIndex(G)})});var L=S._cfg.contentUpgrade;if(L&&S._cfg.version>T){pn(h,g),y._memoizedTables={};var K=Ie(A);N.del.forEach(function(U){K[U]=O[U]}),Xn(h,[h.Transaction.prototype]),hn(h,[h.Transaction.prototype],F(K),K),y.schema=K;var j,M=Be(L);return M&&St(),N=V.follow(function(){var U;(j=L(y))&&M&&(U=rt.bind(null,null),j.then(U,U))}),j&&typeof j.then=="function"?V.resolve(j):N.then(function(){return j})}}),_.push(function(O){var A,N,L=S._cfg.dbschema;A=L,N=O,[].slice.call(N.db.objectStoreNames).forEach(function(K){return A[K]==null&&N.db.deleteObjectStore(K)}),Xn(h,[h.Transaction.prototype]),hn(h,[h.Transaction.prototype],h._storeNames,h._dbSchema),y.schema=h._dbSchema}),_.push(function(O){h.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(h.idbdb.version/10)===S._cfg.version?(h.idbdb.deleteObjectStore("$meta"),delete h._dbSchema.$meta,h._storeNames=h._storeNames.filter(function(A){return A!=="$meta"})):O.objectStore("$meta").put(S._cfg.version,"version"))})}),function S(){return _.length?V.resolve(_.shift()(y.idbtrans)).then(S):V.resolve()}().then(function(){Xr(w,g)})):V.resolve();var h,T,y,g,_,w}).catch(c)):(F(a).forEach(function(b){Hn(n,b,a[b].primKey,a[b].indexes)}),pn(e,n),void V.follow(function(){return e.on.populate.fire(o)}).catch(c));var m,v})}function to(e,t){Xr(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=yn(0,e.idbdb,t);vn(e,e._dbSchema,t);for(var r=0,a=$n(n,e._dbSchema).change;r<a.length;r++){var o=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var p=t.objectStore(c.name);c.add.forEach(function(m){Fe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(m.src)),mn(p,m)})}(a[r]);if(typeof o=="object")return o.value}}function $n(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var a=e[n],o=t[n];if(a){var c={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||a.primKey.auto!==o.primKey.auto)c.recreate=!0,r.change.push(c);else{var p=a.idxByName,m=o.idxByName,v=void 0;for(v in p)m[v]||c.del.push(v);for(v in m){var b=p[v],h=m[v];b?b.src!==h.src&&c.change.push(h):c.add.push(h)}(0<c.del.length||0<c.add.length||0<c.change.length)&&r.change.push(c)}}else r.add.push([n,o])}return r}function Hn(e,t,n,r){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(o){return mn(a,o)}),a}function Xr(e,t){F(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(Fe&&console.debug("Dexie: Creating missing table",n),Hn(t,n,e[n].primKey,e[n].indexes))})}function mn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function yn(e,t,n){var r={};return be(t.objectStoreNames,0).forEach(function(a){for(var o=n.objectStore(a),c=Wn(zr(v=o.keyPath),v||"",!0,!1,!!o.autoIncrement,v&&typeof v!="string",!0),p=[],m=0;m<o.indexNames.length;++m){var b=o.index(o.indexNames[m]),v=b.keyPath,b=Wn(b.name,v,!!b.unique,!!b.multiEntry,!1,v&&typeof v!="string",!1);p.push(b)}r[a]=zn(a,c,p)}),r}function vn(e,t,n){for(var r=n.db.objectStoreNames,a=0;a<r.length;++a){var o=r[a],c=n.objectStore(o);e._hasGetAll="getAll"in c;for(var p=0;p<c.indexNames.length;++p){var m=c.indexNames[p],v=c.index(m).keyPath,b=typeof v=="string"?v:"["+be(v).join("+")+"]";!t[o]||(v=t[o].idxByName[b])&&(v.name=m,delete t[o].idxByName[b],t[o].idxByName[m]=v)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&I.WorkerGlobalScope&&I instanceof I.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function $r(e){return e.split(",").map(function(t,n){var o=t.split(":"),r=(a=o[1])===null||a===void 0?void 0:a.trim(),a=(t=o[0].trim()).replace(/([&*]|\+\+)/g,""),o=/^\[/.test(a)?a.match(/^\[(.*)\]$/)[1].split("+"):a;return Wn(a,o||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),C(o),n===0,r)})}var no=(It.prototype._createTableSchema=zn,It.prototype._parseIndexSyntax=$r,It.prototype._parseStoresSpec=function(e,t){var n=this;F(e).forEach(function(r){if(e[r]!==null){var a=n._parseIndexSyntax(e[r]),o=a.shift();if(!o)throw new E.Schema("Invalid schema for table "+r+": "+e[r]);if(o.unique=!0,o.multi)throw new E.Schema("Primary key cannot be multiEntry*");a.forEach(function(c){if(c.auto)throw new E.Schema("Only primary key can be marked as autoIncrement (++)");if(!c.keyPath)throw new E.Schema("Index must have a name and cannot be an empty string")}),a=n._createTableSchema(r,o,a),t[r]=a}})},It.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?B(this._cfg.storesSource,n):n;var n=t._versions,r={},a={};return n.forEach(function(o){B(r,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(r,a)}),t._dbSchema=a,Xn(t,[t._allTables,t,t.Transaction.prototype]),hn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],F(a),a),t._storeNames=F(a),this},It.prototype.upgrade=function(e){return this._cfg.contentUpgrade=_t(this._cfg.contentUpgrade||Z,e),this},It);function It(){}function Qn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Xe(sn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Jn(e){return e&&typeof e.databases=="function"}function Zn(e){return nt(function(){return X.letThrough=!0,e()})}function er(e){return!("from"in e)}var Ce=function(e,t){if(!this){var n=new Ce;return e&&"d"in e&&B(n,e),n}B(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Wt(e,t,n){var r=ue(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(er(e))return B(e,{from:t,to:n,d:1});var a=e.l,r=e.r;if(ue(n,e.from)<0)return a?Wt(a,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Qr(e);if(0<ue(t,e.to))return r?Wt(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Qr(e);ue(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<ue(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,a&&!e.l&&zt(e,a),r&&n&&zt(e,r)}}function zt(e,t){er(t)||function n(r,m){var o=m.from,c=m.to,p=m.l,m=m.r;Wt(r,o,c),p&&n(r,p),m&&n(r,m)}(e,t)}function Hr(e,t){var n=gn(t),r=n.next();if(r.done)return!1;for(var a=r.value,o=gn(e),c=o.next(a.from),p=c.value;!r.done&&!c.done;){if(ue(p.from,a.to)<=0&&0<=ue(p.to,a.from))return!0;ue(a.from,p.from)<0?a=(r=n.next(p.from)).value:p=(c=o.next(a.from)).value}return!1}function gn(e){var t=er(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&ue(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||ue(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Qr(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),a=1<r?"r":r<-1?"l":"";a&&(t=a=="r"?"l":"r",n=f({},e),r=e[a],e.from=r.from,e.to=r.to,e[a]=r[a],n[a]=r[t],(e[t]=n).d=Jr(n)),e.d=Jr(e)}function Jr(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function bn(e,t){return F(t).forEach(function(n){e[n]?zt(e[n],t[n]):e[n]=function r(a){var o,c,p={};for(o in a)z(a,o)&&(c=a[o],p[o]=!c||typeof c!="object"||Ue.has(c.constructor)?c:r(c));return p}(t[n])}),e}function tr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&Hr(t[n],e[n])})}ne(Ce.prototype,((Me={add:function(e){return zt(this,e),this},addKey:function(e){return Wt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Wt(t,n,n)}),this},hasKey:function(e){var t=gn(this).next(e).value;return t&&ue(t.from,e)<=0&&0<=ue(t.to,e)}})[Ee]=function(){return gn(this)},Me));var vt={},nr={},rr=!1;function wn(e){bn(nr,e),rr||(rr=!0,setTimeout(function(){rr=!1,ar(nr,!(nr={}))},0))}function ar(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,a=Object.values(vt);r<a.length;r++)Zr(c=a[r],e,n,t);else for(var o in e){var c,p=/^idb\:\/\/(.*)\/(.*)\//.exec(o);p&&(o=p[1],p=p[2],(c=vt["idb://".concat(o,"/").concat(p)])&&Zr(c,e,n,t))}n.forEach(function(m){return m()})}function Zr(e,t,n,r){for(var a=[],o=0,c=Object.entries(e.queries.query);o<c.length;o++){for(var p=c[o],m=p[0],v=[],b=0,h=p[1];b<h.length;b++){var T=h[b];tr(t,T.obsSet)?T.subscribers.forEach(function(w){return n.add(w)}):r&&v.push(T)}r&&a.push([m,v])}if(r)for(var y=0,g=a;y<g.length;y++){var _=g[y],m=_[0],v=_[1];e.queries.query[m]=v}}function ro(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Te(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,a=Math.round(10*e.verno),o=!1;function c(){if(t.openCanceller!==r)throw new E.DatabaseClosed("db.open() was cancelled")}function p(){return new V(function(T,y){if(c(),!n)throw new E.MissingAPI;var g=e.name,_=t.autoSchema||!a?n.open(g):n.open(g,a);if(!_)throw new E.MissingAPI;_.onerror=Ge(y),_.onblocked=ge(e._fireOnBlocked),_.onupgradeneeded=ge(function(w){var S;b=_.transaction,t.autoSchema&&!e._options.allowEmptyDB?(_.onerror=qt,b.abort(),_.result.close(),(S=n.deleteDatabase(g)).onsuccess=S.onerror=ge(function(){y(new E.NoSuchDatabase("Database ".concat(g," doesnt exist")))})):(b.onerror=Ge(y),w=w.oldVersion>Math.pow(2,62)?0:w.oldVersion,h=w<1,e.idbdb=_.result,o&&to(e,b),eo(e,w/10,b,y))},y),_.onsuccess=ge(function(){b=null;var w,S,O,A,N,L=e.idbdb=_.result,K=be(L.objectStoreNames);if(0<K.length)try{var j=L.transaction((A=K).length===1?A[0]:A,"readonly");if(t.autoSchema)S=L,O=j,(w=e).verno=S.version/10,O=w._dbSchema=yn(0,S,O),w._storeNames=be(S.objectStoreNames,0),hn(w,[w._allTables],F(O),O);else if(vn(e,e._dbSchema,j),((N=$n(yn(0,(N=e).idbdb,j),N._dbSchema)).add.length||N.change.some(function(M){return M.add.length||M.change.length}))&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),L.close(),a=L.version+1,o=!0,T(p());pn(e,j)}catch{}Et.push(e),L.onversionchange=ge(function(M){t.vcFired=!0,e.on("versionchange").fire(M)}),L.onclose=ge(function(M){e.on("close").fire(M)}),h&&(N=e._deps,j=g,L=N.indexedDB,N=N.IDBKeyRange,Jn(L)||j===sn||Qn(L,N).put({name:j}).catch(Z)),T()},y)}).catch(function(T){switch(T?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),p();break;case"VersionError":if(0<a)return a=0,p()}return V.reject(T)})}var m,v=t.dbReadyResolve,b=null,h=!1;return V.race([r,(typeof navigator>"u"?V.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(T){function y(){return indexedDB.databases().finally(T)}m=setInterval(y,100),y()}).finally(function(){return clearInterval(m)}):Promise.resolve()).then(p)]).then(function(){return c(),t.onReadyBeingFired=[],V.resolve(Zn(function(){return e.on.ready.fire(e.vip)})).then(function T(){if(0<t.onReadyBeingFired.length){var y=t.onReadyBeingFired.reduce(_t,Z);return t.onReadyBeingFired=[],V.resolve(Zn(function(){return y(e.vip)})).then(T)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(T){t.dbOpenError=T;try{b&&b.abort()}catch{}return r===t.openCanceller&&e._close(),Te(T)}).finally(function(){t.openComplete=!0,v()}).then(function(){var T;return h&&(T={},e.tables.forEach(function(y){y.schema.indexes.forEach(function(g){g.name&&(T["idb://".concat(e.name,"/").concat(y.name,"/").concat(g.name)]=new Ce(-1/0,[[[]]]))}),T["idb://".concat(e.name,"/").concat(y.name,"/")]=T["idb://".concat(e.name,"/").concat(y.name,"/:dels")]=new Ce(-1/0,[[[]]])}),it(Ut).fire(T),ar(T,!0)),e})}function or(e){function t(o){return e.next(o)}var n=a(t),r=a(function(o){return e.throw(o)});function a(o){return function(m){var p=o(m),m=p.value;return p.done?m:m&&typeof m.then=="function"?m.then(n,r):C(m)?Promise.all(m).then(n,r):n(m)}}return a(t)()}function _n(e,t,n){for(var r=C(e)?e.slice():[e],a=0;a<n;++a)r.push(t);return r}var ao={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return f(f({},e),{table:function(t){var n=e.table(t),r=n.schema,a={},o=[];function c(h,T,y){var g=Gt(h),_=a[g]=a[g]||[],w=h==null?0:typeof h=="string"?1:h.length,S=0<T,S=f(f({},y),{name:S?"".concat(g,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:S,keyTail:T,keyLength:w,extractKey:Yn(h),unique:!S&&y.unique});return _.push(S),S.isPrimaryKey||o.push(S),1<w&&c(w===2?h[0]:h.slice(0,w-1),T+1,y),_.sort(function(O,A){return O.keyTail-A.keyTail}),S}t=c(r.primaryKey.keyPath,0,r.primaryKey),a[":id"]=[t];for(var p=0,m=r.indexes;p<m.length;p++){var v=m[p];c(v.keyPath,0,v)}function b(h){var T,y=h.query.index;return y.isVirtual?f(f({},h),{query:{index:y.lowLevelIndex,range:(T=h.query.range,y=y.keyTail,{type:T.type===1?2:T.type,lower:_n(T.lower,T.lowerOpen?e.MAX_KEY:e.MIN_KEY,y),lowerOpen:!0,upper:_n(T.upper,T.upperOpen?e.MIN_KEY:e.MAX_KEY,y),upperOpen:!0})}}):h}return f(f({},n),{schema:f(f({},r),{primaryKey:t,indexes:o,getIndexByKeyPath:function(h){return(h=a[Gt(h)])&&h[0]}}),count:function(h){return n.count(b(h))},query:function(h){return n.query(b(h))},openCursor:function(h){var T=h.query.index,y=T.keyTail,g=T.isVirtual,_=T.keyLength;return g?n.openCursor(b(h)).then(function(S){return S&&w(S)}):n.openCursor(h);function w(S){return Object.create(S,{continue:{value:function(O){O!=null?S.continue(_n(O,h.reverse?e.MAX_KEY:e.MIN_KEY,y)):h.unique?S.continue(S.key.slice(0,_).concat(h.reverse?e.MIN_KEY:e.MAX_KEY,y)):S.continue()}},continuePrimaryKey:{value:function(O,A){S.continuePrimaryKey(_n(O,e.MAX_KEY,y),A)}},primaryKey:{get:function(){return S.primaryKey}},key:{get:function(){var O=S.key;return _===1?O[0]:O.slice(0,_)}},value:{get:function(){return S.value}}})}}})}})}};function ir(e,t,n,r){return n=n||{},r=r||"",F(e).forEach(function(a){var o,c,p;z(t,a)?(o=e[a],c=t[a],typeof o=="object"&&typeof c=="object"&&o&&c?(p=me(o))!==me(c)?n[r+a]=t[a]:p==="Object"?ir(o,c,n,r+a+"."):o!==c&&(n[r+a]=t[a]):o!==c&&(n[r+a]=t[a])):n[r+a]=void 0}),F(t).forEach(function(a){z(e,a)||(n[r+a]=t[a])}),n}function sr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var oo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return f(f({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return f(f({},n),{mutate:function(a){var o=X.trans,c=o.table(t).hook,p=c.deleting,m=c.creating,v=c.updating;switch(a.type){case"add":if(m.fire===Z)break;return o._promise("readwrite",function(){return b(a)},!0);case"put":if(m.fire===Z&&v.fire===Z)break;return o._promise("readwrite",function(){return b(a)},!0);case"delete":if(p.fire===Z)break;return o._promise("readwrite",function(){return b(a)},!0);case"deleteRange":if(p.fire===Z)break;return o._promise("readwrite",function(){return function h(T,y,g){return n.query({trans:T,values:!1,query:{index:r,range:y},limit:g}).then(function(_){var w=_.result;return b({type:"delete",keys:w,trans:T}).then(function(S){return 0<S.numFailures?Promise.reject(S.failures[0]):w.length<g?{failures:[],numFailures:0,lastResult:void 0}:h(T,f(f({},y),{lower:w[w.length-1],lowerOpen:!0}),g)})})}(a.trans,a.range,1e4)},!0)}return n.mutate(a);function b(h){var T,y,g,_=X.trans,w=h.keys||sr(r,h);if(!w)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?f(f({},h),{keys:w}):f({},h)).type!=="delete"&&(h.values=D([],h.values)),h.keys&&(h.keys=D([],h.keys)),T=n,g=w,((y=h).type==="add"?Promise.resolve([]):T.getMany({trans:y.trans,keys:g,cache:"immutable"})).then(function(S){var O=w.map(function(A,N){var L,K,j,M=S[N],U={onerror:null,onsuccess:null};return h.type==="delete"?p.fire.call(U,A,M,_):h.type==="add"||M===void 0?(L=m.fire.call(U,A,h.values[N],_),A==null&&L!=null&&(h.keys[N]=A=L,r.outbound||oe(h.values[N],r.keyPath,A))):(L=ir(M,h.values[N]),(K=v.fire.call(U,L,A,M,_))&&(j=h.values[N],Object.keys(K).forEach(function(q){z(j,q)?j[q]=K[q]:oe(j,q,K[q])}))),U});return n.mutate(h).then(function(A){for(var N=A.failures,L=A.results,K=A.numFailures,A=A.lastResult,j=0;j<w.length;++j){var M=(L||w)[j],U=O[j];M==null?U.onerror&&U.onerror(N[j]):U.onsuccess&&U.onsuccess(h.type==="put"&&S[j]?h.values[j]:M)}return{failures:N,results:L,numFailures:K,lastResult:A}}).catch(function(A){return O.forEach(function(N){return N.onerror&&N.onerror(A)}),Promise.reject(A)})})}}})}})}};function ea(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],a=0,o=0;a<t.keys.length&&o<e.length;++a)ue(t.keys[a],e[o])===0&&(r.push(n?Re(t.values[a]):t.values[a]),++o);return r.length===e.length?r:null}catch{return null}}var io={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return f(f({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var a=ea(r.keys,r.trans._cache,r.cache==="clone");return a?V.resolve(a):n.getMany(r).then(function(o){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Re(o):o},o})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function ta(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function na(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var so={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new Ce(e.MIN_KEY,e.MAX_KEY);return f(f({},e),{transaction:function(r,a,o){if(X.subscr&&a!=="readonly")throw new E.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(X.querier));return e.transaction(r,a,o)},table:function(r){var a=e.table(r),o=a.schema,c=o.primaryKey,h=o.indexes,p=c.extractKey,m=c.outbound,v=c.autoIncrement&&h.filter(function(y){return y.compound&&y.keyPath.includes(c.keyPath)}),b=f(f({},a),{mutate:function(y){function g(q){return q="idb://".concat(t,"/").concat(r,"/").concat(q),A[q]||(A[q]=new Ce)}var _,w,S,O=y.trans,A=y.mutatedParts||(y.mutatedParts={}),N=g(""),L=g(":dels"),K=y.type,U=y.type==="deleteRange"?[y.range]:y.type==="delete"?[y.keys]:y.values.length<50?[sr(c,y).filter(function(q){return q}),y.values]:[],j=U[0],M=U[1],U=y.trans._cache;return C(j)?(N.addKeys(j),(U=K==="delete"||j.length===M.length?ea(j,U):null)||L.addKeys(j),(U||M)&&(_=g,w=U,S=M,o.indexes.forEach(function(q){var G=_(q.name||"");function re(te){return te!=null?q.extractKey(te):null}function le(te){return q.multiEntry&&C(te)?te.forEach(function(_e){return G.addKey(_e)}):G.addKey(te)}(w||S).forEach(function(te,Ae){var ee=w&&re(w[Ae]),Ae=S&&re(S[Ae]);ue(ee,Ae)!==0&&(ee!=null&&le(ee),Ae!=null&&le(Ae))})}))):j?(M={from:(M=j.lower)!==null&&M!==void 0?M:e.MIN_KEY,to:(M=j.upper)!==null&&M!==void 0?M:e.MAX_KEY},L.add(M),N.add(M)):(N.add(n),L.add(n),o.indexes.forEach(function(q){return g(q.name).add(n)})),a.mutate(y).then(function(q){return!j||y.type!=="add"&&y.type!=="put"||(N.addKeys(q.results),v&&v.forEach(function(G){for(var re=y.values.map(function(ee){return G.extractKey(ee)}),le=G.keyPath.findIndex(function(ee){return ee===c.keyPath}),te=0,_e=q.results.length;te<_e;++te)re[te][le]=q.results[te];g(G.name).addKeys(re)})),O.mutatedParts=bn(O.mutatedParts||{},A),q})}}),h=function(g){var _=g.query,g=_.index,_=_.range;return[g,new Ce((g=_.lower)!==null&&g!==void 0?g:e.MIN_KEY,(_=_.upper)!==null&&_!==void 0?_:e.MAX_KEY)]},T={get:function(y){return[c,new Ce(y.key)]},getMany:function(y){return[c,new Ce().addKeys(y.keys)]},count:h,query:h,openCursor:h};return F(T).forEach(function(y){b[y]=function(g){var _=X.subscr,w=!!_,S=ta(X,a)&&na(y,g)?g.obsSet={}:_;if(w){var O=function(M){return M="idb://".concat(t,"/").concat(r,"/").concat(M),S[M]||(S[M]=new Ce)},A=O(""),N=O(":dels"),_=T[y](g),w=_[0],_=_[1];if((y==="query"&&w.isPrimaryKey&&!g.values?N:O(w.name||"")).add(_),!w.isPrimaryKey){if(y!=="count"){var L=y==="query"&&m&&g.values&&a.query(f(f({},g),{values:!1}));return a[y].apply(this,arguments).then(function(M){if(y==="query"){if(m&&g.values)return L.then(function(re){return re=re.result,A.addKeys(re),M});var U=g.values?M.result.map(p):M.result;(g.values?A:N).addKeys(U)}else if(y==="openCursor"){var q=M,G=g.values;return q&&Object.create(q,{key:{get:function(){return N.addKey(q.primaryKey),q.key}},primaryKey:{get:function(){var re=q.primaryKey;return N.addKey(re),re}},value:{get:function(){return G&&A.addKey(q.primaryKey),q.value}}})}return M})}N.add(n)}}return a[y].apply(this,arguments)}}),b}})}};function ra(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=f({},t),C(t.keys)&&(t.keys=t.keys.filter(function(a,o){return!(o in n.failures)})),"values"in t&&C(t.values)&&(t.values=t.values.filter(function(a,o){return!(o in n.failures)})),t)}function ur(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<ue(n,r.lower):0<=ue(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?ue(e,t.upper)<0:ue(e,t.upper)<=0));var n,r}function aa(e,t,T,r,a,o){if(!T||T.length===0)return e;var c=t.query.index,p=c.multiEntry,m=t.query.range,v=r.schema.primaryKey.extractKey,b=c.extractKey,h=(c.lowLevelIndex||c).extractKey,T=T.reduce(function(y,g){var _=y,w=[];if(g.type==="add"||g.type==="put")for(var S=new Ce,O=g.values.length-1;0<=O;--O){var A,N=g.values[O],L=v(N);S.hasKey(L)||(A=b(N),(p&&C(A)?A.some(function(q){return ur(q,m)}):ur(A,m))&&(S.addKey(L),w.push(N)))}switch(g.type){case"add":var K=new Ce().addKeys(t.values?y.map(function(G){return v(G)}):y),_=y.concat(t.values?w.filter(function(G){return G=v(G),!K.hasKey(G)&&(K.addKey(G),!0)}):w.map(function(G){return v(G)}).filter(function(G){return!K.hasKey(G)&&(K.addKey(G),!0)}));break;case"put":var j=new Ce().addKeys(g.values.map(function(G){return v(G)}));_=y.filter(function(G){return!j.hasKey(t.values?v(G):G)}).concat(t.values?w:w.map(function(G){return v(G)}));break;case"delete":var M=new Ce().addKeys(g.keys);_=y.filter(function(G){return!M.hasKey(t.values?v(G):G)});break;case"deleteRange":var U=g.range;_=y.filter(function(G){return!ur(v(G),U)})}return _},e);return T===e?e:(T.sort(function(y,g){return ue(h(y),h(g))||ue(v(y),v(g))}),t.limit&&t.limit<1/0&&(T.length>t.limit?T.length=t.limit:e.length===t.limit&&T.length<t.limit&&(a.dirty=!0)),o?Object.freeze(T):T)}function oa(e,t){return ue(e.lower,t.lower)===0&&ue(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function uo(e,t){return function(n,r,a,o){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=ue(n,r))===0){if(a&&o)return 0;if(a)return 1;if(o)return-1}return r}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,r,a,o){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=ue(n,r))===0){if(a&&o)return 0;if(a)return-1;if(o)return 1}return r}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function co(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var a,o;e.subscribers.delete(n),e.subscribers.size===0&&(a=e,o=t,setTimeout(function(){a.subscribers.size===0&&ze(o,a)},3e3))})}var lo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return f(f({},e),{transaction:function(n,r,a){var o,c,p=e.transaction(n,r,a);return r==="readwrite"&&(c=(o=new AbortController).signal,a=function(m){return function(){if(o.abort(),r==="readwrite"){for(var v=new Set,b=0,h=n;b<h.length;b++){var T=h[b],y=vt["idb://".concat(t,"/").concat(T)];if(y){var g=e.table(T),_=y.optimisticOps.filter(function(G){return G.trans===p});if(p._explicit&&m&&p.mutatedParts)for(var w=0,S=Object.values(y.queries.query);w<S.length;w++)for(var O=0,A=(K=S[w]).slice();O<A.length;O++)tr((j=A[O]).obsSet,p.mutatedParts)&&(ze(K,j),j.subscribers.forEach(function(G){return v.add(G)}));else if(0<_.length){y.optimisticOps=y.optimisticOps.filter(function(G){return G.trans!==p});for(var N=0,L=Object.values(y.queries.query);N<L.length;N++)for(var K,j,M,U=0,q=(K=L[N]).slice();U<q.length;U++)(j=q[U]).res!=null&&p.mutatedParts&&(m&&!j.dirty?(M=Object.isFrozen(j.res),M=aa(j.res,j.req,_,g,j,M),j.dirty?(ze(K,j),j.subscribers.forEach(function(G){return v.add(G)})):M!==j.res&&(j.res=M,j.promise=V.resolve({result:M}))):(j.dirty&&ze(K,j),j.subscribers.forEach(function(G){return v.add(G)})))}}}v.forEach(function(G){return G()})}}},p.addEventListener("abort",a(!1),{signal:c}),p.addEventListener("error",a(!1),{signal:c}),p.addEventListener("complete",a(!0),{signal:c})),p},table:function(n){var r=e.table(n),a=r.schema.primaryKey;return f(f({},r),{mutate:function(o){var c=X.trans;if(a.outbound||c.db._options.cache==="disabled"||c.explicit||c.idbtrans.mode!=="readwrite")return r.mutate(o);var p=vt["idb://".concat(t,"/").concat(n)];return p?(c=r.mutate(o),o.type!=="add"&&o.type!=="put"||!(50<=o.values.length||sr(a,o).some(function(m){return m==null}))?(p.optimisticOps.push(o),o.mutatedParts&&wn(o.mutatedParts),c.then(function(m){0<m.numFailures&&(ze(p.optimisticOps,o),(m=ra(0,o,m))&&p.optimisticOps.push(m),o.mutatedParts&&wn(o.mutatedParts))}),c.catch(function(){ze(p.optimisticOps,o),o.mutatedParts&&wn(o.mutatedParts)})):c.then(function(m){var v=ra(0,f(f({},o),{values:o.values.map(function(b,h){var T;return m.failures[h]||(b=(T=a.keyPath)!==null&&T!==void 0&&T.includes(".")?Re(b):f({},b),oe(b,a.keyPath,m.results[h])),b})}),m);p.optimisticOps.push(v),queueMicrotask(function(){return o.mutatedParts&&wn(o.mutatedParts)})}),c):r.mutate(o)},query:function(o){if(!ta(X,r)||!na("query",o))return r.query(o);var c=((v=X.trans)===null||v===void 0?void 0:v.db._options.cache)==="immutable",h=X,p=h.requery,m=h.signal,v=function(g,_,w,S){var O=vt["idb://".concat(g,"/").concat(_)];if(!O)return[];if(!(_=O.queries[w]))return[null,!1,O,null];var A=_[(S.query?S.query.index.name:null)||""];if(!A)return[null,!1,O,null];switch(w){case"query":var N=A.find(function(L){return L.req.limit===S.limit&&L.req.values===S.values&&oa(L.req.query.range,S.query.range)});return N?[N,!0,O,A]:[A.find(function(L){return("limit"in L.req?L.req.limit:1/0)>=S.limit&&(!S.values||L.req.values)&&uo(L.req.query.range,S.query.range)}),!1,O,A];case"count":return N=A.find(function(L){return oa(L.req.query.range,S.query.range)}),[N,!!N,O,A]}}(t,n,"query",o),b=v[0],h=v[1],T=v[2],y=v[3];return b&&h?b.obsSet=o.obsSet:(h=r.query(o).then(function(g){var _=g.result;if(b&&(b.res=_),c){for(var w=0,S=_.length;w<S;++w)Object.freeze(_[w]);Object.freeze(_)}else g.result=Re(_);return g}).catch(function(g){return y&&b&&ze(y,b),Promise.reject(g)}),b={obsSet:o.obsSet,promise:h,subscribers:new Set,type:"query",req:o,dirty:!1},y?y.push(b):(y=[b],(T=T||(vt["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[o.query.index.name||""]=y)),co(b,y,p,m),b.promise.then(function(g){return{result:aa(g.result,o,T?.optimisticOps,r,b,c)}})}})}})}};function Tn(e,t){return new Proxy(e,{get:function(n,r,a){return r==="db"?t:Reflect.get(n,r,a)}})}var Xe=(xe.prototype.version=function(e){if(isNaN(e)||e<.1)throw new E.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new E.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Za),n.stores({}),this._state.autoSchema=!1,n)},xe.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||X.letThrough||this._vip)?e():new V(function(n,r){if(t._state.openComplete)return r(new E.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new E.DatabaseClosed);t.open().catch(Z)}t._state.dbReadyPromise.then(n,r)}).then(e)},xe.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:a}),e.sort(function(o,c){return o.level-c.level}),this},xe.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return r?a.create!==r:!!n&&a.name!==n})),this},xe.prototype.open=function(){var e=this;return ht(tt,function(){return ro(e)})},xe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=Et.indexOf(this);if(0<=t&&Et.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new V(function(n){e.dbReadyResolve=n}),e.openCanceller=new V(function(n,r){e.cancelOpen=r}))},xe.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new E.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new E.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},xe.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new V(function(a,o){function c(){t.close(e);var p=t._deps.indexedDB.deleteDatabase(t.name);p.onsuccess=ge(function(){var m,v,b;m=t._deps,v=t.name,b=m.indexedDB,m=m.IDBKeyRange,Jn(b)||v===sn||Qn(b,m).delete(v).catch(Z),a()}),p.onerror=Ge(o),p.onblocked=t._fireOnBlocked}if(n)throw new E.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(c):c()})},xe.prototype.backendDB=function(){return this.idbdb},xe.prototype.isOpen=function(){return this.idbdb!==null},xe.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},xe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},xe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(xe.prototype,"tables",{get:function(){var e=this;return F(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),xe.prototype.transaction=function(){var e=(function(t,n,r){var a=arguments.length;if(a<2)throw new E.InvalidArgument("Too few arguments");for(var o=new Array(a-1);--a;)o[a-1]=arguments[a];return r=o.pop(),[t,ut(o),r]}).apply(this,arguments);return this._transaction.apply(this,e)},xe.prototype._transaction=function(e,t,n){var r=this,a=X.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var o,c,p=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(c=t.map(function(v){if(v=v instanceof r.Table?v.name:v,typeof v!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return v}),e=="r"||e===Kn)o=Kn;else{if(e!="rw"&&e!=qn)throw new E.InvalidArgument("Invalid transaction mode: "+e);o=qn}if(a){if(a.mode===Kn&&o===qn){if(!p)throw new E.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&c.forEach(function(v){if(a&&a.storeNames.indexOf(v)===-1){if(!p)throw new E.SubTransaction("Table "+v+" not included in parent transaction.");a=null}}),p&&a&&!a.active&&(a=null)}}catch(v){return a?a._promise(null,function(b,h){h(v)}):Te(v)}var m=(function v(b,h,T,y,g){return V.resolve().then(function(){var _=X.transless||X,w=b._createTransaction(h,T,b._dbSchema,y);if(w.explicit=!0,_={trans:w,transless:_},y)w.idbtrans=y.idbtrans;else try{w.create(),w.idbtrans._explicit=!0,b._state.PR1398_maxLoop=3}catch(A){return A.name===u.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return v(b,h,T,null,g)})):Te(A)}var S,O=Be(g);return O&&St(),_=V.follow(function(){var A;(S=g.call(w,w))&&(O?(A=rt.bind(null,null),S.then(A,A)):typeof S.next=="function"&&typeof S.throw=="function"&&(S=or(S)))},_),(S&&typeof S.then=="function"?V.resolve(S).then(function(A){return w.active?A:Te(new E.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):_.then(function(){return S})).then(function(A){return y&&w._resolve(),w._completion.then(function(){return A})}).catch(function(A){return w._reject(A),Te(A)})})}).bind(null,this,o,c,a,n);return a?a._promise(o,m,"lock"):X.trans?ht(X.transless,function(){return r._whenReady(m)}):this._whenReady(m)},xe.prototype.table=function(e){if(!z(this._allTables,e))throw new E.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},xe);function xe(e,t){var n=this;this._middlewares={},this.verno=0;var r=xe.dependencies;this._options=t=f({addons:xe.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},r=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,o,c,p,m,v={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Z,dbReadyPromise:null,cancelOpen:Z,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};v.dbReadyPromise=new V(function(h){v.dbReadyResolve=h}),v.openCanceller=new V(function(h,T){v.cancelOpen=T}),this._state=v,this.name=e,this.on=Mt(this,"populate","blocked","versionchange","close",{ready:[_t,Z]}),this.once=function(h,T){var y=function(){for(var g=[],_=0;_<arguments.length;_++)g[_]=arguments[_];n.on(h).unsubscribe(y),T.apply(n,g)};return n.on(h,y)},this.on.ready.subscribe=J(this.on.ready.subscribe,function(h){return function(T,y){xe.vip(function(){var g,_=n._state;_.openComplete?(_.dbOpenError||V.resolve().then(T),y&&h(T)):_.onReadyBeingFired?(_.onReadyBeingFired.push(T),y&&h(T)):(h(T),g=n,y||h(function w(){g.on.ready.unsubscribe(T),g.on.ready.unsubscribe(w)}))})}}),this.Collection=(a=this,Bt(za.prototype,function(S,w){this.db=a;var y=Fr,g=null;if(w)try{y=w()}catch(O){g=O}var _=S._ctx,w=_.table,S=w.hook.reading.fire;this._ctx={table:w,index:_.index,isPrimKey:!_.index||w.schema.primKey.keyPath&&_.index===w.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:g,or:_.or,valueMapper:S!==ye?S:null}})),this.Table=(o=this,Bt(Br.prototype,function(h,T,y){this.db=o,this._tx=y,this.name=h,this.schema=T,this.hook=o._allTables[h]?o._allTables[h].hook:Mt(null,{creating:[et,Z],reading:[Oe,ye],updating:[Ke,Z],deleting:[Se,Z]})})),this.Transaction=(c=this,Bt($a.prototype,function(h,T,y,g,_){var w=this;h!=="readonly"&&T.forEach(function(S){S=(S=y[S])===null||S===void 0?void 0:S.yProps,S&&(T=T.concat(S.map(function(O){return O.updatesTable})))}),this.db=c,this.mode=h,this.storeNames=T,this.schema=y,this.chromeTransactionDurability=g,this.idbtrans=null,this.on=Mt(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new V(function(S,O){w._resolve=S,w._reject=O}),this._completion.then(function(){w.active=!1,w.on.complete.fire()},function(S){var O=w.active;return w.active=!1,w.on.error.fire(S),w.parent?w.parent._reject(S):O&&w.idbtrans&&w.idbtrans.abort(),Te(S)})})),this.Version=(p=this,Bt(no.prototype,function(h){this.db=p,this._cfg={version:h,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(m=this,Bt(Wr.prototype,function(h,T,y){if(this.db=m,this._ctx={table:h,index:T===":id"?null:T,or:y},this._cmp=this._ascending=ue,this._descending=function(g,_){return ue(_,g)},this._max=function(g,_){return 0<ue(g,_)?g:_},this._min=function(g,_){return ue(g,_)<0?g:_},this._IDBKeyRange=m._deps.IDBKeyRange,!this._IDBKeyRange)throw new E.MissingAPI})),this.on("versionchange",function(h){0<h.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(h){!h.newVersion||h.newVersion<h.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(h.oldVersion/10))}),this._maxKey=Vt(t.IDBKeyRange),this._createTransaction=function(h,T,y,g){return new n.Transaction(h,T,y,n._options.chromeTransactionDurability,g)},this._fireOnBlocked=function(h){n.on("blocked").fire(h),Et.filter(function(T){return T.name===n.name&&T!==n&&!T._state.vcFired}).map(function(T){return T.on("versionchange").fire(h)})},this.use(io),this.use(lo),this.use(so),this.use(ao),this.use(oo);var b=new Proxy(this,{get:function(h,T,y){if(T==="_vip")return!0;if(T==="table")return function(_){return Tn(n.table(_),b)};var g=Reflect.get(h,T,y);return g instanceof Br?Tn(g,b):T==="tables"?g.map(function(_){return Tn(_,b)}):T==="_createTransaction"?function(){return Tn(g.apply(this,arguments),b)}:g}});this.vip=b,r.forEach(function(h){return h(n)})}var xn,Me=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",fo=(cr.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},cr.prototype[Me]=function(){return this},cr);function cr(e){this._subscribe=e}try{xn={indexedDB:I.indexedDB||I.mozIndexedDB||I.webkitIndexedDB||I.msIndexedDB,IDBKeyRange:I.IDBKeyRange||I.webkitIDBKeyRange}}catch{xn={indexedDB:null,IDBKeyRange:null}}function ia(e){var t,n=!1,r=new fo(function(a){var o=Be(e),c,p=!1,m={},v={},b={get closed(){return p},unsubscribe:function(){p||(p=!0,c&&c.abort(),h&&it.storagemutated.unsubscribe(y))}};a.start&&a.start(b);var h=!1,T=function(){return Bn(g)},y=function(_){bn(m,_),tr(v,m)&&T()},g=function(){var _,w,S;!p&&xn.indexedDB&&(m={},_={},c&&c.abort(),c=new AbortController,S=function(O){var A=Tt();try{o&&St();var N=nt(e,O);return N=o?N.finally(rt):N}finally{A&&xt()}}(w={subscr:_,signal:c.signal,requery:T,querier:e,trans:null}),Promise.resolve(S).then(function(O){n=!0,t=O,p||w.signal.aborted||(m={},function(A){for(var N in A)if(z(A,N))return;return 1}(v=_)||h||(it(Ut,y),h=!0),Bn(function(){return!p&&a.next&&a.next(O)}))},function(O){n=!1,["DatabaseClosedError","AbortError"].includes(O?.name)||p||Bn(function(){p||a.error&&a.error(O)})}))};return setTimeout(T,0),b});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var gt=Xe;function lr(e){var t=st;try{st=!0,it.storagemutated.fire(e),ar(e,!0)}finally{st=t}}ne(gt,f(f({},ce),{delete:function(e){return new gt(e,{addons:[]}).delete()},exists:function(e){return new gt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=gt.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(Jn(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(a){return a.name}).filter(function(a){return a!==sn})}):Qn(n,t).toCollection().primaryKeys()).then(e)}catch{return Te(new E.MissingAPI)}var t,n},defineClass:function(){return function(e){B(this,e)}},ignoreTransaction:function(e){return X.trans?ht(X.transless,e):e()},vip:Zn,async:function(e){return function(){try{var t=or(e.apply(this,arguments));return t&&typeof t.then=="function"?t:V.resolve(t)}catch(n){return Te(n)}}},spawn:function(e,t,n){try{var r=or(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:V.resolve(r)}catch(a){return Te(a)}},currentTransaction:{get:function(){return X.trans||null}},waitFor:function(e,t){return t=V.resolve(typeof e=="function"?gt.ignoreTransaction(e):e).timeout(t||6e4),X.trans?X.trans.waitFor(t):t},Promise:V,debug:{get:function(){return Fe},set:function(e){Rt(e)}},derive:R,extend:B,props:ne,override:J,Events:Mt,on:it,liveQuery:ia,extendObservabilitySet:bn,getByKeyPath:fe,setByKeyPath:oe,delByKeyPath:function(e,t){typeof t=="string"?oe(e,t,void 0):"length"in t&&[].map.call(t,function(n){oe(e,n,void 0)})},shallowClone:Ie,deepClone:Re,getObjectDiff:ir,cmp:ue,asap:ie,minKey:-1/0,addons:[],connections:Et,errnames:u,dependencies:xn,cache:vt,semVer:"4.2.0",version:"4.2.0".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),gt.maxKey=Vt(gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(it(Ut,function(e){st||(e=new CustomEvent(Gn,{detail:e}),st=!0,dispatchEvent(e),st=!1)}),addEventListener(Gn,function(e){e=e.detail,st||lr(e)}));var Yt,st=!1,sa=function(){};return typeof BroadcastChannel<"u"&&((sa=function(){(Yt=new BroadcastChannel(Gn)).onmessage=function(e){return e.data&&lr(e.data)}})(),typeof Yt.unref=="function"&&Yt.unref(),it(Ut,function(e){st||Yt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Xe.disableBfCache&&e.persisted){Fe&&console.debug("Dexie: handling persisted pagehide"),Yt?.close();for(var t=0,n=Et;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Xe.disableBfCache&&e.persisted&&(Fe&&console.debug("Dexie: handling persisted pageshow"),sa(),lr({all:new Ce(-1/0,[[]])}))})),V.rejectionMapper=function(e,t){return!e||e instanceof Je||e instanceof TypeError||e instanceof SyntaxError||!e.name||!x[e.name]?e:(t=new x[e.name](t||e.message,e),"stack"in e&&k(t,"stack",{get:function(){return this.inner.stack}}),t)},Rt(Fe),f(Xe,Object.freeze({__proto__:null,Dexie:Xe,liveQuery:ia,Entity:Lr,cmp:ue,PropModification:Kt,replacePrefix:function(e,t){return new Kt({replacePrefix:[e,t]})},add:function(e){return new Kt({add:e})},remove:function(e){return new Kt({remove:e})},default:Xe,RangeSet:Ce,mergeRanges:zt,rangesOverlap:Hr}),{default:Xe}),Xe})}(_r)),_r.exports}var Ri=Ni();const Tr=ka(Ri),ga=Symbol.for("Dexie"),wt=globalThis[ga]||(globalThis[ga]=Tr);if(Tr.semVer!==wt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Tr.semVer} and ${wt.semVer}`);const{liveQuery:ys,mergeRanges:vs,rangesOverlap:gs,RangeSet:bs,cmp:ws,Entity:_s,PropModification:Ts,replacePrefix:xs,add:Ss,remove:Es,DexieYProvider:Ps}=wt;class ki extends wt{constructor(...l){super(...l),this.upgrade()}async upgrade(){if(this.isOpen()){this.close(),ba(this),await this.open();return}ba(this)}}function ba(s){return s.version(1).stores({[Ot]:hr}),s.version(2).stores({[Ot]:hr,[mr]:ya}),s.version(2.1).stores({[Ot]:hr,[mr]:ya}).upgrade(l=>{l.table(mr).toCollection().modify(d=>{typeof d.file=="string"&&(d.file=new Blob([d.file],{type:"text/xml"}))})}),s}async function Fi(s){const{databaseInstance:l,records:d}=s,f=l.table(Ot);await l.transaction("rw",f,()=>f.bulkAdd(d))}async function Li(s){if(await wt.exists(s))return await wt.delete(s)}const ji={useBrowserApi:!0,chunkSize:32*1024,batchSize:2e3};async function yr(s){const{files:l,options:d}=s;return Mi({files:l,options:d,isForTest:!1})}async function Mi(s){const{files:l,options:d,isForTest:f}=s,D={...ji,...d},I=[];if(l.length===0)throw new Error("No files provided for import.");for(const F of l){if(!Bi(F)){console.error(`Unsupported file type: ${F.name}`);continue}F.size===0&&console.warn(`File is empty: ${F.name}`);const C=await qi({file:F,options:D,isForTest:f});I.push(C)}return I}function Bi(s){return yi.some(l=>s.name.toLowerCase().endsWith(l))}function Ki(s){return s.name.replace(/\.[^.]+$/,"")}async function qi(s){const{file:l,options:d,isForTest:f}=s;try{const D=Ki(l);await Li(D);const I=new ki(D);return d.useBrowserApi&&l.size!==0&&await Ui({file:l,databaseInstance:I,options:{useTestIds:f,chunkSize:d.chunkSize,batchSize:d.batchSize}}),D}catch(D){throw console.error(`Error importing file ${l.name}:`,D),D}}async function Ui(s){const{file:l,databaseInstance:d,options:f}=s,D=l.stream().getReader(),I=bi({useTestIds:f.useTestIds}),F=new TextDecoder,C=new Uint8Array(0);return await xr({databaseInstance:d,reader:D,sax:I,textDecoder:F,buffer:C,options:f})}async function xr(s){const{databaseInstance:l,reader:d,sax:f,textDecoder:D,buffer:I,options:F}=s,{chunkSize:C,batchSize:B}=F,{done:$,value:Q}=await d.read();if($){if(I.length>0){const ne=D.decode(I);f.parser.write(ne)}return f.parser.close(),await wa({databaseInstance:l,sax:f,batchSize:0})}if(!Q)return await xr(s);let z=new Uint8Array(I.length+Q.length);for(z.set(I),z.set(Q,I.length);z.length>=C;){const ne=z.slice(0,C);z=z.slice(C);const W=D.decode(ne,{stream:!0});f.parser.write(W),await wa({databaseInstance:l,sax:f,batchSize:B})}return await xr({...s,buffer:z})}async function wa(s){const{databaseInstance:l,sax:d,batchSize:f}=s;if(d.getSize()>=f){const D=d.drainBatch(),I=pi({currentBatch:D});await Fi({databaseInstance:l,records:I})}}const Vi="_temp-idb-id",Gi={AccessControl:[],AccessPoint:["Text","Private","Server","LN","ServerAt","Services","GOOSESecurity","SMVSecurity","Labels"],Address:["P"],AllocationRole:["Text","FunctionRef"],AllocationRoleRef:["Text","FunctionalVariantRef"],AnalogueWiringParameters:["Text"],AnalogueWiringParametersRef:["Text"],Application:["Text","FunctionRole","FunctionalVariant","FunctionalVariantGroup","AllocationRoleRef","ApplicationSclRef"],ApplicationSclRef:["Text","SclFileReference"],Association:[],Authentication:[],BDA:["Text","Private","Val","Labels"],Bay:["Text","Private","Labels","LNode","PowerTransformer","GeneralEquipment","ConductingEquipment","ConnectivityNode","Function"],BayType:[],BehaviorDescription:["Text","InputVar","OutputVar","BehaviorReference"],BehaviorDescriptionRef:["Text","FunctionalVariantRef","InputVarRef","OutputVarRef"],BehaviorReference:["Text"],BinaryWiringParameters:["Text"],BinaryWiringParametersRef:["Text"],BitRate:[],CheckoutID:["SubCheckoutID"],ClientLN:[],ClientServices:["TimeSyncProt","GOOSEMcSecurity","SVMcSecurity","Security"],CommProt:[],Communication:["Text","Private","SubNetwork"],CommunicationServiceSpecifications:["Text","GooseParameters","SMVParameters","ReportParameters"],ConductingEquipment:["Text","Private","Labels","LNode","Terminal","SubEquipment","EqFunction"],ConfDataSet:[],ConfLNs:[],ConfLdName:[],ConfLogControl:[],ConfReportControl:[],ConfSG:[],ConfSigRef:[],ConnectedAP:["Text","Private","Address","GSE","SMV","PhysConn"],ConnectivityNode:["Text","Private","Labels","LNode"],ControlRef:["Text","BinaryWiringParametersRef","AnalogueWiringParametersRef"],ControllingLNode:["Text","BinaryWiringParametersRef","AnalogueWiringParametersRef"],DA:["Text","Private","Val","Labels","ProtNs"],DAI:["Text","Private","Val","Labels"],DAS:["Text","SubscriberLNode","ControllingLNode","ProcessEcho","LogParametersRef","Val","Labels"],DAType:["Text","Private","BDA","ProtNs","Labels"],DO:["Text","Private","Labels"],DOI:["Text","Private","SDI","DAI","Labels"],DOS:["Text","SDS","DAS","SubscriberLNode","ControllingLNode","ProcessEcho","LogParametersRef","Labels"],DOType:["Text","Private","SDO","DA","Labels"],DataObjectDirectory:[],DataSet:["Text","Private","FCDA"],DataSetDirectory:[],DataTypeTemplates:["LNodeType","DOType","DAType","EnumType"],DynAssociation:[],DynDataSet:[],EnumType:["Text","Private","EnumVal"],EnumVal:[],EqFunction:["Text","Private","Labels","LNode","GeneralEquipment","EqSubFunction"],EqSubFunction:["Text","Private","Labels","LNode","GeneralEquipment","EqSubFunction"],ExtCtrl:["Text","Private"],ExtRef:["Text","Private"],FCDA:[],FileHandling:[],Function:["Text","Private","Labels","LNode","SubFunction","GeneralEquipment","ConductingEquipment"],FunctionCatRef:["Text"],FunctionCategory:["Text","SubCategory","FunctionCatRef"],FunctionCategoryRef:["Text","FunctionalVariantRef"],FunctionRef:["Text","FunctionalVariantRef","SignalRole"],FunctionRole:["Text","FunctionalVariantRef","FunctionRoleContent"],FunctionRoleContent:["Text","FunctionRef","BehaviorDescriptionRef","ProcessResourceRef","VariableRef","FunctionCategoryRef","PowerSystemRelationRef"],FunctionSclRef:["Text","SclFileReference"],FunctionTemplate:["Text","LNode","SubFunctionTemplate","GeneralEquipment","ConductingEquipment"],FunctionalSubVariant:["Text","FunctionalSubVariant","VariableRef"],FunctionalVariant:["Text","FunctionalSubVariant","VariableRef"],FunctionalVariantGroup:["Text","FunctionalVariant"],FunctionalVariantRef:["Text"],GOOSE:[],GOOSEMcSecurity:[],GOOSESecurity:["Text","Private","Labels","Subject","IssuerName"],GSE:["Text","Private","Address","MinTime","MaxTime"],GSEControl:["Text","Private","IEDName","Protocol"],GSEDir:[],GSESettings:["McSecurity"],GSSE:[],GeneralEquipment:["Text","Private","Labels","LNode","EqFunction"],GetCBValues:[],GetDataObjectDefinition:[],GetDataSetValue:[],GetDirectory:[],GooseParameters:["Text","L2CommParameters","L3IPv4CommParameters","L3IPv6CommParameters"],GooseParametersRef:["Text"],Header:["Text","History","SourceFiles"],History:["Hitem"],Hitem:["SourceFiles"],IED:["Text","Private","Services","AccessPoint","KDC","IEDSourceFiles","MinRequestedSCDFiles","Labels"],IEDName:[],IEDSourceFiles:["Text","Private","SclFileReference"],InputVar:["Text"],InputVarRef:["Text","FunctionalVariantRef"],Inputs:["Text","Private","ExtRef"],IssuerName:[],KDC:[],L2CommParameters:["Text"],L3IPv4CommParameters:["Text"],L3IPv6CommParameters:["Text"],LDevice:["Text","Private","LN0","LN","AccessControl","Labels"],LN:["Text","Private","DataSet","ReportControl","LogControl","DOI","Inputs","Outputs","Log","Labels"],LN0:["Text","Private","DataSet","ReportControl","LogControl","DOI","Inputs","Outputs","Log","Labels","GSEControl","SampledValueControl","SettingControl"],LNode:["Text","Private","Labels"],LNodeDataRef:["Text","FunctionalVariantRef"],LNodeInputRef:["Text","FunctionalVariantRef"],LNodeInputs:["Text","SourceRef"],LNodeOutputRef:["Text","FunctionalVariantRef"],LNodeOutputs:["Text","ControlRef"],LNodeSpecNaming:["Text"],LNodeType:["Text","Private","DO","Labels"],Label:[],Labels:["Text","Private","Label"],Line:["Text","Private","Labels","LNode","GeneralEquipment","Function","Voltage","ConductingEquipment","ConnectivityNode"],Log:["Text","Private"],LogControl:["Text","Private","TrgOps"],LogParameters:["Text"],LogParametersRef:["Text"],LogSettings:[],MaxTime:[],McSecurity:[],MinRequestedSCDFile:[],MinRequestedSCDFiles:["Text","Private","MinRequestedSCDFile"],MinTime:[],MultiAPPerSubNet:[],NeutralPoint:["Text","Private"],OptFields:[],OutputVar:["Text"],OutputVarRef:["Text","FunctionalVariantRef"],Outputs:["Text","Private","ExtCtrl"],P:[],PhysConn:["Text","Private","P"],PowerSystemRelation:["Text"],PowerSystemRelationRef:["Text","FunctionalVariantRef"],PowerSystemRelations:["Text","PowerSystemRelation"],PowerTransformer:["Text","Private","Labels","LNode","TransformerWinding","SubEquipment","EqFunction"],Private:[],Process:["Text","Private","Labels","LNode","GeneralEquipment","Function","ConductingEquipment","Substation","Line","Process"],ProcessEcho:["Text"],ProcessResource:["Text","Resource"],ProcessResourceRef:["Text","FunctionalVariantRef"],ProcessResources:["Text","ProcessResource"],Project:["Text","ProjectProcessReference"],ProjectProcessReference:["Text"],ProtNs:[],Protocol:[],ReadWrite:[],RedProt:[],ReportControl:["Text","Private","TrgOps","OptFields","RptEnabled"],ReportParameters:["Text"],ReportParametersRef:["Text"],ReportSettings:[],Resource:[],RptEnabled:["Text","Private","ClientLN"],SCL:["Text","Private","Header","Substation","Communication","IED","DataTypeTemplates","Line","Process"],SCSM:[],SDI:["Text","Private","SDI","DAI","Labels"],SDO:["Text","Private","Labels"],SDS:["Text","SDS","DAS","SubscriberLNode","ControllingLNode","ProcessEcho","LogParametersRef","Labels"],SGEdit:[],SMV:["Text","Private","Address"],SMVParameters:["Text","L2CommParameters","L3IPv4CommParameters","L3IPv6CommParameters"],SMVParametersRef:["Text"],SMVSecurity:["Text","Private","Labels","Subject","IssuerName"],SMVSettings:["SmpRate","SamplesPerSec","SecPerSamples","McSecurity"],SMVsc:[],SVMcSecurity:[],SampledValueControl:["Text","Private","IEDName","SmvOpts","Protocol"],SamplesPerSec:[],SclFileReference:["Text","Private"],SecPerSamples:[],Security:[],Server:["Text","Private","Authentication","LDevice","Association"],ServerAt:["Text","Private"],ServiceSpecifications:["Text","GooseParameters","SMVParameters","ReportParameters","BinaryWiringParameters","AnalogueWiringParameters","LogParameters"],Services:["DynAssociation","SettingGroups","GetDirectory","GetDataObjectDefinition","DataObjectDirectory","GetDataSetValue","SetDataSetValue","DataSetDirectory","ConfDataSet","DynDataSet","ReadWrite","TimerActivatedControl","ConfReportControl","GetCBValues","ConfLogControl","ReportSettings","LogSettings","GSESettings","SMVSettings","GSEDir","GOOSE","GSSE","SMVsc","FileHandling","ConfLNs","ClientServices","ConfLdName","SupSubscription","ConfSigRef","ValueHandling","RedProt","TimeSyncProt","CommProt","SCSM","Security","MultiAPPerSubNet"],SetDataSetValue:[],SettingControl:["Text","Private"],SettingGroups:["SGEdit","ConfSG"],SignalRole:["Text","FunctionalVariantRef","LNodeInputRef","LNodeOutputRef","LNodeDataRef"],SmpRate:[],SmvOpts:[],SourceFiles:["Text","Private","SclFileReference"],SourceRef:["Text","GooseParametersRef","SMVParametersRef","ReportParametersRef","BinaryWiringParametersRef","AnalogueWiringParametersRef"],SubCategory:["Text","SubCategory","FunctionCatRef"],SubCheckoutID:["SubCheckoutID"],SubEquipment:["Text","Private","Labels","LNode","EqFunction"],SubFunction:["Text","Private","Labels","LNode","GeneralEquipment","ConductingEquipment","SubFunction"],SubFunctionTemplate:["Text","LNode","GeneralEquipment","ConductingEquipment","SubFunctionTemplate"],SubNetwork:["Text","Private","Labels","BitRate","ConnectedAP"],Subject:[],SubscriberLNode:["Text","GooseParametersRef","SMVParametersRef","ReportParametersRef","BinaryWiringParametersRef"],Substation:["Text","Private","Labels","LNode","PowerTransformer","GeneralEquipment","VoltageLevel","Function"],SupSubscription:[],TapChanger:["Text","Private","Labels","LNode","SubEquipment","EqFunction"],Terminal:["Text","Private"],Text:[],TimeSyncProt:[],TimerActivatedControl:[],TransformerWinding:["Text","Private","Labels","LNode","Terminal","SubEquipment","TapChanger","NeutralPoint","EqFunction"],TrgOps:[],Val:[],ValueHandling:[],Variable:["Text","VariableApplyTo"],VariableApplyTo:["Text"],VariableRef:["Text","FunctionalVariantRef"],Voltage:[],VoltageLevel:["Text","Private","Labels","LNode","PowerTransformer","GeneralEquipment","Voltage","Bay","Function"]},Wi={attributes:{details:{release:{default:"5",namespace:null},revision:{default:"C",namespace:null},version:{default:"2007",namespace:null},"eIEC61850-6-100:release":{default:"1",namespace:{uri:"http://www.iec.ch/61850/2019/SCL/6-100",prefix:"eIEC61850-6-100"}},"eIEC61850-6-100:revision":{default:"C",namespace:{uri:"http://www.iec.ch/61850/2019/SCL/6-100",prefix:"eIEC61850-6-100"}},"eIEC61850-6-100:version":{default:"2019",namespace:{uri:"http://www.iec.ch/61850/2019/SCL/6-100",prefix:"eIEC61850-6-100"}}}}};async function zi(s){return Yi({databaseName:s.databaseName,withDatabaseIds:!1})}async function Yi(s){const{databaseName:l,withDatabaseIds:d}=s,f=new wt(l);await f.open();const D=await Xi({databaseInstance:f,withDatabaseIds:d});if(!D)throw new Error("Failed to rebuild XML document from IndexedDB.");return{xmlDocument:D,filename:f.name+".scd"}}async function Xi(s){const{databaseInstance:l,withDatabaseIds:d}=s;{const f=document.implementation.createDocument("http://www.iec.ch/61850/2003/SCL",null,null),D=await l.table(Ot).where({tagName:"SCL"}).first();if(!D)throw new Error("No SCL root element found in DB");const I=f.createElementNS(D.namespace.uri,D.tagName);return I.setAttribute("xmlns",D.namespace.uri),D.attributes&&ja({document:f,element:I,attributes:D.attributes,isRoot:!0}),Ba({rootElement:I,namespace:D.namespace}),D.value&&(I.textContent=D.value.trim()),f.appendChild(I),await La({databaseInstance:l,withDatabaseIds:d,xmlDocument:f,databaseRecord:D,parentDomElement:I})}}async function La(s){const{databaseInstance:l,withDatabaseIds:d,xmlDocument:f,databaseRecord:D,parentDomElement:I}=s;if(!D.children)return;const F=D.children.map($=>$.id),C=await l.table(Ot).bulkGet(F);Qi({childrenRecords:C,parentRecord:D});const B=Hi({parentTagName:D.tagName,childrenRecords:C});for(const $ of B){const Q=$i({document:f,record:$,withDatabaseIds:d});I.appendChild(Q),await La({databaseInstance:l,withDatabaseIds:d,xmlDocument:f,databaseRecord:$,parentDomElement:Q})}return s.xmlDocument}function $i(s){const{document:l,record:d,withDatabaseIds:f}=s;let D;return d.namespace.uri===Cn.default.uri?D=l.createElementNS(d.namespace.uri,d.tagName):(Ma({document:l,namespace:d.namespace}),D=l.createElementNS(d.namespace.uri,`${d.namespace.prefix}:${d.tagName}`)),d.attributes&&ja({document:l,element:D,attributes:d.attributes,isRoot:!1}),d.value&&(D.textContent=d.value.trim()),f&&D.setAttribute(Vi,d.id),D}function ja(s){const{document:l,element:d,attributes:f,isRoot:D}=s;for(const I of f)if(!(I.name==="xmlns"||I.name.startsWith("xmlns:")))if(gi(I)){const F=I.namespace?.prefix||"";if(F==="xmlns")continue;!D&&F&&Ma({document:l,namespace:I.namespace});const C=I.name.includes(":")&&I.name.split(":").pop()||I.name,B=F?`${F}:${C}`:C;d.setAttributeNS(I.namespace.uri,B,String(I.value))}else d.setAttribute(I.name,String(I.value))}function Ma(s){const{document:l,namespace:d}=s,f=l.documentElement;if(!f)return;const D="http://www.w3.org/2000/xmlns/";f.getAttributeNS(D,d.prefix)===null&&(f.setAttributeNS(D,`xmlns:${d.prefix}`,d.uri),Ba({rootElement:f,namespace:d}))}function Ba(s){const{rootElement:l,namespace:d}=s,f=Object.entries(Wi.attributes.details).filter(([D,I])=>d.uri===Cn.default.uri?I.namespace===null:I.namespace?.prefix===d.prefix&&I.namespace?.uri===d.uri);if(f.length>0)for(const[D,I]of f){const F=D.includes(":")&&D.split(":").pop()||D;if(!(I.namespace===null?l.hasAttribute(F):l.hasAttributeNS(I.namespace.uri,F)))if(I.namespace===null)l.setAttribute(F,I.default);else{const C=`${I.namespace.prefix}:${F}`;l.setAttributeNS(I.namespace.uri,C,I.default)}}}function Hi(s){const{parentTagName:l,childrenRecords:d}=s,f=[],D=new Set(Gi[l]);if(!D.size)return d;const I=new Map,F=[];for(const C of D)I.set(C,[]);for(const C of d)D.has(C.tagName)?I.get(C.tagName)?.push(C):F.push(C);for(const C of D){const B=I.get(C);B&&B.length&&f.push(...B)}return f.push(...F),f}function Qi(s){const{childrenRecords:l,parentRecord:d}=s,f=l.map((D,I)=>D===void 0?I:-1).filter(D=>D!==-1);if(f.length>0){const D=f.map(I=>{const F=d.children[I];return`'${F.tagName}' (id: ${F.id})`});throw new Error(`Database corruption detected: Parent element '${d.tagName}' (id: ${d.id}) references ${f.length} non-existent child record(s): ${D.join(", ")}`)}}var Dn={exports:{}},vr={exports:{}},_a;function Ji(){return _a||(_a=1,function(s,l){Object.defineProperty(l,"__esModule",{value:!0}),l.ParsingError=void 0;class d extends Error{constructor(Y,ie){super(Y),this.cause=ie}}l.ParsingError=d;let f;function D(){return B(!1)||ne()||z()||Q()||C(!1)}function I(){return R(/\s*/),B(!0)||z()||$()||C(!1)}function F(){const J=C(!0),Y=[];let ie,fe=I();for(;fe;){if(fe.node.type==="Element"){if(ie)throw new Error("Found multiple root nodes");ie=fe.node}fe.excluded||Y.push(fe.node),fe=I()}if(!ie)throw new d("Failed to parse XML","Root Element not found");if(f.xml.length!==0)throw new d("Failed to parse XML","Not Well-Formed XML");return{declaration:J?J.node:null,root:ie,children:Y}}function C(J){const Y=R(J?/^<\?(xml(-stylesheet)?)\s*/:/^<\?([\w-:.]+)\s*/);if(!Y)return;const ie={name:Y[1],type:"ProcessingInstruction",attributes:{}};for(;!(H()||ae("?>"));){const fe=W();if(fe)ie.attributes[fe.name]=fe.value;else return}return R(/\?>/),{excluded:J?!1:f.options.filter(ie)===!1,node:ie}}function B(J){const Y=R(/^<([^?!</>\s]+)\s*/);if(!Y)return;const ie={type:"Element",name:Y[1],attributes:{},children:[]},fe=J?!1:f.options.filter(ie)===!1;for(;!(H()||ae(">")||ae("?>")||ae("/>"));){const Ie=W();if(Ie)ie.attributes[Ie.name]=Ie.value;else return}if(R(/^\s*\/>/))return ie.children=null,{excluded:fe,node:ie};R(/\??>/);let oe=D();for(;oe;)oe.excluded||ie.children.push(oe.node),oe=D();if(f.options.strictMode){const Ie=`</${ie.name}>`;if(f.xml.startsWith(Ie))f.xml=f.xml.slice(Ie.length);else throw new d("Failed to parse XML",`Closing tag not matching "${Ie}"`)}else R(/^<\/[\w-:.\u00C0-\u00FF]+\s*>/);return{excluded:fe,node:ie}}function $(){const J=R(/^<!DOCTYPE\s+\S+\s+SYSTEM[^>]*>/)||R(/^<!DOCTYPE\s+\S+\s+PUBLIC[^>]*>/)||R(/^<!DOCTYPE\s+\S+\s*\[[^\]]*]>/)||R(/^<!DOCTYPE\s+\S+\s*>/);if(J){const Y={type:"DocumentType",content:J[0]};return{excluded:f.options.filter(Y)===!1,node:Y}}}function Q(){if(f.xml.startsWith("<![CDATA[")){const J=f.xml.indexOf("]]>");if(J>-1){const Y=J+3,ie={type:"CDATA",content:f.xml.substring(0,Y)};return f.xml=f.xml.slice(Y),{excluded:f.options.filter(ie)===!1,node:ie}}}}function z(){const J=R(/^<!--[\s\S]*?-->/);if(J){const Y={type:"Comment",content:J[0]};return{excluded:f.options.filter(Y)===!1,node:Y}}}function ne(){const J=R(/^([^<]+)/);if(J){const Y={type:"Text",content:J[1]};return{excluded:f.options.filter(Y)===!1,node:Y}}}function W(){const J=R(/([^=]+)\s*=\s*("[^"]*"|'[^']*'|[^>\s]+)\s*/);if(J)return{name:J[1].trim(),value:k(J[2].trim())}}function k(J){return J.replace(/^['"]|['"]$/g,"")}function R(J){const Y=f.xml.match(J);if(Y)return f.xml=f.xml.slice(Y[0].length),Y}function H(){return f.xml.length===0}function ae(J){return f.xml.indexOf(J)===0}function be(J,Y={}){J=J.trim();const ie=Y.filter||(()=>!0);return f={xml:J,options:Object.assign(Object.assign({},Y),{filter:ie,strictMode:Y.strictMode===!0})},F()}s.exports=be,l.default=be}(vr,vr.exports)),vr.exports}var Ta=Dn.exports,xa;function Zi(){return xa||(xa=1,function(s,l){var d=Ta&&Ta.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(l,"__esModule",{value:!0});const f=d(Ji());function D(k){if(!k.options.indentation&&!k.options.lineSeparator)return;k.content+=k.options.lineSeparator;let R;for(R=0;R<k.level;R++)k.content+=k.options.indentation}function I(k){k.content=k.content.replace(/ +$/,"");let R;for(R=0;R<k.level;R++)k.content+=k.options.indentation}function F(k,R){k.content+=R}function C(k,R,H){if(typeof k.content=="string")B(k.content,R,H);else if(k.type==="Element")Q(k,R,H);else if(k.type==="ProcessingInstruction")ne(k,R);else throw new Error("Unknown node type: "+k.type)}function B(k,R,H){if(!H){const ae=k.trim();(R.options.lineSeparator||ae.length===0)&&(k=ae)}k.length>0&&(!H&&R.content.length>0&&D(R),F(R,k))}function $(k,R){const H="/"+k.join("/"),ae=k[k.length-1];return R.includes(ae)||R.includes(H)}function Q(k,R,H){if(R.path.push(k.name),!H&&R.content.length>0&&D(R),F(R,"<"+k.name),z(R,k.attributes),k.children===null||R.options.forceSelfClosingEmptyTag&&k.children.length===0){const ae=R.options.whiteSpaceAtEndOfSelfclosingTag?" />":"/>";F(R,ae)}else if(k.children.length===0)F(R,"></"+k.name+">");else{const ae=k.children;F(R,">"),R.level++;let be=k.attributes["xml:space"]==="preserve"||H,J=!1;if(!be&&R.options.ignoredPaths&&(J=$(R.path,R.options.ignoredPaths),be=J),!be&&R.options.collapseContent){let Y=!1,ie=!1,fe=!1;ae.forEach(function(oe,Ie){oe.type==="Text"?(oe.content.includes(`
`)?(ie=!0,oe.content=oe.content.trim()):(Ie===0||Ie===ae.length-1)&&!H&&oe.content.trim().length===0&&(oe.content=""),(oe.content.trim().length>0||ae.length===1)&&(Y=!0)):oe.type==="CDATA"?Y=!0:fe=!0}),Y&&(!fe||!ie)&&(be=!0)}ae.forEach(function(Y){C(Y,R,H||be)}),R.level--,!H&&!be&&D(R),J&&I(R),F(R,"</"+k.name+">")}R.path.pop()}function z(k,R){Object.keys(R).forEach(function(H){const ae=R[H].replace(/"/g,"&quot;");F(k," "+H+'="'+ae+'"')})}function ne(k,R){R.content.length>0&&D(R),F(R,"<?"+k.name),z(R,k.attributes),F(R,"?>")}function W(k,R={}){R.indentation="indentation"in R?R.indentation:"    ",R.collapseContent=R.collapseContent===!0,R.lineSeparator="lineSeparator"in R?R.lineSeparator:`\r
`,R.whiteSpaceAtEndOfSelfclosingTag=R.whiteSpaceAtEndOfSelfclosingTag===!0,R.throwOnFailure=R.throwOnFailure!==!1;try{const H=(0,f.default)(k,{filter:R.filter,strictMode:R.strictMode}),ae={content:"",level:0,options:R,path:[]};return H.declaration&&ne(H.declaration,ae),H.children.forEach(function(be){C(be,ae,!1)}),R.lineSeparator?ae.content.replace(/\r\n/g,`
`).replace(/\n/g,R.lineSeparator):ae.content}catch(H){if(R.throwOnFailure)throw H;return k}}W.minify=(k,R={})=>W(k,Object.assign(Object.assign({},R),{indentation:"",lineSeparator:""})),s.exports=W,l.default=W}(Dn,Dn.exports)),Dn.exports}var es=Zi();const ts=ka(es);function ns(s){return ts(s)}const rs=On("file",()=>{const s=la("currentActiveFileDatabaseName","",localStorage),l=la("currentImportedDatabaseNames",[],localStorage),d=He(!1);async function f(){const{promise:B,resolve:$}=Promise.withResolvers(),{open:Q,onChange:z}=fa({accept:"asd"});return z(async ne=>{if(!ne||ne.length===0)return;const W=Array.from(ne),k=[];for(const H of W){const ae=H.name.replace(/\.[^.]+$/,"");(await(indexedDB.databases?.()||[])).some(Y=>Y.name===ae)&&!window.confirm(`A file named "${ae}" already exists in the database. Do you want to replace it?`)||k.push(H)}if(k.length===0){$();return}const R=await yr({files:k});s.value=R[0],R.length&&console.info(`Files imported successfully: ${R.join(", ")}`),$()}),Q(),B}async function D(){try{if(!s.value)throw new Error("No active file to save - please open a file first");const B=await zi({databaseName:s.value}),ne=`<?xml version="1.0" encoding="UTF-8"?>
`+new XMLSerializer().serializeToString(B.xmlDocument),W=ns(ne),k=new Blob([W],{type:"application/xml"}),R=$o(k);if(!R.value)throw new Error("Failed to create object URL for the XML document");const H=document.createElement("a");H.href=R.value,H.download=B.filename,document.body.appendChild(H),H.click(),setTimeout(()=>{document.body.removeChild(H)},0)}catch(B){throw console.error("Error saving file:",B),B}}async function I(){const{promise:B,resolve:$}=Promise.withResolvers(),{open:Q,onChange:z}=fa({accept:"fsd"});return z(async ne=>{if(!ne||ne.length===0)return;const W=Array.from(ne),k=await yr({files:W});l.value=[...l.value,...k],$()}),Q(),B}async function F(B){if((await(indexedDB.databases?.()||[])).some(H=>H.name===B)&&!window.confirm(`A file named "${B}" already exists in the database. Do you want to replace it?`))return;const z=()=>crypto.randomUUID(),ne=`
				<?xml version="1.0" encoding="UTF-8"?>
				<SCL xmlns="http://www.iec.ch/61850/2003/SCL" version="2007" revision="C" release="5">
  				<Header id="${B}" version="0" revision="1" toolID="SeptKit Set" uuid="${z()}"/>
					<Substation name="TEMPLATE" uuid="${z()}">
						<VoltageLevel name="TEMPLATE" uuid="${z()}">
						 <Bay name="TEMPLATE" uuid="${z()}">
						 </Bay>
						</VoltageLevel>
					</Substation>
				</SCL>
				`,W=`${B}.xml`,k=new File([ne],W,{type:"text/xml"}),R=await yr({files:[k]});R.length&&(s.value=R[0],window.alert(`New Project Created: ${B}`)),d.value=!1}function C(){d.value=!0}return{currentActiveFileDatabaseName:s,currentImportedDatabaseNames:l,newFileModalOpen:d,openFiles:f,saveFile:D,importFiles:I,openNewFileModal:C,createNewFile:F}});let gr;function as(){return gr||(gr=os()),gr}function os(){return{activeFileName:is()}}function is(){let s=[],l;const d=rs();return Ct(()=>d.currentActiveFileDatabaseName,D),l=d.currentActiveFileDatabaseName,{get value(){return l},subscribe:f};function f(I){return s.push(I),function(){s=s.filter(C=>C!==I)}}function D(I){for(const F of s)F(I,l);l=I}}const ss={class:"root",name:"widget-site"},us=["id"],cs=wo({__name:"widget-site",props:{widget:{},rootId:{}},setup(s){const l=s,d=Qo(),f=Jo();let D=as();const I=_o("widget-root");async function F(C){if(!C){console.info({msg:"no startFnUrl yet"});return}const B=await oi(C);if(B){if(!I.value){console.error({msg:"could not find widget root",widgetRoot:I});return}I.value.innerHTML="",l.widget?.location==="mainArea"?d.unmountExtension=B(l.rootId,D):l.widget?.location==="primarySidebar"&&(f.unmountExtension=B(l.rootId,D))}}return Er(async()=>{l.widget?.startFnUrl&&F(l.widget.startFnUrl)}),(C,B)=>(So(),To("div",ss,[xo("div",{class:"widget-root h-full",ref:"widget-root",id:l.rootId},"",8,us)]))}}),Ds=Ho(cs,[["__scopeId","data-v-a1849e70"]]);function Is(s,l){const d=Ka(l);d.value=s}function Os(s,l){const d=Ka(s);Ct(()=>d.value,f=>{f&&l(f)},{immediate:!0})}function Ka(s){const l=s;return l.widgetPortal||(l.widgetPortal=Eo({value:void 0})),l.widgetPortal}export{Ds as W,Ho as _,Qo as a,ds as b,Jo as c,rs as d,Dr as e,hs as f,fs as g,Os as h,ms as l,Is as s,ps as u};
