import{_ as D,u as ie,a as ce,l as le,W as H,s as ue,b as J,c as K,d as de,e as fe}from"./widget-portal-DDCAbGtP.js";import{c as b,a as g,r as C,o as m,d as $,b as I,F,e as M,w as Q,v as ve,f as k,g as me,h as A,u as w,i as T,j as L,n as pe,k as Z,t as be,l as he,m as _e,p as ge,q as we,s as U,x as ee,y,z as ye,A as te,B as ke,C as ne,D as $e,E as P,G as S}from"./index-BTSh-KAj.js";const xe={},We={class:"layout"},Ee={class:"menubar"},Ae={class:"activity-bar"},Ce={class:"primary-sidebar"},Se={class:"main-area"};function Ie(e,t){return m(),b("div",We,[g("div",Ee,[C(e.$slots,"menubar",{},void 0,!0)]),g("div",Ae,[C(e.$slots,"activity-bar",{},void 0,!0)]),g("div",Ce,[C(e.$slots,"primary-sidebar",{},void 0,!0)]),g("div",Se,[C(e.$slots,"main-area",{},void 0,!0)])])}const Ne=D(xe,[["render",Ie],["__scopeId","data-v-15a7b307"]]),Fe={class:"tabs tabs-box"},Pe=["aria-label","value"],De=$({__name:"editorbar",props:{widgets:{}},emits:["change"],setup(e,{emit:t}){const a=t,r=I();function d(){a("change",r.value)}return(i,f)=>(m(),b("div",Fe,[(m(!0),b(F,null,M(i.widgets,n=>Q((m(),b("input",{key:n.id,"aria-label":n.label,"onUpdate:modelValue":f[0]||(f[0]=o=>r.value=o),value:n.id,onChange:d,class:"tab",type:"radio",name:"options"},null,40,Pe)),[[ve,r.value]])),128))]))}}),Be=D(De,[["__scopeId","data-v-e8354deb"]]),Me={class:"main-area",name:"main-area"},Te={class:"editors"},Le={class:"content"},Oe=["src"],je="/#/widget-iframe",Re=$({__name:"main-area",setup(e){const t=ie(),a=ce(),r=window.location.origin,d=I(new URL(je,r)),i=k(()=>d.value.href),f=I();me(async()=>{const u=await n();le(u)});async function n(){const u="/extensions.json";try{const v=await fetch(u);if(!v.ok)throw new Error(`Failed to fetch extension list: ${v.statusText}, url:${u}`);return await v.json()}catch(v){return console.error(v),[]}}async function o(u){a.unmountExtension?.();const v=t.widgets.find(h=>h.id===u);if(!v){console.error({msg:"could not activate widget",widgetId:u});return}t.activateWidget(v),await pe(),await s()}async function s(){f.value&&t.activeWidget&&(await l(f.value),ue(t.activeWidget,f.value.contentWindow))}function l(u){return!u.contentWindow||!u.contentDocument?Promise.reject(new Error("iframe is not ready")):u.contentDocument?.readyState==="complete"?Promise.resolve():new Promise((v,h)=>{const x=()=>(u.removeEventListener("load",x),v());if(!u.contentWindow)return h(new Error("iframe contentWindow not available"));u.addEventListener("load",x)})}return(u,v)=>(m(),b("main",Me,[g("div",Te,[A(Be,{widgets:w(t).widgets,onChange:o},null,8,["widgets"])]),g("div",Le,[w(t).activeWidget?.iframe?(m(),b("iframe",{key:0,ref_key:"iframeRef",ref:f,src:i.value},null,8,Oe)):T("",!0),w(t).activeWidget?.iframe?T("",!0):(m(),L(H,{key:1,widget:w(t).activeWidget,rootId:"main-area-widget-root"},null,8,["widget"]))])]))}}),qe=D(Re,[["__scopeId","data-v-b38cb5a8"]]),ze={class:"root"},Ve={class:"content"},Ue=$({__name:"sidebar-primary",setup(e){const t=J();return(a,r)=>(m(),b("aside",ze,[r[0]||(r[0]=Z(" sidebar widget ")),g("div",Ve,[A(H,{widget:w(t).activeWidget,rootId:"sidebar-primary-widget-root"},null,8,["widget"])])]))}});function oe(e){return ge()?(we(e),!0):!1}const se=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ye=Object.prototype.toString,Ge=e=>Ye.call(e)==="[object Object]",E=()=>{},V=Xe();function Xe(){var e,t;return se&&((e=window?.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((t=window?.navigator)==null?void 0:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(window?.navigator.userAgent))}function He(...e){if(e.length!==1)return be(...e);const t=e[0];return typeof t=="function"?he(_e(()=>({get:t,set:E}))):I(t)}function j(e){return Array.isArray(e)?e:[e]}function Je(e,t,a){return U(e,t,{...a,immediate:!0})}const ae=se?window:void 0;function N(e){var t;const a=y(e);return(t=a?.$el)!=null?t:a}function B(...e){const t=[],a=()=>{t.forEach(n=>n()),t.length=0},r=(n,o,s,l)=>(n.addEventListener(o,s,l),()=>n.removeEventListener(o,s,l)),d=k(()=>{const n=j(y(e[0])).filter(o=>o!=null);return n.every(o=>typeof o!="string")?n:void 0}),i=Je(()=>{var n,o;return[(o=(n=d.value)==null?void 0:n.map(s=>N(s)))!=null?o:[ae].filter(s=>s!=null),j(y(d.value?e[1]:e[0])),j(w(d.value?e[2]:e[1])),y(d.value?e[3]:e[2])]},([n,o,s,l])=>{if(a(),!n?.length||!o?.length||!s?.length)return;const u=Ge(l)?{...l}:l;t.push(...n.flatMap(v=>o.flatMap(h=>s.map(x=>r(v,h,x,u)))))},{flush:"post"}),f=()=>{i(),a()};return oe(a),f}let G=!1;function X(e,t,a={}){const{window:r=ae,ignore:d=[],capture:i=!0,detectIframe:f=!1,controls:n=!1}=a;if(!r)return n?{stop:E,cancel:E,trigger:E}:E;if(V&&!G){G=!0;const c={passive:!0};Array.from(r.document.body.children).forEach(p=>p.addEventListener("click",E,c)),r.document.documentElement.addEventListener("click",E,c)}let o=!0;const s=c=>y(d).some(p=>{if(typeof p=="string")return Array.from(r.document.querySelectorAll(p)).some(_=>_===c.target||c.composedPath().includes(_));{const _=N(p);return _&&(c.target===_||c.composedPath().includes(_))}});function l(c){const p=y(c);return p&&p.$.subTree.shapeFlag===16}function u(c,p){const _=y(c),O=_.$.subTree&&_.$.subTree.children;return O==null||!Array.isArray(O)?!1:O.some(Y=>Y.el===p.target||p.composedPath().includes(Y.el))}const v=c=>{const p=N(e);if(c.target!=null&&!(!(p instanceof Element)&&l(e)&&u(e,c))&&!(!p||p===c.target||c.composedPath().includes(p))){if("detail"in c&&c.detail===0&&(o=!s(c)),!o){o=!0;return}t(c)}};let h=!1;const x=[B(r,"click",c=>{h||(h=!0,setTimeout(()=>{h=!1},0),v(c))},{passive:!0,capture:i}),B(r,"pointerdown",c=>{const p=N(e);o=!s(c)&&!!(p&&!c.composedPath().includes(p))},{passive:!0}),f&&B(r,"blur",c=>{setTimeout(()=>{var p;const _=N(e);((p=r.document.activeElement)==null?void 0:p.tagName)==="IFRAME"&&!_?.contains(r.document.activeElement)&&t(c)},0)},{passive:!0})].filter(Boolean),W=()=>x.forEach(c=>c());return n?{stop:W,cancel:()=>{o=!1},trigger:c=>{o=!0,v(c),o=!1}}:W}const R=new WeakMap,Ke={mounted(e,t){const a=!t.modifiers.bubble;let r;if(typeof t.value=="function")r=X(e,t.value,{capture:a});else{const[d,i]=t.value;r=X(e,d,Object.assign({capture:a},i))}R.set(e,r)},unmounted(e){const t=R.get(e);t&&typeof t=="function"?t():t?.stop(),R.delete(e)}};function q(e){return typeof Window<"u"&&e instanceof Window?e.document.documentElement:typeof Document<"u"&&e instanceof Document?e.documentElement:e}function re(e){const t=window.getComputedStyle(e);if(t.overflowX==="scroll"||t.overflowY==="scroll"||t.overflowX==="auto"&&e.clientWidth<e.scrollWidth||t.overflowY==="auto"&&e.clientHeight<e.scrollHeight)return!0;{const a=e.parentNode;return!a||a.tagName==="BODY"?!1:re(a)}}function Qe(e){const t=e||window.event,a=t.target;return re(a)?!1:t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)}const z=new WeakMap;function Ze(e,t=!1){const a=ee(t);let r=null,d="";U(He(e),n=>{const o=q(y(n));if(o){const s=o;if(z.get(s)||z.set(s,s.style.overflow),s.style.overflow!=="hidden"&&(d=s.style.overflow),s.style.overflow==="hidden")return a.value=!0;if(a.value)return s.style.overflow="hidden"}},{immediate:!0});const i=()=>{const n=q(y(e));!n||a.value||(V&&(r=B(n,"touchmove",o=>{Qe(o)},{passive:!1})),n.style.overflow="hidden",a.value=!0)},f=()=>{const n=q(y(e));!n||!a.value||(V&&r?.(),n.style.overflow=d,z.delete(n),a.value=!1)};return oe(f),k({get(){return a.value},set(n){n?i():f()}})}function et(){let e=!1;const t=ee(!1);return(a,r)=>{if(t.value=r.value,e)return;e=!0;const d=Ze(a,r.value);U(t,i=>d.value=i)}}et();const tt=["open"],nt={"data-testid":"dropdown-menu",class:"menu dropdown-content bg-base-100 z-1 w-52 p-2 shadow-sm"},ot=$({__name:"dropdown",props:{color:{},variant:{},size:{},active:{type:Boolean},disabled:{type:Boolean},modifier:{},id:{}},emits:["open","close"],setup(e,{expose:t,emit:a}){const r=e,d=a,i=ye("details-ref"),f=I(!1),n=k(()=>({neutral:"btn-neutral",primary:"btn-primary",secondary:"btn-secondary",accent:"btn-accent",info:"btn-info",success:"btn-success",warning:"btn-warning",error:"btn-error",undefined:""})[r.color??"undefined"]),o=k(()=>({outline:"btn-outline",dash:"btn-dash",soft:"btn-soft",ghost:"btn-ghost",link:"btn-link",undefined:""})[r.variant??"undefined"]),s=k(()=>({xs:"btn-xs",sm:"btn-sm",md:"btn-md",lg:"btn-lg",xl:"btn-xl",undefined:""})[r.size??"undefined"]),l=k(()=>({wide:"btn-wide",block:"btn-block",square:"btn-square",circle:"btn-circle",undefined:""})[r.modifier??"undefined"]);function u(){i.value&&(i.value.open=f.value)}function v(){f.value=!1,d("close")}function h(){f.value=!0,d("open")}function x(){f.value?v():h()}return t({close:v,isOpen:f,id:r.id}),(W,c)=>(m(),b("details",{"data-testid":"dropdown-wrapper",ref:"details-ref",class:"dropdown",open:f.value,onToggle:u},[g("summary",{"data-testid":"dropdown-trigger",onClick:ke(x,["stop"]),class:te(["btn",[n.value,o.value,s.value,l.value,{"btn-active":W.active,"btn-disabled":W.disabled}]])},[C(W.$slots,"label")],2),Q((m(),b("ul",nt,[C(W.$slots,"items")])),[[w(Ke),v,void 0,{bubble:!0}]])],40,tt))}}),st={class:"flex items-center gap-2 px-2"},at={class:"badge badge-ghost badge-sm font-semibold"},rt=$({__name:"active-scl-file-info",setup(e){const t=K(),{currentActiveFileDatabaseName:a}=ne(t),r=k(()=>a.value?`Active file: ${a.value}`:"No active file");return(d,i)=>(m(),b("div",st,[i[0]||(i[0]=$e('<svg class="size-[1em]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g fill="currentColor" stroke-linejoin="miter" stroke-linecap="butt"><circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2"></circle><path d="m12,17v-5.5c0-.276-.224-.5-.5-.5h-1.5" fill="none" stroke="currentColor" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2"></path><circle cx="12" cy="7.25" r="1.25" fill="currentColor" stroke-width="2"></circle></g></svg>',1)),g("div",at,P(r.value),1)]))}}),it={class:"navbar bg-base-100 shadow-sm min-h-10 px-0.5 py-0"},ct=["onClick"],lt=["onClick"],ut=$({__name:"navbar",props:{items:{}},setup(e){const t=I([]),a=e,r=k(()=>{const n=[];for(const o of a.items){const s=o.path.length>0,l=!s,u=s;if(l){if(n.find(h=>h.label===o.label))continue;n.push({id:o.id,label:o.label,children:[],action:i})}u&&d(n,o).children.push({id:o.id,label:o.label,children:[],action:o.action})}return n});function d(n,o){let s={id:"N/A",label:"N/A",action:i,children:n};for(const l of o.path){const u=s.children.find(h=>h.label===l);if(u){s=u;continue}const v={id:l,label:l,children:[],action:i};s.children.push(v),s=v}return s}function i(n){for(const o of t.value)o.id!==n&&o.close()}function f(n,o){return function(){o.action(o.id);const s=t.value.find(l=>l.id===n);if(!s){console.warn({msg:"could not find dropdown to close",itemId:n});return}s.close()}}return(n,o)=>(m(),b("nav",it,[g("div",null,[(m(!0),b(F,null,M(r.value,s=>(m(),b(F,null,[s.children.length>0?(m(),L(w(ot),{key:s.id,id:s.id,ref_for:!0,ref_key:"dropdowns",ref:t,color:"secondary",variant:"ghost",size:"sm",modifier:"wide",onOpen:()=>i(s.id)},{label:S(()=>[Z(P(s.label),1)]),items:S(()=>[(m(!0),b(F,null,M(s.children,l=>(m(),b("li",{key:l.id},[g("button",{onClick:()=>f(s.id,l)()},P(l.label),9,ct)]))),128))]),_:2},1032,["id","onOpen"])):T("",!0),s.children.length===0?(m(),b("button",{key:s.id,onClick:()=>s.action(s.id)},P(s.label),9,lt)):T("",!0)],64))),256))]),A(rt)]))}}),dt=D(ut,[["__scopeId","data-v-cd567ad5"]]),ft=$({__name:"menu",setup(e){const t=K(),a=de(),r=[{id:"file.open",label:"Open",path:["File"],action:t.openFiles},{id:"file.save",label:"Save",path:["File"],action:t.saveFile}],d=fe(async()=>{const{contributions:n}=ne(a),o=[];for(const s of n.value)try{const l=await i(s),u={id:s.id,label:s.label,path:s.menuPath,action:l};o.push(u)}catch(l){console.error("Error fetching action for menu contribution",{cont:s,err:l});continue}return[...r,...o]},r);async function i(n){const o=n.actionFnUrl;return o?(await import(o)).default:f}function f(){}return(n,o)=>(m(),L(dt,{items:w(d),activeFileName:w(t).currentActiveFileDatabaseName},null,8,["items","activeFileName"]))}}),vt={class:"activity-bar"},mt=["title","onClick"],pt=$({__name:"activity-bar",setup(e){const t=J();function a(i){return i.label.charAt(0).toUpperCase()}function r(i){return t.activeWidget?.id===i.id}function d(i){t.activeWidget?.id!==i.id&&t.activateWidget(i)}return(i,f)=>(m(),b("aside",vt,[(m(!0),b(F,null,M(w(t).widgets,n=>(m(),b("button",{key:n.id,class:te(["btn btn-ghost",{"btn-active":r(n)}]),title:n.label,onClick:o=>d(n)},P(a(n)),11,mt))),128))]))}}),bt=D(pt,[["__scopeId","data-v-db7f343a"]]),gt=$({__name:"app-view",setup(e){return(t,a)=>(m(),L(Ne,null,{menubar:S(()=>[A(ft)]),"activity-bar":S(()=>[A(bt)]),"primary-sidebar":S(()=>[A(Ue)]),"main-area":S(()=>[A(qe)]),_:1}))}});export{gt as default};
