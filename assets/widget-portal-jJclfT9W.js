import{aC as Ta,as as xa,a0 as Tr,a7 as Ea,af as lo,bC as Ot,a1 as fo,aF as po,aR as Cn,bd as ho,aS as ze,J as mo,b5 as Xe,q as Qe,bf as je,bD as xr,bi as yo,ak as vo,bP as An,M as go,bs as bo,u as wo,v as _o,aK as So,aQ as To}from"./index-jMsYZsNz.js";function Er(s){return fo()?(po(s),!0):!1}function sa(){const s=new Set,l=I=>{s.delete(I)};return{on:I=>{s.add(I);const R=()=>l(I);return Er(R),{off:R}},off:l,trigger:(...I)=>Promise.all(Array.from(s).map(R=>R(...I))),clear:()=>{s.clear()}}}const fr=new WeakMap,xo=(...s)=>{var l;const h=s[0],f=(l=Tr())==null?void 0:l.proxy;if(f==null&&!Ea())throw new Error("injectLocal must be called in setup");return f&&fr.has(f)&&h in fr.get(f)?fr.get(f)[h]:lo(...s)},Pa=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Eo=Object.prototype.toString,Po=s=>Eo.call(s)==="[object Object]",Da=()=>{},Do=(s,l)=>Object.prototype.hasOwnProperty.call(s,l);function Co(...s){if(s.length!==1)return ho(...s);const l=s[0];return typeof l=="function"?Cn(mo(()=>({get:l,set:Da}))):ze(l)}function Ao(s,l){function h(...f){return new Promise((D,I)=>{Promise.resolve(s(()=>l.apply(this,f),{fn:l,thisArg:this,args:f})).then(D).catch(I)})}return h}const Ca=s=>s();function Oo(s=Ca,l={}){const{initialState:h="active"}=l,f=Co(h==="active");function D(){f.value=!1}function I(){f.value=!0}const R=(...O)=>{f.value&&s(...O)};return{isActive:Cn(f),pause:D,resume:I,eventFilter:R}}function No(s,l){var h;if(typeof s=="number")return s+l;const f=((h=s.match(/^-?\d+\.?\d*/))==null?void 0:h[0])||"",D=s.slice(f.length),I=Number.parseFloat(f)+l;return Number.isNaN(I)?s:I+D}function Xt(s){return s.endsWith("rem")?Number.parseFloat(s)*16:Number.parseFloat(s)}function dr(s){return Array.isArray(s)?s:[s]}function Io(s){return Tr()}function Fo(s,l,h={}){const{eventFilter:f=Ca,...D}=h;return Ot(s,Ao(f,l),D)}function ko(s,l,h={}){const{eventFilter:f,initialState:D="active",...I}=h,{eventFilter:R,pause:O,resume:K,isActive:z}=Oo(f,{initialState:D});return{stop:Fo(s,l,{...I,eventFilter:R}),pause:O,resume:K,isActive:z}}function Aa(s,l=!0,h){Io()?Ta(s,h):l?s():xa(s)}function Ro(s,l,h){return Ot(s,l,{...h,immediate:!0})}function as(s,l,h){let f;vo(h)?f={evaluating:h}:f={};const{lazy:D=!1,flush:I="pre",evaluating:R=void 0,shallow:O=!0,onError:K=Da}=f,z=Xe(!D),Q=O?Xe(l):ze(l);let Y=0;return xr(async ne=>{if(!z.value)return;Y++;const W=Y;let k=!1;R&&Promise.resolve().then(()=>{R.value=!0});try{const F=await s(X=>{ne(()=>{R&&(R.value=!1),k||X()})});W===Y&&(Q.value=F)}catch(F){K(F)}finally{R&&W===Y&&(R.value=!1),k=!0}},{flush:I}),D?Qe(()=>(z.value=!0,Q.value)):Q}const Qt=Pa?window:void 0,Lo=Pa?window.document:void 0;function Oa(s){var l;const h=je(s);return(l=h?.$el)!=null?l:h}function gr(...s){const l=[],h=()=>{l.forEach(O=>O()),l.length=0},f=(O,K,z,Q)=>(O.addEventListener(K,z,Q),()=>O.removeEventListener(K,z,Q)),D=Qe(()=>{const O=dr(je(s[0])).filter(K=>K!=null);return O.every(K=>typeof K!="string")?O:void 0}),I=Ro(()=>{var O,K;return[(K=(O=D.value)==null?void 0:O.map(z=>Oa(z)))!=null?K:[Qt].filter(z=>z!=null),dr(je(D.value?s[1]:s[0])),dr(yo(D.value?s[2]:s[1])),je(D.value?s[3]:s[2])]},([O,K,z,Q])=>{if(h(),!O?.length||!K?.length||!z?.length)return;const Y=Po(Q)?{...Q}:Q;l.push(...O.flatMap(ne=>K.flatMap(W=>z.map(k=>f(ne,W,k,Y)))))},{flush:"post"}),R=()=>{I(),h()};return Er(h),R}function Bo(){const s=Xe(!1),l=Tr();return l&&Ta(()=>{s.value=!0},l),s}function Mo(s){const l=Bo();return Qe(()=>(l.value,!!s()))}const Ko=Symbol("vueuse-ssr-width");function Na(){const s=Ea()?xo(Ko,null):null;return typeof s=="number"?s:void 0}function Ht(s,l={}){const{window:h=Qt,ssrWidth:f=Na()}=l,D=Mo(()=>h&&"matchMedia"in h&&typeof h.matchMedia=="function"),I=Xe(typeof f=="number"),R=Xe(),O=Xe(!1),K=z=>{O.value=z.matches};return xr(()=>{if(I.value){I.value=!D.value;const z=je(s).split(",");O.value=z.some(Q=>{const Y=Q.includes("not all"),ne=Q.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),W=Q.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let k=!!(ne||W);return ne&&k&&(k=f>=Xt(ne[1])),W&&k&&(k=f<=Xt(W[1])),Y?!k:k});return}D.value&&(R.value=h.matchMedia(je(s)),O.value=R.value.matches)}),gr(R,"change",K,{passive:!0}),Qe(()=>O.value)}const os={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};function is(s,l={}){function h(W,k){let F=je(s[je(W)]);return k!=null&&(F=No(F,k)),typeof F=="number"&&(F=`${F}px`),F}const{window:f=Qt,strategy:D="min-width",ssrWidth:I=Na()}=l,R=typeof I=="number",O=R?Xe(!1):{value:!0};R&&Aa(()=>O.value=!!f);function K(W,k){return!O.value&&R?W==="min"?I>=Xt(k):I<=Xt(k):f?f.matchMedia(`(${W}-width: ${k})`).matches:!1}const z=W=>Ht(()=>`(min-width: ${h(W)})`,l),Q=W=>Ht(()=>`(max-width: ${h(W)})`,l),Y=Object.keys(s).reduce((W,k)=>(Object.defineProperty(W,k,{get:()=>D==="min-width"?z(k):Q(k),enumerable:!0,configurable:!0}),W),{});function ne(){const W=Object.keys(s).map(k=>[k,Y[k],Xt(h(k))]).sort((k,F)=>k[2]-F[2]);return Qe(()=>W.filter(([,k])=>k.value).map(([k])=>k))}return Object.assign(Y,{greaterOrEqual:z,smallerOrEqual:Q,greater(W){return Ht(()=>`(min-width: ${h(W,.1)})`,l)},smaller(W){return Ht(()=>`(max-width: ${h(W,-.1)})`,l)},between(W,k){return Ht(()=>`(min-width: ${h(W)}) and (max-width: ${h(k,-.1)})`,l)},isGreater(W){return K("min",h(W,.1))},isGreaterOrEqual(W){return K("min",h(W))},isSmaller(W){return K("max",h(W,-.1))},isSmallerOrEqual(W){return K("max",h(W))},isInBetween(W,k){return K("min",h(W))&&K("max",h(k,-.1))},current:ne,active(){const W=ne();return Qe(()=>W.value.length===0?"":W.value.at(D==="min-width"?-1:0))}})}const En=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Pn="__vueuse_ssr_handlers__",qo=jo();function jo(){return Pn in En||(En[Pn]=En[Pn]||{}),En[Pn]}function Vo(s,l){return qo[s]||l}function Uo(s){return s==null?"any":s instanceof Set?"set":s instanceof Map?"map":s instanceof Date?"date":typeof s=="boolean"?"boolean":typeof s=="string"?"string":typeof s=="object"?"object":Number.isNaN(s)?"any":"number"}const Go={boolean:{read:s=>s==="true",write:s=>String(s)},object:{read:s=>JSON.parse(s),write:s=>JSON.stringify(s)},number:{read:s=>Number.parseFloat(s),write:s=>String(s)},any:{read:s=>s,write:s=>String(s)},string:{read:s=>s,write:s=>String(s)},map:{read:s=>new Map(JSON.parse(s)),write:s=>JSON.stringify(Array.from(s.entries()))},set:{read:s=>new Set(JSON.parse(s)),write:s=>JSON.stringify(Array.from(s))},date:{read:s=>new Date(s),write:s=>s.toISOString()}},ua="vueuse-storage";function ca(s,l,h,f={}){var D;const{flush:I="pre",deep:R=!0,listenToStorageChanges:O=!0,writeDefaults:K=!0,mergeDefaults:z=!1,shallow:Q,window:Y=Qt,eventFilter:ne,onError:W=se=>{console.error(se)},initOnMounted:k}=f,F=(Q?Xe:ze)(typeof l=="function"?l():l),X=Qe(()=>je(s));if(!h)try{h=Vo("getDefaultStorage",()=>{var se;return(se=Qt)==null?void 0:se.localStorage})()}catch(se){W(se)}if(!h)return F;const ae=je(l),be=Uo(ae),J=(D=f.serializer)!=null?D:Go[be],{pause:$,resume:ie}=ko(F,()=>ut(F.value),{flush:I,deep:R,eventFilter:ne});Ot(X,()=>de(),{flush:I});let fe=!1;const oe=se=>{k&&!fe||de(se)},Ce=se=>{k&&!fe||Fe(se)};Y&&O&&(h instanceof Storage?gr(Y,"storage",oe,{passive:!0}):gr(Y,ua,Ce)),k?Aa(()=>{fe=!0,de()}):de();function P(se,me){if(Y){const Ee={key:X.value,oldValue:se,newValue:me,storageArea:h};Y.dispatchEvent(h instanceof Storage?new StorageEvent("storage",Ee):new CustomEvent(ua,{detail:Ee}))}}function ut(se){try{const me=h.getItem(X.value);if(se==null)P(me,null),h.removeItem(X.value);else{const Ee=J.write(se);me!==Ee&&(h.setItem(X.value,Ee),P(me,Ee))}}catch(me){W(me)}}function Ve(se){const me=se?se.newValue:h.getItem(X.value);if(me==null)return K&&ae!=null&&h.setItem(X.value,J.write(ae)),ae;if(!se&&z){const Ee=J.read(me);return typeof z=="function"?z(Ee,ae):be==="object"&&!Array.isArray(Ee)?{...ae,...Ee}:Ee}else return typeof me!="string"?me:J.read(me)}function de(se){if(!(se&&se.storageArea!==h)){if(se&&se.key==null){F.value=ae;return}if(!(se&&se.key!==X.value)){$();try{se?.newValue!==J.write(F.value)&&(F.value=Ve(se))}catch(me){W(me)}finally{se?xa(ie):ie()}}}}function Fe(se){de(se.detail)}return F}const Wo={multiple:!0,accept:"*",reset:!1,directory:!1};function Yo(s){if(!s)return null;if(s instanceof FileList)return s;const l=new DataTransfer;for(const h of s)l.items.add(h);return l.files}function la(s={}){const{document:l=Lo}=s,h=ze(Yo(s.initialFiles)),{on:f,trigger:D}=sa(),{on:I,trigger:R}=sa();let O;l&&(O=Oa(s.input)||l.createElement("input"),O.type="file",O.onchange=Q=>{const Y=Q.target;h.value=Y.files,D(h.value)},O.oncancel=()=>{R()});const K=()=>{h.value=null,O&&O.value&&(O.value="",D(null))},z=Q=>{if(!O)return;const Y={...Wo,...s,...Q};O.multiple=Y.multiple,O.accept=Y.accept,O.webkitdirectory=Y.directory,Do(Y,"capture")&&(O.capture=Y.capture),Y.reset&&K(),O.click()};return{files:Cn(h),open:z,reset:K,onCancel:I,onChange:f}}function $o(s){const l=Xe(),h=()=>{l.value&&URL.revokeObjectURL(l.value),l.value=void 0};return Ot(()=>je(s),f=>{h(),f&&(l.value=URL.createObjectURL(f))},{immediate:!0}),Er(h),Cn(l)}const Ho=(s,l)=>{const h=s.__vccOpts||s;for(const[f,D]of l)h[f]=D;return h},Pr=An("extension",()=>{const s=ze(null),l=ze([]);return{extensions:l,setExtensions:D,activeExtensionId:s,setActiveExtension:h,clearActiveExtension:f};function h(I){s.value=I}function f(){s.value=null}function D(I){l.value=I}}),Xo=Ia("mainArea"),zo=Ia("primarySidebar"),ss=An("menuContributionStore",()=>{const s=Pr();return{contributions:Qe(()=>s.extensions.map(h=>h.contributions.filter(f=>f.type==="menu").map(f=>f)).flat())}});function Ia(s){return An(`${s}Store`,()=>{const l=Pr(),h=ze(),f=ze();return{widgets:Qe(()=>l.extensions.map(R=>R.contributions.filter(O=>O.type==="widget"&&O.location===s).map(O=>O)).flat()),get activeWidget(){return h},activateWidget:I,unmountExtension:f};function I(R){h.value=R}})}function br(s,l){const h=new URL(l),f=s.replace("/",""),D=h.pathname.split("/").filter(Boolean);return D.push(f),D.unshift(h.origin),D.join("/")}async function us(s){const l=Pr(),h=await Qo(s);l.setExtensions(h)}async function Qo(s){const l=[];for(const h of s){let f,D="",I;try{if(I=Dr(window.location.href,h),f=await Zo(I),D=await ei(I),!f)throw new Error(`could not fetch extension definition from ${h}`)}catch(O){console.error("Error fetching extension definition from",h,O);continue}const R={id:f.name,version:f.version,label:f.displayName,changelog:D,contributions:[...f.contributes.customEditors?.map(O=>fa(O,I,"mainArea"))??[],...f.contributes.primarySidebars?.map(O=>fa(O,I,"primarySidebar"))??[],...f.contributes.menu?.map(O=>Jo(O,I))??[]]};l.push(R)}return l}function fa(s,l,h){const f=ni(s);return{id:s.id,type:"widget",label:s.displayName,icon:s.icon?br(s.icon,l):s.icon,location:h,startFnUrl:br(s.entryPoint,l),iframe:f,defaultActive:s.defaultActive}}function Jo(s,l){return{id:s.id,type:"menu",label:s.displayName,icon:s.icon,menuPath:s.path??[],actionFnUrl:br(s.entryPoint,l)}}async function Zo(s){try{const l=Dr(window.location.href,s),h=new URL("package.json",l).toString(),f=await fetch(h);if(!f.ok)throw new Error(`Failed to fetch package.json from ${h}`);return await f.json()}catch(l){throw console.error("Error fetching package.json:",l),l}}async function ei(s){try{const l=Dr(window.location.href,s),h=new URL("CHANGELOG.md",l).toString(),f=await fetch(h);if(!f.ok)throw new Error(`Failed to fetch CHANGELOG.md from ${h}`);return await f.text()}catch(l){throw console.error("Error fetching CHANGELOG.md:",l),l}}function Dr(s,l){if(ti(l)){const h=new URL(s);return new URL(l,h.origin).toString()}else return l}function ti(s){return s.startsWith("/")}function ni(s){let l=!1;return s.iframe!==void 0&&(l=s.iframe??!1),l}async function ri(s){const l=await import(s);if(!l.default)throw new Error(`Default export not found in the loaded module from ${s}`);return l.default}var ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fa(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function oi(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var l=s.default;if(typeof l=="function"){var h=function f(){var D=!1;try{D=this instanceof f}catch{}return D?Reflect.construct(l,arguments,this.constructor):l.apply(this,arguments)};h.prototype=l.prototype}else h={};return Object.defineProperty(h,"__esModule",{value:!0}),Object.keys(s).forEach(function(f){var D=Object.getOwnPropertyDescriptor(s,f);Object.defineProperty(h,f,D.get?D:{enumerable:!0,get:function(){return s[f]}})}),h}var da={};const ii={},si=Object.freeze(Object.defineProperty({__proto__:null,default:ii},Symbol.toStringTag,{value:"Module"})),pa=oi(si);var ha;function ui(){return ha||(ha=1,function(s){(function(l){l.parser=function(u,i){return new f(u,i)},l.SAXParser=f,l.SAXStream=Q,l.createStream=z,l.MAX_BUFFER_LENGTH=64*1024;var h=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];l.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function f(u,i){if(!(this instanceof f))return new f(u,i);var E=this;I(E),E.q=E.c="",E.bufferCheckPosition=l.MAX_BUFFER_LENGTH,E.opt=i||{},E.opt.lowercase=E.opt.lowercase||E.opt.lowercasetags,E.looseCase=E.opt.lowercase?"toLowerCase":"toUpperCase",E.tags=[],E.closed=E.closedRoot=E.sawRoot=!1,E.tag=E.error=null,E.strict=!!u,E.noscript=!!(u||E.opt.noscript),E.state=P.BEGIN,E.strictEntities=E.opt.strictEntities,E.ENTITIES=E.strictEntities?Object.create(l.XML_ENTITIES):Object.create(l.ENTITIES),E.attribList=[],E.opt.xmlns&&(E.ns=Object.create(F)),E.opt.unquotedAttributeValues===void 0&&(E.opt.unquotedAttributeValues=!u),E.trackPosition=E.opt.position!==!1,E.trackPosition&&(E.position=E.line=E.column=0),Ve(E,"onready")}Object.create||(Object.create=function(u){function i(){}i.prototype=u;var E=new i;return E}),Object.keys||(Object.keys=function(u){var i=[];for(var E in u)u.hasOwnProperty(E)&&i.push(E);return i});function D(u){for(var i=Math.max(l.MAX_BUFFER_LENGTH,10),E=0,T=0,ce=h.length;T<ce;T++){var Z=u[h[T]].length;if(Z>i)switch(h[T]){case"textNode":Fe(u);break;case"cdata":de(u,"oncdata",u.cdata),u.cdata="";break;case"script":de(u,"onscript",u.script),u.script="";break;default:me(u,"Max buffer length exceeded: "+h[T])}E=Math.max(E,Z)}var ye=l.MAX_BUFFER_LENGTH-E;u.bufferCheckPosition=ye+u.position}function I(u){for(var i=0,E=h.length;i<E;i++)u[h[i]]=""}function R(u){Fe(u),u.cdata!==""&&(de(u,"oncdata",u.cdata),u.cdata=""),u.script!==""&&(de(u,"onscript",u.script),u.script="")}f.prototype={end:function(){Ee(this)},write:Ze,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){R(this)}};var O;try{O=pa.Stream}catch{O=function(){}}O||(O=function(){});var K=l.EVENTS.filter(function(u){return u!=="error"&&u!=="end"});function z(u,i){return new Q(u,i)}function Q(u,i){if(!(this instanceof Q))return new Q(u,i);O.apply(this),this._parser=new f(u,i),this.writable=!0,this.readable=!0;var E=this;this._parser.onend=function(){E.emit("end")},this._parser.onerror=function(T){E.emit("error",T),E._parser.error=null},this._decoder=null,K.forEach(function(T){Object.defineProperty(E,"on"+T,{get:function(){return E._parser["on"+T]},set:function(ce){if(!ce)return E.removeAllListeners(T),E._parser["on"+T]=ce,ce;E.on(T,ce)},enumerable:!0,configurable:!1})})}Q.prototype=Object.create(O.prototype,{constructor:{value:Q}}),Q.prototype.write=function(u){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(u)){if(!this._decoder){var i=pa.StringDecoder;this._decoder=new i("utf8")}u=this._decoder.write(u)}return this._parser.write(u.toString()),this.emit("data",u),!0},Q.prototype.end=function(u){return u&&u.length&&this.write(u),this._parser.end(),!0},Q.prototype.on=function(u,i){var E=this;return!E._parser["on"+u]&&K.indexOf(u)!==-1&&(E._parser["on"+u]=function(){var T=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);T.splice(0,0,u),E.emit.apply(E,T)}),O.prototype.on.call(E,u,i)};var Y="[CDATA[",ne="DOCTYPE",W="http://www.w3.org/XML/1998/namespace",k="http://www.w3.org/2000/xmlns/",F={xml:W,xmlns:k},X=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,ae=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,be=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,J=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function $(u){return u===" "||u===`
`||u==="\r"||u==="	"}function ie(u){return u==='"'||u==="'"}function fe(u){return u===">"||$(u)}function oe(u,i){return u.test(i)}function Ce(u,i){return!oe(u,i)}var P=0;l.STATE={BEGIN:P++,BEGIN_WHITESPACE:P++,TEXT:P++,TEXT_ENTITY:P++,OPEN_WAKA:P++,SGML_DECL:P++,SGML_DECL_QUOTED:P++,DOCTYPE:P++,DOCTYPE_QUOTED:P++,DOCTYPE_DTD:P++,DOCTYPE_DTD_QUOTED:P++,COMMENT_STARTING:P++,COMMENT:P++,COMMENT_ENDING:P++,COMMENT_ENDED:P++,CDATA:P++,CDATA_ENDING:P++,CDATA_ENDING_2:P++,PROC_INST:P++,PROC_INST_BODY:P++,PROC_INST_ENDING:P++,OPEN_TAG:P++,OPEN_TAG_SLASH:P++,ATTRIB:P++,ATTRIB_NAME:P++,ATTRIB_NAME_SAW_WHITE:P++,ATTRIB_VALUE:P++,ATTRIB_VALUE_QUOTED:P++,ATTRIB_VALUE_CLOSED:P++,ATTRIB_VALUE_UNQUOTED:P++,ATTRIB_VALUE_ENTITY_Q:P++,ATTRIB_VALUE_ENTITY_U:P++,CLOSE_TAG:P++,CLOSE_TAG_SAW_WHITE:P++,SCRIPT:P++,SCRIPT_ENDING:P++},l.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},l.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(l.ENTITIES).forEach(function(u){var i=l.ENTITIES[u],E=typeof i=="number"?String.fromCharCode(i):i;l.ENTITIES[u]=E});for(var ut in l.STATE)l.STATE[l.STATE[ut]]=ut;P=l.STATE;function Ve(u,i,E){u[i]&&u[i](E)}function de(u,i,E){u.textNode&&Fe(u),Ve(u,i,E)}function Fe(u){u.textNode=se(u.opt,u.textNode),u.textNode&&Ve(u,"ontext",u.textNode),u.textNode=""}function se(u,i){return u.trim&&(i=i.trim()),u.normalize&&(i=i.replace(/\s+/g," ")),i}function me(u,i){return Fe(u),u.trackPosition&&(i+=`
Line: `+u.line+`
Column: `+u.column+`
Char: `+u.c),i=new Error(i),u.error=i,Ve(u,"onerror",i),u}function Ee(u){return u.sawRoot&&!u.closedRoot&&he(u,"Unclosed root tag"),u.state!==P.BEGIN&&u.state!==P.BEGIN_WHITESPACE&&u.state!==P.TEXT&&me(u,"Unexpected end"),Fe(u),u.c="",u.closed=!0,Ve(u,"onend"),f.call(u,u.strict,u.opt),u}function he(u,i){if(typeof u!="object"||!(u instanceof f))throw new Error("bad call to strictFail");u.strict&&me(u,i)}function Ye(u){u.strict||(u.tagName=u.tagName[u.looseCase]());var i=u.tags[u.tags.length-1]||u,E=u.tag={name:u.tagName,attributes:{}};u.opt.xmlns&&(E.ns=i.ns),u.attribList.length=0,de(u,"onopentagstart",E)}function Ue(u,i){var E=u.indexOf(":"),T=E<0?["",u]:u.split(":"),ce=T[0],Z=T[1];return i&&u==="xmlns"&&(ce="xmlns",Z=""),{prefix:ce,local:Z}}function Le(u){if(u.strict||(u.attribName=u.attribName[u.looseCase]()),u.attribList.indexOf(u.attribName)!==-1||u.tag.attributes.hasOwnProperty(u.attribName)){u.attribName=u.attribValue="";return}if(u.opt.xmlns){var i=Ue(u.attribName,!0),E=i.prefix,T=i.local;if(E==="xmlns")if(T==="xml"&&u.attribValue!==W)he(u,"xml: prefix must be bound to "+W+`
Actual: `+u.attribValue);else if(T==="xmlns"&&u.attribValue!==k)he(u,"xmlns: prefix must be bound to "+k+`
Actual: `+u.attribValue);else{var ce=u.tag,Z=u.tags[u.tags.length-1]||u;ce.ns===Z.ns&&(ce.ns=Object.create(Z.ns)),ce.ns[T]=u.attribValue}u.attribList.push([u.attribName,u.attribValue])}else u.tag.attributes[u.attribName]=u.attribValue,de(u,"onattribute",{name:u.attribName,value:u.attribValue});u.attribName=u.attribValue=""}function Ke(u,i){if(u.opt.xmlns){var E=u.tag,T=Ue(u.tagName);E.prefix=T.prefix,E.local=T.local,E.uri=E.ns[T.prefix]||"",E.prefix&&!E.uri&&(he(u,"Unbound namespace prefix: "+JSON.stringify(u.tagName)),E.uri=T.prefix);var ce=u.tags[u.tags.length-1]||u;E.ns&&ce.ns!==E.ns&&Object.keys(E.ns).forEach(function(Ft){de(u,"onopennamespace",{prefix:Ft,uri:E.ns[Ft]})});for(var Z=0,ye=u.attribList.length;Z<ye;Z++){var Ae=u.attribList[Z],we=Ae[0],et=Ae[1],xe=Ue(we,!0),qe=xe.prefix,On=xe.local,_t=qe===""?"":E.ns[qe]||"",Re={name:we,value:et,prefix:qe,local:On,uri:_t};qe&&qe!=="xmlns"&&!_t&&(he(u,"Unbound namespace prefix: "+JSON.stringify(qe)),Re.uri=qe),u.tag.attributes[we]=Re,de(u,"onattribute",Re)}u.attribList.length=0}u.tag.isSelfClosing=!!i,u.sawRoot=!0,u.tags.push(u.tag),de(u,"onopentag",u.tag),i||(!u.noscript&&u.tagName.toLowerCase()==="script"?u.state=P.SCRIPT:u.state=P.TEXT,u.tag=null,u.tagName=""),u.attribName=u.attribValue="",u.attribList.length=0}function Nt(u){if(!u.tagName){he(u,"Weird empty close tag."),u.textNode+="</>",u.state=P.TEXT;return}if(u.script){if(u.tagName!=="script"){u.script+="</"+u.tagName+">",u.tagName="",u.state=P.SCRIPT;return}de(u,"onscript",u.script),u.script=""}var i=u.tags.length,E=u.tagName;u.strict||(E=E[u.looseCase]());for(var T=E;i--;){var ce=u.tags[i];if(ce.name!==T)he(u,"Unexpected close tag");else break}if(i<0){he(u,"Unmatched closing tag: "+u.tagName),u.textNode+="</"+u.tagName+">",u.state=P.TEXT;return}u.tagName=E;for(var Z=u.tags.length;Z-- >i;){var ye=u.tag=u.tags.pop();u.tagName=u.tag.name,de(u,"onclosetag",u.tagName);var Ae={};for(var we in ye.ns)Ae[we]=ye.ns[we];var et=u.tags[u.tags.length-1]||u;u.opt.xmlns&&ye.ns!==et.ns&&Object.keys(ye.ns).forEach(function(xe){var qe=ye.ns[xe];de(u,"onclosenamespace",{prefix:xe,uri:qe})})}i===0&&(u.closedRoot=!0),u.tagName=u.attribValue=u.attribName="",u.attribList.length=0,u.state=P.TEXT}function Je(u){var i=u.entity,E=i.toLowerCase(),T,ce="";return u.ENTITIES[i]?u.ENTITIES[i]:u.ENTITIES[E]?u.ENTITIES[E]:(i=E,i.charAt(0)==="#"&&(i.charAt(1)==="x"?(i=i.slice(2),T=parseInt(i,16),ce=T.toString(16)):(i=i.slice(1),T=parseInt(i,10),ce=T.toString(10))),i=i.replace(/^0+/,""),isNaN(T)||ce.toLowerCase()!==i?(he(u,"Invalid character entity"),"&"+u.entity+";"):String.fromCodePoint(T))}function It(u,i){i==="<"?(u.state=P.OPEN_WAKA,u.startTagPosition=u.position):$(i)||(he(u,"Non-whitespace before first tag."),u.textNode=i,u.state=P.TEXT)}function ct(u,i){var E="";return i<u.length&&(E=u.charAt(i)),E}function Ze(u){var i=this;if(this.error)throw this.error;if(i.closed)return me(i,"Cannot write after close. Assign an onready handler.");if(u===null)return Ee(i);typeof u=="object"&&(u=u.toString());for(var E=0,T="";T=ct(u,E++),i.c=T,!!T;)switch(i.trackPosition&&(i.position++,T===`
`?(i.line++,i.column=0):i.column++),i.state){case P.BEGIN:if(i.state=P.BEGIN_WHITESPACE,T==="\uFEFF")continue;It(i,T);continue;case P.BEGIN_WHITESPACE:It(i,T);continue;case P.TEXT:if(i.sawRoot&&!i.closedRoot){for(var ce=E-1;T&&T!=="<"&&T!=="&";)T=ct(u,E++),T&&i.trackPosition&&(i.position++,T===`
`?(i.line++,i.column=0):i.column++);i.textNode+=u.substring(ce,E-1)}T==="<"&&!(i.sawRoot&&i.closedRoot&&!i.strict)?(i.state=P.OPEN_WAKA,i.startTagPosition=i.position):(!$(T)&&(!i.sawRoot||i.closedRoot)&&he(i,"Text data outside of root node."),T==="&"?i.state=P.TEXT_ENTITY:i.textNode+=T);continue;case P.SCRIPT:T==="<"?i.state=P.SCRIPT_ENDING:i.script+=T;continue;case P.SCRIPT_ENDING:T==="/"?i.state=P.CLOSE_TAG:(i.script+="<"+T,i.state=P.SCRIPT);continue;case P.OPEN_WAKA:if(T==="!")i.state=P.SGML_DECL,i.sgmlDecl="";else if(!$(T))if(oe(X,T))i.state=P.OPEN_TAG,i.tagName=T;else if(T==="/")i.state=P.CLOSE_TAG,i.tagName="";else if(T==="?")i.state=P.PROC_INST,i.procInstName=i.procInstBody="";else{if(he(i,"Unencoded <"),i.startTagPosition+1<i.position){var Z=i.position-i.startTagPosition;T=new Array(Z).join(" ")+T}i.textNode+="<"+T,i.state=P.TEXT}continue;case P.SGML_DECL:if(i.sgmlDecl+T==="--"){i.state=P.COMMENT,i.comment="",i.sgmlDecl="";continue}i.doctype&&i.doctype!==!0&&i.sgmlDecl?(i.state=P.DOCTYPE_DTD,i.doctype+="<!"+i.sgmlDecl+T,i.sgmlDecl=""):(i.sgmlDecl+T).toUpperCase()===Y?(de(i,"onopencdata"),i.state=P.CDATA,i.sgmlDecl="",i.cdata=""):(i.sgmlDecl+T).toUpperCase()===ne?(i.state=P.DOCTYPE,(i.doctype||i.sawRoot)&&he(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):T===">"?(de(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=P.TEXT):(ie(T)&&(i.state=P.SGML_DECL_QUOTED),i.sgmlDecl+=T);continue;case P.SGML_DECL_QUOTED:T===i.q&&(i.state=P.SGML_DECL,i.q=""),i.sgmlDecl+=T;continue;case P.DOCTYPE:T===">"?(i.state=P.TEXT,de(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=T,T==="["?i.state=P.DOCTYPE_DTD:ie(T)&&(i.state=P.DOCTYPE_QUOTED,i.q=T));continue;case P.DOCTYPE_QUOTED:i.doctype+=T,T===i.q&&(i.q="",i.state=P.DOCTYPE);continue;case P.DOCTYPE_DTD:T==="]"?(i.doctype+=T,i.state=P.DOCTYPE):T==="<"?(i.state=P.OPEN_WAKA,i.startTagPosition=i.position):ie(T)?(i.doctype+=T,i.state=P.DOCTYPE_DTD_QUOTED,i.q=T):i.doctype+=T;continue;case P.DOCTYPE_DTD_QUOTED:i.doctype+=T,T===i.q&&(i.state=P.DOCTYPE_DTD,i.q="");continue;case P.COMMENT:T==="-"?i.state=P.COMMENT_ENDING:i.comment+=T;continue;case P.COMMENT_ENDING:T==="-"?(i.state=P.COMMENT_ENDED,i.comment=se(i.opt,i.comment),i.comment&&de(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+T,i.state=P.COMMENT);continue;case P.COMMENT_ENDED:T!==">"?(he(i,"Malformed comment"),i.comment+="--"+T,i.state=P.COMMENT):i.doctype&&i.doctype!==!0?i.state=P.DOCTYPE_DTD:i.state=P.TEXT;continue;case P.CDATA:T==="]"?i.state=P.CDATA_ENDING:i.cdata+=T;continue;case P.CDATA_ENDING:T==="]"?i.state=P.CDATA_ENDING_2:(i.cdata+="]"+T,i.state=P.CDATA);continue;case P.CDATA_ENDING_2:T===">"?(i.cdata&&de(i,"oncdata",i.cdata),de(i,"onclosecdata"),i.cdata="",i.state=P.TEXT):T==="]"?i.cdata+="]":(i.cdata+="]]"+T,i.state=P.CDATA);continue;case P.PROC_INST:T==="?"?i.state=P.PROC_INST_ENDING:$(T)?i.state=P.PROC_INST_BODY:i.procInstName+=T;continue;case P.PROC_INST_BODY:if(!i.procInstBody&&$(T))continue;T==="?"?i.state=P.PROC_INST_ENDING:i.procInstBody+=T;continue;case P.PROC_INST_ENDING:T===">"?(de(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=P.TEXT):(i.procInstBody+="?"+T,i.state=P.PROC_INST_BODY);continue;case P.OPEN_TAG:oe(ae,T)?i.tagName+=T:(Ye(i),T===">"?Ke(i):T==="/"?i.state=P.OPEN_TAG_SLASH:($(T)||he(i,"Invalid character in tag name"),i.state=P.ATTRIB));continue;case P.OPEN_TAG_SLASH:T===">"?(Ke(i,!0),Nt(i)):(he(i,"Forward-slash in opening tag not followed by >"),i.state=P.ATTRIB);continue;case P.ATTRIB:if($(T))continue;T===">"?Ke(i):T==="/"?i.state=P.OPEN_TAG_SLASH:oe(X,T)?(i.attribName=T,i.attribValue="",i.state=P.ATTRIB_NAME):he(i,"Invalid attribute name");continue;case P.ATTRIB_NAME:T==="="?i.state=P.ATTRIB_VALUE:T===">"?(he(i,"Attribute without value"),i.attribValue=i.attribName,Le(i),Ke(i)):$(T)?i.state=P.ATTRIB_NAME_SAW_WHITE:oe(ae,T)?i.attribName+=T:he(i,"Invalid attribute name");continue;case P.ATTRIB_NAME_SAW_WHITE:if(T==="=")i.state=P.ATTRIB_VALUE;else{if($(T))continue;he(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",de(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",T===">"?Ke(i):oe(X,T)?(i.attribName=T,i.state=P.ATTRIB_NAME):(he(i,"Invalid attribute name"),i.state=P.ATTRIB)}continue;case P.ATTRIB_VALUE:if($(T))continue;ie(T)?(i.q=T,i.state=P.ATTRIB_VALUE_QUOTED):(i.opt.unquotedAttributeValues||me(i,"Unquoted attribute value"),i.state=P.ATTRIB_VALUE_UNQUOTED,i.attribValue=T);continue;case P.ATTRIB_VALUE_QUOTED:if(T!==i.q){T==="&"?i.state=P.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=T;continue}Le(i),i.q="",i.state=P.ATTRIB_VALUE_CLOSED;continue;case P.ATTRIB_VALUE_CLOSED:$(T)?i.state=P.ATTRIB:T===">"?Ke(i):T==="/"?i.state=P.OPEN_TAG_SLASH:oe(X,T)?(he(i,"No whitespace between attributes"),i.attribName=T,i.attribValue="",i.state=P.ATTRIB_NAME):he(i,"Invalid attribute name");continue;case P.ATTRIB_VALUE_UNQUOTED:if(!fe(T)){T==="&"?i.state=P.ATTRIB_VALUE_ENTITY_U:i.attribValue+=T;continue}Le(i),T===">"?Ke(i):i.state=P.ATTRIB;continue;case P.CLOSE_TAG:if(i.tagName)T===">"?Nt(i):oe(ae,T)?i.tagName+=T:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=P.SCRIPT):($(T)||he(i,"Invalid tagname in closing tag"),i.state=P.CLOSE_TAG_SAW_WHITE);else{if($(T))continue;Ce(X,T)?i.script?(i.script+="</"+T,i.state=P.SCRIPT):he(i,"Invalid tagname in closing tag."):i.tagName=T}continue;case P.CLOSE_TAG_SAW_WHITE:if($(T))continue;T===">"?Nt(i):he(i,"Invalid characters in closing tag");continue;case P.TEXT_ENTITY:case P.ATTRIB_VALUE_ENTITY_Q:case P.ATTRIB_VALUE_ENTITY_U:var ye,Ae;switch(i.state){case P.TEXT_ENTITY:ye=P.TEXT,Ae="textNode";break;case P.ATTRIB_VALUE_ENTITY_Q:ye=P.ATTRIB_VALUE_QUOTED,Ae="attribValue";break;case P.ATTRIB_VALUE_ENTITY_U:ye=P.ATTRIB_VALUE_UNQUOTED,Ae="attribValue";break}if(T===";"){var we=Je(i);i.opt.unparsedEntities&&!Object.values(l.XML_ENTITIES).includes(we)?(i.entity="",i.state=ye,i.write(we)):(i[Ae]+=we,i.entity="",i.state=ye)}else oe(i.entity.length?J:be,T)?i.entity+=T:(he(i,"Invalid character in entity name"),i[Ae]+="&"+i.entity+T,i.entity="",i.state=ye);continue;default:throw new Error(i,"Unknown state: "+i.state)}return i.position>=i.bufferCheckPosition&&D(i),i}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var u=String.fromCharCode,i=Math.floor,E=function(){var T=16384,ce=[],Z,ye,Ae=-1,we=arguments.length;if(!we)return"";for(var et="";++Ae<we;){var xe=Number(arguments[Ae]);if(!isFinite(xe)||xe<0||xe>1114111||i(xe)!==xe)throw RangeError("Invalid code point: "+xe);xe<=65535?ce.push(xe):(xe-=65536,Z=(xe>>10)+55296,ye=xe%1024+56320,ce.push(Z,ye)),(Ae+1===we||ce.length>T)&&(et+=u.apply(null,ce),ce.length=0)}return et};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:E,configurable:!0,writable:!0}):String.fromCodePoint=E}()})(s)}(da)),da}var ci=ui();const zt={};function li(s){const{parentId:l,child:h}=s;zt[l]||(zt[l]=[]);const f={id:h.id,tagName:h.tagName};zt[l].push(f)}function fi(s){const{currentBatch:l}=s,h=[...l];for(const[f,D]of h.entries()){const I=zt[D.id]||[];I.length>0&&(h[f].children.push(...I),di({parentId:D.id}))}return h}function di(s){const{parentId:l}=s;delete zt[l]}function pi(s){return"prefix"in s&&"uri"in s&&!!s.prefix&&!!s.uri}const hi=[".fsd",".asd",".ssd",".scd",".isd",".icd",".xml"],At="sclElements",pr="id, tagName, &attributes.uuid, &attributes.id, attributes.name, parent.id, parent.tagName, *children.id, *children.tagName",hr="attachedFiles",ma="id, filename, file",ka={default:{prefix:"",uri:"http://www.iec.ch/61850/2003/SCL"}};function mi(s){return s!==null&&typeof s=="object"&&"namespace"in s&&s.namespace!==null}function yi(){let s={defaultNamespace:null,stack:[],recordsBatch:[]};const l=ci.parser(!0,{lowercase:!1,trim:!0,normalize:!0,position:!1,xmlns:!0});l.onopentag=D=>s=vi({node:D,state:s}),l.ontext=D=>s=gi({text:D,state:s}),l.onclosetag=()=>({updatedState:s}=bi({state:s})),l.onerror=wi;function h(){const D=s.recordsBatch;return s.recordsBatch=[],D}function f(){return s.recordsBatch.length}return{parser:l,drainBatch:h,getSize:f}}function vi(s){const{node:l,state:h}=s,f={...h},D=_i(l);f.defaultNamespace||(f.defaultNamespace=Si(l));const I=Ti(l,f.defaultNamespace),R=xi(l.attributes),O=Ei(h.stack),K={id:crypto.randomUUID(),tagName:D,namespace:I,attributes:R,value:"",parent:O,children:[]};return f.stack.push(K),f}function gi(s){const{text:l,state:h}=s;return l&&h.stack.length>0&&(h.stack[h.stack.length-1].value+=l),h}function bi(s){const{state:l}=s,h=l.stack.at(-1);let f=l.stack.slice(0,-1);const D=[...l.recordsBatch];if(h){if(f.length){const I=f.length-1;f=f.map((R,O)=>O===I?{...R,children:[...R.children,{id:h.id,tagName:h.tagName}]}:R)}else h.parent&&li({parentId:h.parent.id,child:{id:h.id,tagName:h.tagName}});D.push(h)}return{updatedState:{defaultNamespace:l.defaultNamespace,stack:f,recordsBatch:D}}}function wi(s){return new Error(`XML parsing error: ${s}`)}function _i(s){return s.local||null}function Si(s){if(s.name!=="SCL")throw new Error("Default namespace can only be set on SCL element");return s.attributes?.xmlns?.value?{prefix:"",uri:s.attributes.xmlns.value}:ka.default}function Ti(s,l){return pi(s)?{prefix:s.prefix,uri:s.uri}:l}function xi(s){return Object.values(s).map(l=>{const h=l.prefix&&l.uri?{prefix:l.prefix,uri:l.uri}:void 0;return{name:h?l.local:l.name,value:l.value,...h&&{namespace:h}}})}function Ei(s){if(s.length===0)return null;const l=s[s.length-1];return l?{id:l.id,tagName:l.tagName}:null}var wr={exports:{}},Pi=wr.exports,ya;function Di(){return ya||(ya=1,function(s,l){(function(h,f){s.exports=f()})(Pi,function(){var h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])})(e,t)},f=function(){return(f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function D(e,t,n){for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||((r=r||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var I=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ai,R=Object.keys,O=Array.isArray;function K(e,t){return typeof t!="object"||R(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||I.Promise||(I.Promise=Promise);var z=Object.getPrototypeOf,Q={}.hasOwnProperty;function Y(e,t){return Q.call(e,t)}function ne(e,t){typeof t=="function"&&(t=t(z(e))),(typeof Reflect>"u"?R:Reflect.ownKeys)(t).forEach(function(n){k(e,n,t[n])})}var W=Object.defineProperty;function k(e,t,n,r){W(e,t,K(n&&Y(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function F(e){return{from:function(t){return e.prototype=Object.create(t.prototype),k(e.prototype,"constructor",e),{extend:ne.bind(null,e.prototype)}}}}var X=Object.getOwnPropertyDescriptor,ae=[].slice;function be(e,t,n){return ae.call(e,t,n)}function J(e,t){return t(e)}function $(e){if(!e)throw new Error("Assertion Failed")}function ie(e){I.setImmediate?setImmediate(e):setTimeout(e,0)}function fe(e,t){if(typeof t=="string"&&Y(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,a=t.length;r<a;++r){var o=fe(e,t[r]);n.push(o)}return n}var c=t.indexOf(".");if(c!==-1){var d=e[t.substr(0,c)];return d==null?void 0:fe(d,t.substr(c+1))}}function oe(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){$(typeof n!="string"&&"length"in n);for(var r=0,a=t.length;r<a;++r)oe(e,t[r],n[r])}else{var o,c,d=t.indexOf(".");d!==-1?(o=t.substr(0,d),(c=t.substr(d+1))===""?n===void 0?O(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n:oe(d=!(d=e[o])||!Y(e,o)?e[o]={}:d,c,n)):n===void 0?O(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Ce(e){var t,n={};for(t in e)Y(e,t)&&(n[t]=e[t]);return n}var P=[].concat;function ut(e){return P.apply([],e)}var lt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ut([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return I[e]}),Ve=new Set(lt.map(function(e){return I[e]})),de=null;function Fe(e){return de=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var r=de.get(n);if(r)return r;if(O(n)){r=[],de.set(n,r);for(var a=0,o=n.length;a<o;++a)r.push(t(n[a]))}else if(Ve.has(n.constructor))r=n;else{var c,d=z(n);for(c in r=d===Object.prototype?{}:Object.create(d),de.set(n,r),n)Y(n,c)&&(r[c]=t(n[c]))}return r}(e),de=null,e}var se={}.toString;function me(e){return se.call(e).slice(8,-1)}var Ee=typeof Symbol<"u"?Symbol.iterator:"@@iterator",he=typeof Ee=="symbol"?function(e){var t;return e!=null&&(t=e[Ee])&&t.apply(e)}:function(){return null};function Ye(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Ue={};function Le(e){var t,n,r,a;if(arguments.length===1){if(O(e))return e.slice();if(this===Ue&&typeof e=="string")return[e];if(a=he(e)){for(n=[];!(r=a.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Ke=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Rt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Me=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Rt),Nt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Je(e,t){this.name=e,this.message=t}function It(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,a){return a.indexOf(n)===r}).join(`
`)}function ct(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=It(e,t)}function Ze(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=It(e,this.failures)}F(Je).from(Error).extend({toString:function(){return this.name+": "+this.message}}),F(ct).from(Je),F(Ze).from(Je);var u=Me.reduce(function(e,t){return e[t]=t+"Error",e},{}),i=Je,E=Me.reduce(function(e,t){var n=t+"Error";function r(a,o){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(o?`
 `+o:""),this.inner=o||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=Nt[t]||n,this.inner=null)}return F(r).from(i),e[t]=r,e},{});E.Syntax=SyntaxError,E.Type=TypeError,E.Range=RangeError;var T=Rt.reduce(function(e,t){return e[t+"Error"]=E[t],e},{}),ce=Me.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=E[t]),e},{});function Z(){}function ye(e){return e}function Ae(e,t){return e==null||e===ye?t:function(n){return t(e(n))}}function we(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function et(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?we(r,this.onsuccess):r),a&&(this.onerror=this.onerror?we(a,this.onerror):a),o!==void 0?o:n}}function xe(e,t){return e===Z?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?we(n,this.onsuccess):n),r&&(this.onerror=this.onerror?we(r,this.onerror):r)}}function qe(e,t){return e===Z?t:function(n){var r=e.apply(this,arguments);K(n,r);var a=this.onsuccess,o=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?we(a,this.onsuccess):a),o&&(this.onerror=this.onerror?we(o,this.onerror):o),r===void 0?n===void 0?void 0:n:K(r,n)}}function On(e,t){return e===Z?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function _t(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,a=arguments.length,o=new Array(a);a--;)o[a]=arguments[a];return n.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}ce.ModifyError=ct,ce.DexieError=Je,ce.BulkError=Ze;var Re=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ft(e){Re=e}var kt={},Cr=100,lt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,z(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,z(t),e]}(),Rt=lt[0],Me=lt[1],lt=lt[2],Me=Me&&Me.then,ft=Rt&&Rt.constructor,Nn=!!lt,Lt=function(e,t){Bt.push([e,t]),Jt&&(queueMicrotask(qa),Jt=!1)},In=!0,Jt=!0,dt=[],Zt=[],Fn=ye,tt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Z,pgp:!1,env:{},finalize:Z},H=tt,Bt=[],pt=0,en=[];function U(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=H;if(typeof e!="function"){if(e!==kt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Rn(this,this._value))}this._state=null,this._value=null,++t.ref,function n(r,a){try{a(function(o){if(r._state===null){if(o===r)throw new TypeError("A promise cannot be resolved with itself.");var c=r._lib&&St();o&&typeof o.then=="function"?n(r,function(d,m){o instanceof U?o._then(d,m):o.then(d,m)}):(r._state=!0,r._value=o,Or(r)),c&&Tt()}},Rn.bind(null,r))}catch(o){Rn(r,o)}}(this,e)}var kn={get:function(){var e=H,t=an;function n(r,a){var o=this,c=!e.global&&(e!==H||t!==an),d=c&&!rt(),m=new U(function(v,b){Ln(o,new Ar(Ir(r,e,c,d),Ir(a,e,c,d),v,b,e))});return this._consoleTask&&(m._consoleTask=this._consoleTask),m}return n.prototype=kt,n},set:function(e){k(this,"then",e&&e.prototype===kt?kn:{get:function(){return e},set:kn.set})}};function Ar(e,t,n,r,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=a}function Rn(e,t){var n,r;Zt.push(t),e._state===null&&(n=e._lib&&St(),t=Fn(t),e._state=!1,e._value=t,r=e,dt.some(function(a){return a._value===r._value})||dt.push(r),Or(e),n&&Tt())}function Or(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ln(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),pt===0&&(++pt,Lt(function(){--pt==0&&Bn()},[]))}function Ln(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++pt,Lt(Ka,[n,e,t])}else e._listeners.push(t)}function Ka(e,t,n){try{var r,a=t._value;!t._state&&Zt.length&&(Zt=[]),r=Re&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||Zt.indexOf(a)!==-1||function(o){for(var c=dt.length;c;)if(dt[--c]._value===o._value)return dt.splice(c,1)}(t),n.resolve(r)}catch(o){n.reject(o)}finally{--pt==0&&Bn(),--n.psd.ref||n.psd.finalize()}}function qa(){ht(tt,function(){St()&&Tt()})}function St(){var e=In;return Jt=In=!1,e}function Tt(){var e,t,n;do for(;0<Bt.length;)for(e=Bt,Bt=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<Bt.length);Jt=In=!0}function Bn(){var e=dt;dt=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=en.slice(0),n=t.length;n;)t[--n]()}function tn(e){return new U(kt,!1,e)}function ge(e,t){var n=H;return function(){var r=St(),a=H;try{return at(n,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{at(a,!1),r&&Tt()}}}ne(U.prototype,{then:kn,_then:function(e,t){Ln(this,new Ar(null,null,e,t,H))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:tn)(r)}):this.then(null,function(r){return(r&&r.name===t?n:tn)(r)})},finally:function(e){return this.then(function(t){return U.resolve(e()).then(function(){return t})},function(t){return U.resolve(e()).then(function(){return tn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new U(function(r,a){var o=setTimeout(function(){return a(new E.Timeout(t))},e);n.then(r,a).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&k(U.prototype,Symbol.toStringTag,"Dexie.Promise"),tt.env=Nr(),ne(U,{all:function(){var e=Le.apply(null,arguments).map(on);return new U(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(a,o){return U.resolve(a).then(function(c){e[o]=c,--r||t(e)},n)})})},resolve:function(e){return e instanceof U?e:e&&typeof e.then=="function"?new U(function(t,n){e.then(t,n)}):new U(kt,!0,e)},reject:tn,race:function(){var e=Le.apply(null,arguments).map(on);return new U(function(t,n){e.map(function(r){return U.resolve(r).then(t,n)})})},PSD:{get:function(){return H},set:function(e){return H=e}},totalEchoes:{get:function(){return an}},newPSD:nt,usePSD:ht,scheduler:{get:function(){return Lt},set:function(e){Lt=e}},rejectionMapper:{get:function(){return Fn},set:function(e){Fn=e}},follow:function(e,t){return new U(function(n,r){return nt(function(a,o){var c=H;c.unhandleds=[],c.onunhandled=o,c.finalize=we(function(){var d,m=this;d=function(){m.unhandleds.length===0?a():o(m.unhandleds[0])},en.push(function v(){d(),en.splice(en.indexOf(v),1)}),++pt,Lt(function(){--pt==0&&Bn()},[])},c.finalize),e()},t,n,r)})}}),ft&&(ft.allSettled&&k(U,"allSettled",function(){var e=Le.apply(null,arguments).map(on);return new U(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(a,o){return U.resolve(a).then(function(c){return r[o]={status:"fulfilled",value:c}},function(c){return r[o]={status:"rejected",reason:c}}).then(function(){return--n||t(r)})})})}),ft.any&&typeof AggregateError<"u"&&k(U,"any",function(){var e=Le.apply(null,arguments).map(on);return new U(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,a=new Array(r);e.forEach(function(o,c){return U.resolve(o).then(function(d){return t(d)},function(d){a[c]=d,--r||n(new AggregateError(a))})})})}),ft.withResolvers&&(U.withResolvers=ft.withResolvers));var Pe={awaits:0,echoes:0,id:0},ja=0,nn=[],rn=0,an=0,Va=0;function nt(e,t,n,r){var a=H,o=Object.create(a);return o.parent=a,o.ref=0,o.global=!1,o.id=++Va,tt.env,o.env=Nn?{Promise:U,PromiseProp:{value:U,configurable:!0,writable:!0},all:U.all,race:U.race,allSettled:U.allSettled,any:U.any,resolve:U.resolve,reject:U.reject}:{},t&&K(o,t),++a.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()},r=ht(o,e,n,r),o.ref===0&&o.finalize(),r}function xt(){return Pe.id||(Pe.id=++ja),++Pe.awaits,Pe.echoes+=Cr,Pe.id}function rt(){return!!Pe.awaits&&(--Pe.awaits==0&&(Pe.id=0),Pe.echoes=Pe.awaits*Cr,!0)}function on(e){return Pe.echoes&&e&&e.constructor===ft?(xt(),e.then(function(t){return rt(),t},function(t){return rt(),Se(t)})):e}function Ua(){var e=nn[nn.length-1];nn.pop(),at(e,!1)}function at(e,t){var n,r=H;(t?!Pe.echoes||rn++&&e===H:!rn||--rn&&e===H)||queueMicrotask(t?(function(a){++an,Pe.echoes&&--Pe.echoes!=0||(Pe.echoes=Pe.awaits=Pe.id=0),nn.push(H),at(a,!0)}).bind(null,e):Ua),e!==H&&(H=e,r===tt&&(tt.env=Nr()),Nn&&(n=tt.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(I,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Nr(){var e=I.Promise;return Nn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(I,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ht(e,t,n,r,a){var o=H;try{return at(e,!0),t(n,r,a)}finally{at(o,!1)}}function Ir(e,t,n,r){return typeof e!="function"?e:function(){var a=H;n&&xt(),at(t,!0);try{return e.apply(this,arguments)}finally{at(a,!1),r&&queueMicrotask(rt)}}}function Mn(e){Promise===ft&&Pe.echoes===0?rn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Me).indexOf("[native code]")===-1&&(xt=rt=Z);var Se=U.reject,mt="",$e="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Fr="String expected.",Et=[],sn="__dbnames",Kn="readonly",qn="readwrite";function yt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var kr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function un(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=Fe(t))[e],t}}function Rr(){throw E.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ue(e,t){try{var n=Lr(e),r=Lr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(a,o){for(var c=a.length,d=o.length,m=c<d?c:d,v=0;v<m;++v)if(a[v]!==o[v])return a[v]<o[v]?-1:1;return c===d?0:c<d?-1:1}(Br(e),Br(t));case"Array":return function(a,o){for(var c=a.length,d=o.length,m=c<d?c:d,v=0;v<m;++v){var b=ue(a[v],o[v]);if(b!==0)return b}return c===d?0:c<d?-1:1}(e,t)}}catch{}return NaN}function Lr(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=me(e),e==="ArrayBuffer"?"binary":e)}function Br(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function cn(e,t,n){var r=e.schema.yProps;return r?(t&&0<n.numFailures&&(t=t.filter(function(a,o){return!n.failures[o]})),Promise.all(r.map(function(a){return a=a.updatesTable,t?e.db.table(a).where("k").anyOf(t).delete():e.db.table(a).clear()})).then(function(){return n})):n}var Mr=(ve.prototype._trans=function(e,t,n){var r=this._tx||H.trans,a=this.name,o=Re&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function c(v,b,p){if(!p.schema[a])throw new E.NotFound("Table "+a+" not part of transaction");return t(p.idbtrans,p)}var d=St();try{var m=r&&r.db._novip===this.db._novip?r===H.trans?r._promise(e,c,n):nt(function(){return r._promise(e,c,n)},{trans:r,transless:H.transless||H}):function v(b,p,S,y){if(b.idbdb&&(b._state.openComplete||H.letThrough||b._vip)){var g=b._createTransaction(p,S,b._dbSchema);try{g.create(),b._state.PR1398_maxLoop=3}catch(_){return _.name===u.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return v(b,p,S,y)})):Se(_)}return g._promise(p,function(_,w){return nt(function(){return H.trans=g,y(_,w,g)})}).then(function(_){if(p==="readwrite")try{g.idbtrans.commit()}catch{}return p==="readonly"?_:g._completion.then(function(){return _})})}if(b._state.openComplete)return Se(new E.DatabaseClosed(b._state.dbOpenError));if(!b._state.isBeingOpened){if(!b._state.autoOpen)return Se(new E.DatabaseClosed);b.open().catch(Z)}return b._state.dbReadyPromise.then(function(){return v(b,p,S,y)})}(this.db,e,[this.name],c);return o&&(m._consoleTask=o,m=m.catch(function(v){return console.trace(v),Se(v)})),m}finally{d&&Tt()}},ve.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Se(new E.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(a){return n.hook.reading.fire(a)})}).then(t)},ve.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(O(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=R(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(d){if(d.compound&&t.every(function(v){return 0<=d.keyPath.indexOf(v)})){for(var m=0;m<t.length;++m)if(t.indexOf(d.keyPath[m])===-1)return!1;return!0}return!1}).sort(function(d,m){return d.keyPath.length-m.keyPath.length})[0];if(n&&this.db._maxKey!==mt){var o=n.keyPath.slice(0,t.length);return this.where(o).equals(o.map(function(m){return e[m]}))}!n&&Re&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName;function a(d,m){return ue(d,m)===0}var c=t.reduce(function(p,m){var v=p[0],b=p[1],p=r[m],S=e[m];return[v||p,v||!p?yt(b,p&&p.multi?function(y){return y=fe(y,m),O(y)&&y.some(function(g){return a(S,g)})}:function(y){return a(S,fe(y,m))}):b]},[null,null]),o=c[0],c=c[1];return o?this.where(o.name).equals(e[o.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")},ve.prototype.filter=function(e){return this.toCollection().and(e)},ve.prototype.count=function(e){return this.toCollection().count(e)},ve.prototype.offset=function(e){return this.toCollection().offset(e)},ve.prototype.limit=function(e){return this.toCollection().limit(e)},ve.prototype.each=function(e){return this.toCollection().each(e)},ve.prototype.toArray=function(e){return this.toCollection().toArray(e)},ve.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ve.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,O(e)?"[".concat(e.join("+"),"]"):e))},ve.prototype.reverse=function(){return this.toCollection().reverse()},ve.prototype.mapToClass=function(e){var t,n=this.db,r=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Rr&&(function(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function b(){this.constructor=m}h(m,v),m.prototype=v===null?Object.create(v):(b.prototype=v.prototype,new b)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),a.prototype.table=function(){return r},e=a);for(var o=new Set,c=e.prototype;c;c=z(c))Object.getOwnPropertyNames(c).forEach(function(m){return o.add(m)});function d(m){if(!m)return m;var v,b=Object.create(e.prototype);for(v in m)if(!o.has(v))try{b[v]=m[v]}catch{}return b}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=d,this.hook("reading",d),e},ve.prototype.defineClass=function(){return this.mapToClass(function(e){K(this,e)})},ve.prototype.add=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,o=r.keyPath,c=e;return o&&a&&(c=un(o)(e)),this._trans("readwrite",function(d){return n.core.mutate({trans:d,type:"add",keys:t!=null?[t]:null,values:[c]})}).then(function(d){return d.numFailures?U.reject(d.failures[0]):d.lastResult}).then(function(d){if(o)try{oe(e,o,d)}catch{}return d})},ve.prototype.update=function(e,t){return typeof e!="object"||O(e)?this.where(":id").equals(e).modify(t):(e=fe(e,this.schema.primKey.keyPath),e===void 0?Se(new E.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},ve.prototype.put=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,o=r.keyPath,c=e;return o&&a&&(c=un(o)(e)),this._trans("readwrite",function(d){return n.core.mutate({trans:d,type:"put",values:[c],keys:t!=null?[t]:null})}).then(function(d){return d.numFailures?U.reject(d.failures[0]):d.lastResult}).then(function(d){if(o)try{oe(e,o,d)}catch{}return d})},ve.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(r){return cn(t,[e],r)}).then(function(r){return r.numFailures?U.reject(r.failures[0]):void 0})})},ve.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:kr}).then(function(n){return cn(e,null,n)})}).then(function(t){return t.numFailures?U.reject(t.failures[0]):void 0})},ve.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(a){return t.hook.reading.fire(a)})})})},ve.prototype.bulkAdd=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,o=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var v=r.schema.primKey,d=v.auto,v=v.keyPath;if(v&&a)throw new E.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new E.InvalidArgument("Arguments objects and keys must have the same length");var m=e.length,v=v&&d?e.map(un(v)):e;return r.core.mutate({trans:c,type:"add",keys:a,values:v,wantResults:o}).then(function(g){var p=g.numFailures,S=g.results,y=g.lastResult,g=g.failures;if(p===0)return o?S:y;throw new Ze("".concat(r.name,".bulkAdd(): ").concat(p," of ").concat(m," operations failed"),g)})})},ve.prototype.bulkPut=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,o=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var v=r.schema.primKey,d=v.auto,v=v.keyPath;if(v&&a)throw new E.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new E.InvalidArgument("Arguments objects and keys must have the same length");var m=e.length,v=v&&d?e.map(un(v)):e;return r.core.mutate({trans:c,type:"put",keys:a,values:v,wantResults:o}).then(function(g){var p=g.numFailures,S=g.results,y=g.lastResult,g=g.failures;if(p===0)return o?S:y;throw new Ze("".concat(r.name,".bulkPut(): ").concat(p," of ").concat(m," operations failed"),g)})})},ve.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(c){return c.key}),a=e.map(function(c){return c.changes}),o=[];return this._trans("readwrite",function(c){return n.getMany({trans:c,keys:r,cache:"clone"}).then(function(d){var m=[],v=[];e.forEach(function(p,S){var y=p.key,g=p.changes,_=d[S];if(_){for(var w=0,x=Object.keys(g);w<x.length;w++){var C=x[w],A=g[C];if(C===t.schema.primKey.keyPath){if(ue(A,y)!==0)throw new E.Constraint("Cannot update primary key in bulkUpdate()")}else oe(_,C,A)}o.push(S),m.push(y),v.push(_)}});var b=m.length;return n.mutate({trans:c,type:"put",keys:m,values:v,updates:{keys:r,changeSpecs:a}}).then(function(p){var S=p.numFailures,y=p.failures;if(S===0)return b;for(var g=0,_=Object.keys(y);g<_.length;g++){var w,x=_[g],C=o[Number(x)];C!=null&&(w=y[x],delete y[x],y[C]=w)}throw new Ze("".concat(t.name,".bulkUpdate(): ").concat(S," of ").concat(b," operations failed"),y)})})})},ve.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e}).then(function(a){return cn(t,e,a)})}).then(function(c){var a=c.numFailures,o=c.lastResult,c=c.failures;if(a===0)return o;throw new Ze("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(n," operations failed"),c)})},ve);function ve(){}function Mt(e){function t(c,d){if(d){for(var m=arguments.length,v=new Array(m-1);--m;)v[m-1]=arguments[m];return n[c].subscribe.apply(null,v),e}if(typeof c=="string")return n[c]}var n={};t.addEventType=o;for(var r=1,a=arguments.length;r<a;++r)o(arguments[r]);return t;function o(c,d,m){if(typeof c!="object"){var v;d=d||On;var b={subscribers:[],fire:m=m||Z,subscribe:function(p){b.subscribers.indexOf(p)===-1&&(b.subscribers.push(p),b.fire=d(b.fire,p))},unsubscribe:function(p){b.subscribers=b.subscribers.filter(function(S){return S!==p}),b.fire=b.subscribers.reduce(d,m)}};return n[c]=t[c]=b}R(v=c).forEach(function(p){var S=v[p];if(O(S))o(p,v[p][0],v[p][1]);else{if(S!=="asap")throw new E.InvalidArgument("Invalid event config");var y=o(p,ye,function(){for(var g=arguments.length,_=new Array(g);g--;)_[g]=arguments[g];y.subscribers.forEach(function(w){ie(function(){w.apply(null,_)})})})}})}}function Kt(e,t){return F(t).from({prototype:e}),t}function Pt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function jn(e,t){e.filter=yt(e.filter,t)}function Vn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return yt(r(),t())}:t,e.justLimit=n&&!r}function ln(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new E.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Kr(e,t,n){var r=ln(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function fn(e,t,n,r){var a=e.replayFilter?yt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},c=function(d,m,v){var b,p;a&&!a(m,v,function(S){return m.stop(S)},function(S){return m.fail(S)})||((p=""+(b=m.primaryKey))=="[object ArrayBuffer]"&&(p=""+new Uint8Array(b)),Y(o,p)||(o[p]=!0,t(d,m,v)))};return Promise.all([e.or._iterate(c,n),qr(Kr(e,r,n),e.algorithm,c,!e.keysOnly&&e.valueMapper)])}return qr(Kr(e,r,n),yt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function qr(e,t,n,r){var a=ge(r?function(o,c,d){return n(r(o),c,d)}:n);return e.then(function(o){if(o)return o.start(function(){var c=function(){return o.continue()};t&&!t(o,function(d){return c=d},function(d){o.stop(d),c=Z},function(d){o.fail(d),c=Z})||a(o.value,o,function(d){return c=d}),c()})})}var qt=(jr.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(O(n))return D(D([],O(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var r=t.remove;if(O(r))return O(e)?e.filter(function(a){return!r.includes(a)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},jr);function jr(e){this["@@propmod"]=e}var Ga=(pe.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Se.bind(null,n.error)):n.table._trans("readonly",e).then(t)},pe.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Se.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},pe.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=yt(t.algorithm,e)},pe.prototype._iterate=function(e,t){return fn(this._ctx,e,t,this._ctx.table.core)},pe.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&K(n,e),t._ctx=n,t},pe.prototype.raw=function(){return this._ctx.valueMapper=null,this},pe.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return fn(t,e,n,t.table.core)})},pe.prototype.count=function(e){var t=this;return this._read(function(n){var r=t._ctx,a=r.table.core;if(Pt(r,!0))return a.count({trans:n,query:{index:ln(r,a.schema),range:r.range}}).then(function(c){return Math.min(c,r.limit)});var o=0;return fn(r,function(){return++o,!1},n,a).then(function(){return o})}).then(e)},pe.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],a=n.length-1;function o(m,v){return v?o(m[n[v]],v-1):m[r]}var c=this._ctx.dir==="next"?1:-1;function d(m,v){return ue(o(m,a),o(v,a))*c}return this.toArray(function(m){return m.sort(d)}).then(t)},pe.prototype.toArray=function(e){var t=this;return this._read(function(n){var r=t._ctx;if(r.dir==="next"&&Pt(r,!0)&&0<r.limit){var a=r.valueMapper,o=ln(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:o,range:r.range}}).then(function(d){return d=d.result,a?d.map(a):d})}var c=[];return fn(r,function(d){return c.push(d)},n,r.table.core).then(function(){return c})},e)},pe.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Pt(t)?Vn(t,function(){var n=e;return function(r,a){return n===0||(n===1?--n:a(function(){r.advance(n),n=0}),!1)}}):Vn(t,function(){var n=e;return function(){return--n<0}})),this},pe.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Vn(this._ctx,function(){var t=e;return function(n,r,a){return--t<=0&&r(a),0<=t}},!0),this},pe.prototype.until=function(e,t){return jn(this._ctx,function(n,r,a){return!e(n.value)||(r(a),t)}),this},pe.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},pe.prototype.last=function(e){return this.reverse().first(e)},pe.prototype.filter=function(e){var t;return jn(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=yt(t.isMatch,e),this},pe.prototype.and=function(e){return this.filter(e)},pe.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},pe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},pe.prototype.desc=function(){return this.reverse()},pe.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},pe.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},pe.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},pe.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,a){n.push(a.key)}).then(function(){return n}).then(e)},pe.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Pt(t,!0)&&0<t.limit)return this._read(function(r){var a=ln(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,a){n.push(a.primaryKey)}).then(function(){return n}).then(e)},pe.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},pe.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},pe.prototype.lastKey=function(e){return this.reverse().firstKey(e)},pe.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return jn(this._ctx,function(a){var r=a.primaryKey.toString(),a=Y(t,r);return t[r]=!0,!a}),this},pe.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var a,o,c;c=typeof e=="function"?e:(a=R(e),o=a.length,function(x){for(var C=!1,A=0;A<o;++A){var N=a[A],L=e[N],q=fe(x,N);L instanceof qt?(oe(x,N,L.execute(q)),C=!0):q!==L&&(oe(x,N,L),C=!0)}return C});var d=n.table.core,p=d.schema.primaryKey,m=p.outbound,v=p.extractKey,b=200,p=t.db._options.modifyChunkSize;p&&(b=typeof p=="object"?p[d.name]||p["*"]||200:p);function S(x,N){var A=N.failures,N=N.numFailures;g+=x-N;for(var L=0,q=R(A);L<q.length;L++){var B=q[L];y.push(A[B])}}var y=[],g=0,_=[],w=e===Vr;return t.clone().primaryKeys().then(function(x){function C(N){var L=Math.min(b,x.length-N),q=x.slice(N,N+L);return(w?Promise.resolve([]):d.getMany({trans:r,keys:q,cache:"immutable"})).then(function(B){var M=[],V=[],j=m?[]:null,G=w?q:[];if(!w)for(var re=0;re<L;++re){var le=B[re],te={value:Fe(le),primKey:x[N+re]};c.call(te,te.value,te)!==!1&&(te.value==null?G.push(x[N+re]):m||ue(v(le),v(te.value))===0?(V.push(te.value),m&&j.push(x[N+re])):(G.push(x[N+re]),M.push(te.value)))}return Promise.resolve(0<M.length&&d.mutate({trans:r,type:"add",values:M}).then(function(_e){for(var ee in _e.failures)G.splice(parseInt(ee),1);S(M.length,_e)})).then(function(){return(0<V.length||A&&typeof e=="object")&&d.mutate({trans:r,type:"put",keys:j,values:V,criteria:A,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<N}).then(function(_e){return S(V.length,_e)})}).then(function(){return(0<G.length||A&&w)&&d.mutate({trans:r,type:"delete",keys:G,criteria:A,isAdditionalChunk:0<N}).then(function(_e){return cn(n.table,G,_e)}).then(function(_e){return S(G.length,_e)})}).then(function(){return x.length>N+L&&C(N+b)})})}var A=Pt(n)&&n.limit===1/0&&(typeof e!="function"||w)&&{index:n.index,range:n.range};return C(0).then(function(){if(0<y.length)throw new ct("Error modifying one or more objects",y,g,_);return x.length})})})},pe.prototype.delete=function(){var e=this._ctx,t=e.range;return!Pt(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Vr):this._write(function(n){var r=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:n,query:{index:r,range:a}}).then(function(o){return e.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(function(m){var d=m.failures,m=m.numFailures;if(m)throw new ct("Could not delete some values",Object.keys(d).map(function(v){return d[v]}),o-m);return o-m})})})},pe);function pe(){}var Vr=function(e,t){return t.value=null};function Wa(e,t){return e<t?-1:e===t?0:1}function Ya(e,t){return t<e?-1:e===t?0:1}function Be(e,t,n){return e=e instanceof Gr?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function Dt(e){return new e.Collection(e,function(){return Ur("")}).limit(0)}function dn(e,t,n,r){var a,o,c,d,m,v,b,p=n.length;if(!n.every(function(g){return typeof g=="string"}))return Be(e,Fr);function S(g){a=g==="next"?function(w){return w.toUpperCase()}:function(w){return w.toLowerCase()},o=g==="next"?function(w){return w.toLowerCase()}:function(w){return w.toUpperCase()},c=g==="next"?Wa:Ya;var _=n.map(function(w){return{lower:o(w),upper:a(w)}}).sort(function(w,x){return c(w.lower,x.lower)});d=_.map(function(w){return w.upper}),m=_.map(function(w){return w.lower}),b=(v=g)==="next"?"":r}S("next"),e=new e.Collection(e,function(){return ot(d[0],m[p-1]+r)}),e._ondirectionchange=function(g){S(g)};var y=0;return e._addAlgorithm(function(g,_,w){var x=g.key;if(typeof x!="string")return!1;var C=o(x);if(t(C,m,y))return!0;for(var A=null,N=y;N<p;++N){var L=function(q,B,M,V,j,G){for(var re=Math.min(q.length,V.length),le=-1,te=0;te<re;++te){var _e=B[te];if(_e!==V[te])return j(q[te],M[te])<0?q.substr(0,te)+M[te]+M.substr(te+1):j(q[te],V[te])<0?q.substr(0,te)+V[te]+M.substr(te+1):0<=le?q.substr(0,le)+B[le]+M.substr(le+1):null;j(q[te],_e)<0&&(le=te)}return re<V.length&&G==="next"?q+M.substr(q.length):re<q.length&&G==="prev"?q.substr(0,M.length):le<0?null:q.substr(0,le)+V[le]+M.substr(le+1)}(x,C,d[N],m[N],c,v);L===null&&A===null?y=N+1:(A===null||0<c(A,L))&&(A=L)}return _(A!==null?function(){g.continue(A+b)}:w),!1}),e}function ot(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Ur(e){return{type:1,lower:e,upper:e}}var Gr=(Object.defineProperty(De.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),De.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?Dt(this):new this.Collection(this,function(){return ot(e,t,!n,!r)})}catch{return Be(this,$e)}},De.prototype.equals=function(e){return e==null?Be(this,$e):new this.Collection(this,function(){return Ur(e)})},De.prototype.above=function(e){return e==null?Be(this,$e):new this.Collection(this,function(){return ot(e,void 0,!0)})},De.prototype.aboveOrEqual=function(e){return e==null?Be(this,$e):new this.Collection(this,function(){return ot(e,void 0,!1)})},De.prototype.below=function(e){return e==null?Be(this,$e):new this.Collection(this,function(){return ot(void 0,e,!1,!0)})},De.prototype.belowOrEqual=function(e){return e==null?Be(this,$e):new this.Collection(this,function(){return ot(void 0,e)})},De.prototype.startsWith=function(e){return typeof e!="string"?Be(this,Fr):this.between(e,e+mt,!0,!0)},De.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):dn(this,function(t,n){return t.indexOf(n[0])===0},[e],mt)},De.prototype.equalsIgnoreCase=function(e){return dn(this,function(t,n){return t===n[0]},[e],"")},De.prototype.anyOfIgnoreCase=function(){var e=Le.apply(Ue,arguments);return e.length===0?Dt(this):dn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},De.prototype.startsWithAnyOfIgnoreCase=function(){var e=Le.apply(Ue,arguments);return e.length===0?Dt(this):dn(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,mt)},De.prototype.anyOf=function(){var e=this,t=Le.apply(Ue,arguments),n=this._cmp;try{t.sort(n)}catch{return Be(this,$e)}if(t.length===0)return Dt(this);var r=new this.Collection(this,function(){return ot(t[0],t[t.length-1])});r._ondirectionchange=function(o){n=o==="next"?e._ascending:e._descending,t.sort(n)};var a=0;return r._addAlgorithm(function(o,c,d){for(var m=o.key;0<n(m,t[a]);)if(++a===t.length)return c(d),!1;return n(m,t[a])===0||(c(function(){o.continue(t[a])}),!1)}),r},De.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},De.prototype.noneOf=function(){var e=Le.apply(Ue,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Be(this,$e)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},De.prototype.inAnyRange=function(x,t){var n=this,r=this._cmp,a=this._ascending,o=this._descending,c=this._min,d=this._max;if(x.length===0)return Dt(this);if(!x.every(function(C){return C[0]!==void 0&&C[1]!==void 0&&a(C[0],C[1])<=0}))return Be(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",E.InvalidArgument);var m=!t||t.includeLowers!==!1,v=t&&t.includeUppers===!0,b,p=a;function S(C,A){return p(C[0],A[0])}try{(b=x.reduce(function(C,A){for(var N=0,L=C.length;N<L;++N){var q=C[N];if(r(A[0],q[1])<0&&0<r(A[1],q[0])){q[0]=c(q[0],A[0]),q[1]=d(q[1],A[1]);break}}return N===L&&C.push(A),C},[])).sort(S)}catch{return Be(this,$e)}var y=0,g=v?function(C){return 0<a(C,b[y][1])}:function(C){return 0<=a(C,b[y][1])},_=m?function(C){return 0<o(C,b[y][0])}:function(C){return 0<=o(C,b[y][0])},w=g,x=new this.Collection(this,function(){return ot(b[0][0],b[b.length-1][1],!m,!v)});return x._ondirectionchange=function(C){p=C==="next"?(w=g,a):(w=_,o),b.sort(S)},x._addAlgorithm(function(C,A,N){for(var L,q=C.key;w(q);)if(++y===b.length)return A(N),!1;return!g(L=q)&&!_(L)||(n._cmp(q,b[y][1])===0||n._cmp(q,b[y][0])===0||A(function(){p===a?C.continue(b[y][0]):C.continue(b[y][1])}),!1)}),x},De.prototype.startsWithAnyOf=function(){var e=Le.apply(Ue,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Dt(this):this.inAnyRange(e.map(function(t){return[t,t+mt]})):Be(this,"startsWithAnyOf() only works with strings")},De);function De(){}function Ge(e){return ge(function(t){return jt(t),e(t.target.error),!1})}function jt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Vt="storagemutated",Un="x-storagemutated-1",it=Mt(null,Vt),$a=(We.prototype._lock=function(){return $(!H.global),++this._reculock,this._reculock!==1||H.global||(H.lockOwnerFor=this),this},We.prototype._unlock=function(){if($(!H.global),--this._reculock==0)for(H.global||(H.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{ht(e[1],e[0])}catch{}}return this},We.prototype._locked=function(){return this._reculock&&H.lockOwnerFor!==this},We.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if($(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new E.DatabaseClosed(r);case"MissingAPIError":throw new E.MissingAPI(r.message,r);default:throw new E.OpenFailed(r)}if(!this.active)throw new E.TransactionInactive;return $(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ge(function(a){jt(a),t._reject(e.error)}),e.onabort=ge(function(a){jt(a),t.active&&t._reject(new E.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=ge(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&it.storagemutated.fire(e.mutatedParts)}),this},We.prototype._promise=function(e,t,n){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return Se(new E.ReadOnly("Transaction is readonly"));if(!this.active)return Se(new E.TransactionInactive);if(this._locked())return new U(function(o,c){r._blockedFuncs.push([function(){r._promise(e,t,n).then(o,c)},H])});if(n)return nt(function(){var o=new U(function(c,d){r._lock();var m=t(c,d,r);m&&m.then&&m.then(c,d)});return o.finally(function(){return r._unlock()}),o._lib=!0,o});var a=new U(function(o,c){var d=t(o,c,r);d&&d.then&&d.then(o,c)});return a._lib=!0,a},We.prototype._root=function(){return this.parent?this.parent._root():this},We.prototype.waitFor=function(e){var t,n=this._root(),r=U.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=o)}());var a=n._waitingFor;return new U(function(o,c){r.then(function(d){return n._waitingQueue.push(ge(o.bind(null,d)))},function(d){return n._waitingQueue.push(ge(c.bind(null,d)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},We.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new E.Abort))},We.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(Y(t,e))return t[e];var n=this.schema[e];if(!n)throw new E.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},We);function We(){}function Gn(e,t,n,r,a,o,c,d){return{name:e,keyPath:t,unique:n,multi:r,auto:a,compound:o,src:(n&&!c?"&":"")+(r?"*":"")+(a?"++":"")+Wr(t),type:d}}function Wr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Wn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(a){return[a.name,a]},n.reduce(function(a,o,c){return c=r(o,c),c&&(a[c[0]]=c[1]),a},{}))};var r}var Ut=function(e){try{return e.only([[]]),Ut=function(){return[[]]},[[]]}catch{return Ut=function(){return mt},mt}};function Yn(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return fe(n,t)}:function(n){return fe(n,e)};var t}function Yr(e){return[].slice.call(e)}var Ha=0;function Gt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Xa(e,t,m){function r(w){if(w.type===3)return null;if(w.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=w.lower,g=w.upper,_=w.lowerOpen,w=w.upperOpen;return y===void 0?g===void 0?null:t.upperBound(g,!!w):g===void 0?t.lowerBound(y,!!_):t.bound(y,g,!!_,!!w)}function a(S){var y,g=S.name;return{name:g,schema:S,mutate:function(_){var w=_.trans,x=_.type,C=_.keys,A=_.values,N=_.range;return new Promise(function(L,q){L=ge(L);var B=w.objectStore(g),M=B.keyPath==null,V=x==="put"||x==="add";if(!V&&x!=="delete"&&x!=="deleteRange")throw new Error("Invalid operation type: "+x);var j,G=(C||A||{length:1}).length;if(C&&A&&C.length!==A.length)throw new Error("Given keys array must have same length as given values array.");if(G===0)return L({numFailures:0,failures:{},results:[],lastResult:void 0});function re(ke){++_e,jt(ke)}var le=[],te=[],_e=0;if(x==="deleteRange"){if(N.type===4)return L({numFailures:_e,failures:te,results:[],lastResult:void 0});N.type===3?le.push(j=B.clear()):le.push(j=B.delete(r(N)))}else{var M=V?M?[A,C]:[A,null]:[C,null],ee=M[0],Ne=M[1];if(V)for(var Ie=0;Ie<G;++Ie)le.push(j=Ne&&Ne[Ie]!==void 0?B[x](ee[Ie],Ne[Ie]):B[x](ee[Ie])),j.onerror=re;else for(Ie=0;Ie<G;++Ie)le.push(j=B[x](ee[Ie])),j.onerror=re}function xn(ke){ke=ke.target.result,le.forEach(function(bt,lr){return bt.error!=null&&(te[lr]=bt.error)}),L({numFailures:_e,failures:te,results:x==="delete"?C:le.map(function(bt){return bt.result}),lastResult:ke})}j.onerror=function(ke){re(ke),xn(ke)},j.onsuccess=xn})},getMany:function(_){var w=_.trans,x=_.keys;return new Promise(function(C,A){C=ge(C);for(var N,L=w.objectStore(g),q=x.length,B=new Array(q),M=0,V=0,j=function(le){le=le.target,B[le._pos]=le.result,++V===M&&C(B)},G=Ge(A),re=0;re<q;++re)x[re]!=null&&((N=L.get(x[re]))._pos=re,N.onsuccess=j,N.onerror=G,++M);M===0&&C(B)})},get:function(_){var w=_.trans,x=_.key;return new Promise(function(C,A){C=ge(C);var N=w.objectStore(g).get(x);N.onsuccess=function(L){return C(L.target.result)},N.onerror=Ge(A)})},query:(y=v,function(_){return new Promise(function(w,x){w=ge(w);var C,A,N,M=_.trans,L=_.values,q=_.limit,j=_.query,B=q===1/0?void 0:q,V=j.index,j=j.range,M=M.objectStore(g),V=V.isPrimaryKey?M:M.index(V.name),j=r(j);if(q===0)return w({result:[]});y?((B=L?V.getAll(j,B):V.getAllKeys(j,B)).onsuccess=function(G){return w({result:G.target.result})},B.onerror=Ge(x)):(C=0,A=!L&&"openKeyCursor"in V?V.openKeyCursor(j):V.openCursor(j),N=[],A.onsuccess=function(G){var re=A.result;return re?(N.push(L?re.value:re.primaryKey),++C===q?w({result:N}):void re.continue()):w({result:N})},A.onerror=Ge(x))})}),openCursor:function(_){var w=_.trans,x=_.values,C=_.query,A=_.reverse,N=_.unique;return new Promise(function(L,q){L=ge(L);var V=C.index,B=C.range,M=w.objectStore(g),M=V.isPrimaryKey?M:M.index(V.name),V=A?N?"prevunique":"prev":N?"nextunique":"next",j=!x&&"openKeyCursor"in M?M.openKeyCursor(r(B),V):M.openCursor(r(B),V);j.onerror=Ge(q),j.onsuccess=ge(function(G){var re,le,te,_e,ee=j.result;ee?(ee.___id=++Ha,ee.done=!1,re=ee.continue.bind(ee),le=(le=ee.continuePrimaryKey)&&le.bind(ee),te=ee.advance.bind(ee),_e=function(){throw new Error("Cursor not stopped")},ee.trans=w,ee.stop=ee.continue=ee.continuePrimaryKey=ee.advance=function(){throw new Error("Cursor not started")},ee.fail=ge(q),ee.next=function(){var Ne=this,Ie=1;return this.start(function(){return Ie--?Ne.continue():Ne.stop()}).then(function(){return Ne})},ee.start=function(Ne){function Ie(){if(j.result)try{Ne()}catch(ke){ee.fail(ke)}else ee.done=!0,ee.start=function(){throw new Error("Cursor behind last entry")},ee.stop()}var xn=new Promise(function(ke,bt){ke=ge(ke),j.onerror=Ge(bt),ee.fail=bt,ee.stop=function(lr){ee.stop=ee.continue=ee.continuePrimaryKey=ee.advance=_e,ke(lr)}});return j.onsuccess=ge(function(ke){j.onsuccess=Ie,Ie()}),ee.continue=re,ee.continuePrimaryKey=le,ee.advance=te,Ie(),xn},L(ee)):L(null)},q)})},count:function(_){var w=_.query,x=_.trans,C=w.index,A=w.range;return new Promise(function(N,L){var q=x.objectStore(g),B=C.isPrimaryKey?q:q.index(C.name),q=r(A),B=q?B.count(q):B.count();B.onsuccess=ge(function(M){return N(M.target.result)}),B.onerror=Ge(L)})}}}var o,c,d,b=(c=m,d=Yr((o=e).objectStoreNames),{schema:{name:o.name,tables:d.map(function(S){return c.objectStore(S)}).map(function(S){var y=S.keyPath,w=S.autoIncrement,g=O(y),_={},w={name:S.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y==null,compound:g,keyPath:y,autoIncrement:w,unique:!0,extractKey:Yn(y)},indexes:Yr(S.indexNames).map(function(x){return S.index(x)}).map(function(N){var C=N.name,A=N.unique,L=N.multiEntry,N=N.keyPath,L={name:C,compound:O(N),keyPath:N,unique:A,multiEntry:L,extractKey:Yn(N)};return _[Gt(N)]=L}),getIndexByKeyPath:function(x){return _[Gt(x)]}};return _[":id"]=w.primaryKey,y!=null&&(_[Gt(y)]=w.primaryKey),w})},hasGetAll:0<d.length&&"getAll"in c.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),m=b.schema,v=b.hasGetAll,b=m.tables.map(a),p={};return b.forEach(function(S){return p[S.name]=S}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(S){if(!p[S])throw new Error("Table '".concat(S,"' not found"));return p[S]},MIN_KEY:-1/0,MAX_KEY:Ut(t),schema:m}}function za(e,t,n,r){var a=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=Xa(t,a,r),e.dbcore.reduce(function(o,c){return c=c.create,f(f({},o),c(o))},r))}}function pn(e,r){var n=r.db,r=za(e._middlewares,n,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(a){var o=a.name;e.core.schema.tables.some(function(c){return c.name===o})&&(a.core=e.core.table(o),e[o]instanceof e.Table&&(e[o].core=a.core))})}function hn(e,t,n,r){n.forEach(function(a){var o=r[a];t.forEach(function(c){var d=function m(v,b){return X(v,b)||(v=z(v))&&m(v,b)}(c,a);(!d||"value"in d&&d.value===void 0)&&(c===e.Transaction.prototype||c instanceof e.Transaction?k(c,a,{get:function(){return this.table(a)},set:function(m){W(this,a,{value:m,writable:!0,configurable:!0,enumerable:!0})}}):c[a]=new e.Table(a,o))})})}function $n(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function Qa(e,t){return e._cfg.version-t._cfg.version}function Ja(e,t,n,r){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=Wn("$meta",Hr("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,a);o.create(n),o._completion.catch(r);var c=o._reject.bind(o),d=H.transless||H;nt(function(){return H.trans=o,H.transless=d,t!==0?(pn(e,n),v=t,((m=o).storeNames.includes("$meta")?m.table("$meta").get("version").then(function(b){return b??v}):U.resolve(v)).then(function(b){return S=b,y=o,g=n,_=[],b=(p=e)._versions,w=p._dbSchema=yn(0,p.idbdb,g),(b=b.filter(function(x){return x._cfg.version>=S})).length!==0?(b.forEach(function(x){_.push(function(){var C=w,A=x._cfg.dbschema;vn(p,C,g),vn(p,A,g),w=p._dbSchema=A;var N=Hn(C,A);N.add.forEach(function(V){Xn(g,V[0],V[1].primKey,V[1].indexes)}),N.change.forEach(function(V){if(V.recreate)throw new E.Upgrade("Not yet support for changing primary key");var j=g.objectStore(V.name);V.add.forEach(function(G){return mn(j,G)}),V.change.forEach(function(G){j.deleteIndex(G.name),mn(j,G)}),V.del.forEach(function(G){return j.deleteIndex(G)})});var L=x._cfg.contentUpgrade;if(L&&x._cfg.version>S){pn(p,g),y._memoizedTables={};var q=Ce(A);N.del.forEach(function(V){q[V]=C[V]}),$n(p,[p.Transaction.prototype]),hn(p,[p.Transaction.prototype],R(q),q),y.schema=q;var B,M=Ke(L);return M&&xt(),N=U.follow(function(){var V;(B=L(y))&&M&&(V=rt.bind(null,null),B.then(V,V))}),B&&typeof B.then=="function"?U.resolve(B):N.then(function(){return B})}}),_.push(function(C){var A,N,L=x._cfg.dbschema;A=L,N=C,[].slice.call(N.db.objectStoreNames).forEach(function(q){return A[q]==null&&N.db.deleteObjectStore(q)}),$n(p,[p.Transaction.prototype]),hn(p,[p.Transaction.prototype],p._storeNames,p._dbSchema),y.schema=p._dbSchema}),_.push(function(C){p.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(p.idbdb.version/10)===x._cfg.version?(p.idbdb.deleteObjectStore("$meta"),delete p._dbSchema.$meta,p._storeNames=p._storeNames.filter(function(A){return A!=="$meta"})):C.objectStore("$meta").put(x._cfg.version,"version"))})}),function x(){return _.length?U.resolve(_.shift()(y.idbtrans)).then(x):U.resolve()}().then(function(){$r(w,g)})):U.resolve();var p,S,y,g,_,w}).catch(c)):(R(a).forEach(function(b){Xn(n,b,a[b].primKey,a[b].indexes)}),pn(e,n),void U.follow(function(){return e.on.populate.fire(o)}).catch(c));var m,v})}function Za(e,t){$r(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=yn(0,e.idbdb,t);vn(e,e._dbSchema,t);for(var r=0,a=Hn(n,e._dbSchema).change;r<a.length;r++){var o=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var d=t.objectStore(c.name);c.add.forEach(function(m){Re&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(m.src)),mn(d,m)})}(a[r]);if(typeof o=="object")return o.value}}function Hn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var a=e[n],o=t[n];if(a){var c={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||a.primKey.auto!==o.primKey.auto)c.recreate=!0,r.change.push(c);else{var d=a.idxByName,m=o.idxByName,v=void 0;for(v in d)m[v]||c.del.push(v);for(v in m){var b=d[v],p=m[v];b?b.src!==p.src&&c.change.push(p):c.add.push(p)}(0<c.del.length||0<c.add.length||0<c.change.length)&&r.change.push(c)}}else r.add.push([n,o])}return r}function Xn(e,t,n,r){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(o){return mn(a,o)}),a}function $r(e,t){R(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(Re&&console.debug("Dexie: Creating missing table",n),Xn(t,n,e[n].primKey,e[n].indexes))})}function mn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function yn(e,t,n){var r={};return be(t.objectStoreNames,0).forEach(function(a){for(var o=n.objectStore(a),c=Gn(Wr(v=o.keyPath),v||"",!0,!1,!!o.autoIncrement,v&&typeof v!="string",!0),d=[],m=0;m<o.indexNames.length;++m){var b=o.index(o.indexNames[m]),v=b.keyPath,b=Gn(b.name,v,!!b.unique,!!b.multiEntry,!1,v&&typeof v!="string",!1);d.push(b)}r[a]=Wn(a,c,d)}),r}function vn(e,t,n){for(var r=n.db.objectStoreNames,a=0;a<r.length;++a){var o=r[a],c=n.objectStore(o);e._hasGetAll="getAll"in c;for(var d=0;d<c.indexNames.length;++d){var m=c.indexNames[d],v=c.index(m).keyPath,b=typeof v=="string"?v:"["+be(v).join("+")+"]";!t[o]||(v=t[o].idxByName[b])&&(v.name=m,delete t[o].idxByName[b],t[o].idxByName[m]=v)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&I.WorkerGlobalScope&&I instanceof I.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Hr(e){return e.split(",").map(function(t,n){var o=t.split(":"),r=(a=o[1])===null||a===void 0?void 0:a.trim(),a=(t=o[0].trim()).replace(/([&*]|\+\+)/g,""),o=/^\[/.test(a)?a.match(/^\[(.*)\]$/)[1].split("+"):a;return Gn(a,o||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),O(o),n===0,r)})}var eo=(Ct.prototype._createTableSchema=Wn,Ct.prototype._parseIndexSyntax=Hr,Ct.prototype._parseStoresSpec=function(e,t){var n=this;R(e).forEach(function(r){if(e[r]!==null){var a=n._parseIndexSyntax(e[r]),o=a.shift();if(!o)throw new E.Schema("Invalid schema for table "+r+": "+e[r]);if(o.unique=!0,o.multi)throw new E.Schema("Primary key cannot be multiEntry*");a.forEach(function(c){if(c.auto)throw new E.Schema("Only primary key can be marked as autoIncrement (++)");if(!c.keyPath)throw new E.Schema("Index must have a name and cannot be an empty string")}),a=n._createTableSchema(r,o,a),t[r]=a}})},Ct.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?K(this._cfg.storesSource,n):n;var n=t._versions,r={},a={};return n.forEach(function(o){K(r,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(r,a)}),t._dbSchema=a,$n(t,[t._allTables,t,t.Transaction.prototype]),hn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],R(a),a),t._storeNames=R(a),this},Ct.prototype.upgrade=function(e){return this._cfg.contentUpgrade=_t(this._cfg.contentUpgrade||Z,e),this},Ct);function Ct(){}function zn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new He(sn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Qn(e){return e&&typeof e.databases=="function"}function Jn(e){return nt(function(){return H.letThrough=!0,e()})}function Zn(e){return!("from"in e)}var Oe=function(e,t){if(!this){var n=new Oe;return e&&"d"in e&&K(n,e),n}K(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Wt(e,t,n){var r=ue(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(Zn(e))return K(e,{from:t,to:n,d:1});var a=e.l,r=e.r;if(ue(n,e.from)<0)return a?Wt(a,t,n):e.l={from:t,to:n,d:1,l:null,r:null},zr(e);if(0<ue(t,e.to))return r?Wt(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},zr(e);ue(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<ue(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,a&&!e.l&&Yt(e,a),r&&n&&Yt(e,r)}}function Yt(e,t){Zn(t)||function n(r,m){var o=m.from,c=m.to,d=m.l,m=m.r;Wt(r,o,c),d&&n(r,d),m&&n(r,m)}(e,t)}function Xr(e,t){var n=gn(t),r=n.next();if(r.done)return!1;for(var a=r.value,o=gn(e),c=o.next(a.from),d=c.value;!r.done&&!c.done;){if(ue(d.from,a.to)<=0&&0<=ue(d.to,a.from))return!0;ue(a.from,d.from)<0?a=(r=n.next(d.from)).value:d=(c=o.next(a.from)).value}return!1}function gn(e){var t=Zn(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&ue(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||ue(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function zr(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),a=1<r?"r":r<-1?"l":"";a&&(t=a=="r"?"l":"r",n=f({},e),r=e[a],e.from=r.from,e.to=r.to,e[a]=r[a],n[a]=r[t],(e[t]=n).d=Qr(n)),e.d=Qr(e)}function Qr(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function bn(e,t){return R(t).forEach(function(n){e[n]?Yt(e[n],t[n]):e[n]=function r(a){var o,c,d={};for(o in a)Y(a,o)&&(c=a[o],d[o]=!c||typeof c!="object"||Ve.has(c.constructor)?c:r(c));return d}(t[n])}),e}function er(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&Xr(t[n],e[n])})}ne(Oe.prototype,((Me={add:function(e){return Yt(this,e),this},addKey:function(e){return Wt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Wt(t,n,n)}),this},hasKey:function(e){var t=gn(this).next(e).value;return t&&ue(t.from,e)<=0&&0<=ue(t.to,e)}})[Ee]=function(){return gn(this)},Me));var vt={},tr={},nr=!1;function wn(e){bn(tr,e),nr||(nr=!0,setTimeout(function(){nr=!1,rr(tr,!(tr={}))},0))}function rr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,a=Object.values(vt);r<a.length;r++)Jr(c=a[r],e,n,t);else for(var o in e){var c,d=/^idb\:\/\/(.*)\/(.*)\//.exec(o);d&&(o=d[1],d=d[2],(c=vt["idb://".concat(o,"/").concat(d)])&&Jr(c,e,n,t))}n.forEach(function(m){return m()})}function Jr(e,t,n,r){for(var a=[],o=0,c=Object.entries(e.queries.query);o<c.length;o++){for(var d=c[o],m=d[0],v=[],b=0,p=d[1];b<p.length;b++){var S=p[b];er(t,S.obsSet)?S.subscribers.forEach(function(w){return n.add(w)}):r&&v.push(S)}r&&a.push([m,v])}if(r)for(var y=0,g=a;y<g.length;y++){var _=g[y],m=_[0],v=_[1];e.queries.query[m]=v}}function to(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Se(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,a=Math.round(10*e.verno),o=!1;function c(){if(t.openCanceller!==r)throw new E.DatabaseClosed("db.open() was cancelled")}function d(){return new U(function(S,y){if(c(),!n)throw new E.MissingAPI;var g=e.name,_=t.autoSchema||!a?n.open(g):n.open(g,a);if(!_)throw new E.MissingAPI;_.onerror=Ge(y),_.onblocked=ge(e._fireOnBlocked),_.onupgradeneeded=ge(function(w){var x;b=_.transaction,t.autoSchema&&!e._options.allowEmptyDB?(_.onerror=jt,b.abort(),_.result.close(),(x=n.deleteDatabase(g)).onsuccess=x.onerror=ge(function(){y(new E.NoSuchDatabase("Database ".concat(g," doesnt exist")))})):(b.onerror=Ge(y),w=w.oldVersion>Math.pow(2,62)?0:w.oldVersion,p=w<1,e.idbdb=_.result,o&&Za(e,b),Ja(e,w/10,b,y))},y),_.onsuccess=ge(function(){b=null;var w,x,C,A,N,L=e.idbdb=_.result,q=be(L.objectStoreNames);if(0<q.length)try{var B=L.transaction((A=q).length===1?A[0]:A,"readonly");if(t.autoSchema)x=L,C=B,(w=e).verno=x.version/10,C=w._dbSchema=yn(0,x,C),w._storeNames=be(x.objectStoreNames,0),hn(w,[w._allTables],R(C),C);else if(vn(e,e._dbSchema,B),((N=Hn(yn(0,(N=e).idbdb,B),N._dbSchema)).add.length||N.change.some(function(M){return M.add.length||M.change.length}))&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),L.close(),a=L.version+1,o=!0,S(d());pn(e,B)}catch{}Et.push(e),L.onversionchange=ge(function(M){t.vcFired=!0,e.on("versionchange").fire(M)}),L.onclose=ge(function(M){e.on("close").fire(M)}),p&&(N=e._deps,B=g,L=N.indexedDB,N=N.IDBKeyRange,Qn(L)||B===sn||zn(L,N).put({name:B}).catch(Z)),S()},y)}).catch(function(S){switch(S?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),d();break;case"VersionError":if(0<a)return a=0,d()}return U.reject(S)})}var m,v=t.dbReadyResolve,b=null,p=!1;return U.race([r,(typeof navigator>"u"?U.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(S){function y(){return indexedDB.databases().finally(S)}m=setInterval(y,100),y()}).finally(function(){return clearInterval(m)}):Promise.resolve()).then(d)]).then(function(){return c(),t.onReadyBeingFired=[],U.resolve(Jn(function(){return e.on.ready.fire(e.vip)})).then(function S(){if(0<t.onReadyBeingFired.length){var y=t.onReadyBeingFired.reduce(_t,Z);return t.onReadyBeingFired=[],U.resolve(Jn(function(){return y(e.vip)})).then(S)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(S){t.dbOpenError=S;try{b&&b.abort()}catch{}return r===t.openCanceller&&e._close(),Se(S)}).finally(function(){t.openComplete=!0,v()}).then(function(){var S;return p&&(S={},e.tables.forEach(function(y){y.schema.indexes.forEach(function(g){g.name&&(S["idb://".concat(e.name,"/").concat(y.name,"/").concat(g.name)]=new Oe(-1/0,[[[]]]))}),S["idb://".concat(e.name,"/").concat(y.name,"/")]=S["idb://".concat(e.name,"/").concat(y.name,"/:dels")]=new Oe(-1/0,[[[]]])}),it(Vt).fire(S),rr(S,!0)),e})}function ar(e){function t(o){return e.next(o)}var n=a(t),r=a(function(o){return e.throw(o)});function a(o){return function(m){var d=o(m),m=d.value;return d.done?m:m&&typeof m.then=="function"?m.then(n,r):O(m)?Promise.all(m).then(n,r):n(m)}}return a(t)()}function _n(e,t,n){for(var r=O(e)?e.slice():[e],a=0;a<n;++a)r.push(t);return r}var no={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return f(f({},e),{table:function(t){var n=e.table(t),r=n.schema,a={},o=[];function c(p,S,y){var g=Gt(p),_=a[g]=a[g]||[],w=p==null?0:typeof p=="string"?1:p.length,x=0<S,x=f(f({},y),{name:x?"".concat(g,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:x,keyTail:S,keyLength:w,extractKey:Yn(p),unique:!x&&y.unique});return _.push(x),x.isPrimaryKey||o.push(x),1<w&&c(w===2?p[0]:p.slice(0,w-1),S+1,y),_.sort(function(C,A){return C.keyTail-A.keyTail}),x}t=c(r.primaryKey.keyPath,0,r.primaryKey),a[":id"]=[t];for(var d=0,m=r.indexes;d<m.length;d++){var v=m[d];c(v.keyPath,0,v)}function b(p){var S,y=p.query.index;return y.isVirtual?f(f({},p),{query:{index:y.lowLevelIndex,range:(S=p.query.range,y=y.keyTail,{type:S.type===1?2:S.type,lower:_n(S.lower,S.lowerOpen?e.MAX_KEY:e.MIN_KEY,y),lowerOpen:!0,upper:_n(S.upper,S.upperOpen?e.MIN_KEY:e.MAX_KEY,y),upperOpen:!0})}}):p}return f(f({},n),{schema:f(f({},r),{primaryKey:t,indexes:o,getIndexByKeyPath:function(p){return(p=a[Gt(p)])&&p[0]}}),count:function(p){return n.count(b(p))},query:function(p){return n.query(b(p))},openCursor:function(p){var S=p.query.index,y=S.keyTail,g=S.isVirtual,_=S.keyLength;return g?n.openCursor(b(p)).then(function(x){return x&&w(x)}):n.openCursor(p);function w(x){return Object.create(x,{continue:{value:function(C){C!=null?x.continue(_n(C,p.reverse?e.MAX_KEY:e.MIN_KEY,y)):p.unique?x.continue(x.key.slice(0,_).concat(p.reverse?e.MIN_KEY:e.MAX_KEY,y)):x.continue()}},continuePrimaryKey:{value:function(C,A){x.continuePrimaryKey(_n(C,e.MAX_KEY,y),A)}},primaryKey:{get:function(){return x.primaryKey}},key:{get:function(){var C=x.key;return _===1?C[0]:C.slice(0,_)}},value:{get:function(){return x.value}}})}}})}})}};function or(e,t,n,r){return n=n||{},r=r||"",R(e).forEach(function(a){var o,c,d;Y(t,a)?(o=e[a],c=t[a],typeof o=="object"&&typeof c=="object"&&o&&c?(d=me(o))!==me(c)?n[r+a]=t[a]:d==="Object"?or(o,c,n,r+a+"."):o!==c&&(n[r+a]=t[a]):o!==c&&(n[r+a]=t[a])):n[r+a]=void 0}),R(t).forEach(function(a){Y(e,a)||(n[r+a]=t[a])}),n}function ir(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var ro={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return f(f({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return f(f({},n),{mutate:function(a){var o=H.trans,c=o.table(t).hook,d=c.deleting,m=c.creating,v=c.updating;switch(a.type){case"add":if(m.fire===Z)break;return o._promise("readwrite",function(){return b(a)},!0);case"put":if(m.fire===Z&&v.fire===Z)break;return o._promise("readwrite",function(){return b(a)},!0);case"delete":if(d.fire===Z)break;return o._promise("readwrite",function(){return b(a)},!0);case"deleteRange":if(d.fire===Z)break;return o._promise("readwrite",function(){return function p(S,y,g){return n.query({trans:S,values:!1,query:{index:r,range:y},limit:g}).then(function(_){var w=_.result;return b({type:"delete",keys:w,trans:S}).then(function(x){return 0<x.numFailures?Promise.reject(x.failures[0]):w.length<g?{failures:[],numFailures:0,lastResult:void 0}:p(S,f(f({},y),{lower:w[w.length-1],lowerOpen:!0}),g)})})}(a.trans,a.range,1e4)},!0)}return n.mutate(a);function b(p){var S,y,g,_=H.trans,w=p.keys||ir(r,p);if(!w)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?f(f({},p),{keys:w}):f({},p)).type!=="delete"&&(p.values=D([],p.values)),p.keys&&(p.keys=D([],p.keys)),S=n,g=w,((y=p).type==="add"?Promise.resolve([]):S.getMany({trans:y.trans,keys:g,cache:"immutable"})).then(function(x){var C=w.map(function(A,N){var L,q,B,M=x[N],V={onerror:null,onsuccess:null};return p.type==="delete"?d.fire.call(V,A,M,_):p.type==="add"||M===void 0?(L=m.fire.call(V,A,p.values[N],_),A==null&&L!=null&&(p.keys[N]=A=L,r.outbound||oe(p.values[N],r.keyPath,A))):(L=or(M,p.values[N]),(q=v.fire.call(V,L,A,M,_))&&(B=p.values[N],Object.keys(q).forEach(function(j){Y(B,j)?B[j]=q[j]:oe(B,j,q[j])}))),V});return n.mutate(p).then(function(A){for(var N=A.failures,L=A.results,q=A.numFailures,A=A.lastResult,B=0;B<w.length;++B){var M=(L||w)[B],V=C[B];M==null?V.onerror&&V.onerror(N[B]):V.onsuccess&&V.onsuccess(p.type==="put"&&x[B]?p.values[B]:M)}return{failures:N,results:L,numFailures:q,lastResult:A}}).catch(function(A){return C.forEach(function(N){return N.onerror&&N.onerror(A)}),Promise.reject(A)})})}}})}})}};function Zr(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],a=0,o=0;a<t.keys.length&&o<e.length;++a)ue(t.keys[a],e[o])===0&&(r.push(n?Fe(t.values[a]):t.values[a]),++o);return r.length===e.length?r:null}catch{return null}}var ao={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return f(f({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var a=Zr(r.keys,r.trans._cache,r.cache==="clone");return a?U.resolve(a):n.getMany(r).then(function(o){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Fe(o):o},o})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function ea(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function ta(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var oo={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new Oe(e.MIN_KEY,e.MAX_KEY);return f(f({},e),{transaction:function(r,a,o){if(H.subscr&&a!=="readonly")throw new E.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(H.querier));return e.transaction(r,a,o)},table:function(r){var a=e.table(r),o=a.schema,c=o.primaryKey,p=o.indexes,d=c.extractKey,m=c.outbound,v=c.autoIncrement&&p.filter(function(y){return y.compound&&y.keyPath.includes(c.keyPath)}),b=f(f({},a),{mutate:function(y){function g(j){return j="idb://".concat(t,"/").concat(r,"/").concat(j),A[j]||(A[j]=new Oe)}var _,w,x,C=y.trans,A=y.mutatedParts||(y.mutatedParts={}),N=g(""),L=g(":dels"),q=y.type,V=y.type==="deleteRange"?[y.range]:y.type==="delete"?[y.keys]:y.values.length<50?[ir(c,y).filter(function(j){return j}),y.values]:[],B=V[0],M=V[1],V=y.trans._cache;return O(B)?(N.addKeys(B),(V=q==="delete"||B.length===M.length?Zr(B,V):null)||L.addKeys(B),(V||M)&&(_=g,w=V,x=M,o.indexes.forEach(function(j){var G=_(j.name||"");function re(te){return te!=null?j.extractKey(te):null}function le(te){return j.multiEntry&&O(te)?te.forEach(function(_e){return G.addKey(_e)}):G.addKey(te)}(w||x).forEach(function(te,Ne){var ee=w&&re(w[Ne]),Ne=x&&re(x[Ne]);ue(ee,Ne)!==0&&(ee!=null&&le(ee),Ne!=null&&le(Ne))})}))):B?(M={from:(M=B.lower)!==null&&M!==void 0?M:e.MIN_KEY,to:(M=B.upper)!==null&&M!==void 0?M:e.MAX_KEY},L.add(M),N.add(M)):(N.add(n),L.add(n),o.indexes.forEach(function(j){return g(j.name).add(n)})),a.mutate(y).then(function(j){return!B||y.type!=="add"&&y.type!=="put"||(N.addKeys(j.results),v&&v.forEach(function(G){for(var re=y.values.map(function(ee){return G.extractKey(ee)}),le=G.keyPath.findIndex(function(ee){return ee===c.keyPath}),te=0,_e=j.results.length;te<_e;++te)re[te][le]=j.results[te];g(G.name).addKeys(re)})),C.mutatedParts=bn(C.mutatedParts||{},A),j})}}),p=function(g){var _=g.query,g=_.index,_=_.range;return[g,new Oe((g=_.lower)!==null&&g!==void 0?g:e.MIN_KEY,(_=_.upper)!==null&&_!==void 0?_:e.MAX_KEY)]},S={get:function(y){return[c,new Oe(y.key)]},getMany:function(y){return[c,new Oe().addKeys(y.keys)]},count:p,query:p,openCursor:p};return R(S).forEach(function(y){b[y]=function(g){var _=H.subscr,w=!!_,x=ea(H,a)&&ta(y,g)?g.obsSet={}:_;if(w){var C=function(M){return M="idb://".concat(t,"/").concat(r,"/").concat(M),x[M]||(x[M]=new Oe)},A=C(""),N=C(":dels"),_=S[y](g),w=_[0],_=_[1];if((y==="query"&&w.isPrimaryKey&&!g.values?N:C(w.name||"")).add(_),!w.isPrimaryKey){if(y!=="count"){var L=y==="query"&&m&&g.values&&a.query(f(f({},g),{values:!1}));return a[y].apply(this,arguments).then(function(M){if(y==="query"){if(m&&g.values)return L.then(function(re){return re=re.result,A.addKeys(re),M});var V=g.values?M.result.map(d):M.result;(g.values?A:N).addKeys(V)}else if(y==="openCursor"){var j=M,G=g.values;return j&&Object.create(j,{key:{get:function(){return N.addKey(j.primaryKey),j.key}},primaryKey:{get:function(){var re=j.primaryKey;return N.addKey(re),re}},value:{get:function(){return G&&A.addKey(j.primaryKey),j.value}}})}return M})}N.add(n)}}return a[y].apply(this,arguments)}}),b}})}};function na(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=f({},t),O(t.keys)&&(t.keys=t.keys.filter(function(a,o){return!(o in n.failures)})),"values"in t&&O(t.values)&&(t.values=t.values.filter(function(a,o){return!(o in n.failures)})),t)}function sr(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<ue(n,r.lower):0<=ue(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?ue(e,t.upper)<0:ue(e,t.upper)<=0));var n,r}function ra(e,t,S,r,a,o){if(!S||S.length===0)return e;var c=t.query.index,d=c.multiEntry,m=t.query.range,v=r.schema.primaryKey.extractKey,b=c.extractKey,p=(c.lowLevelIndex||c).extractKey,S=S.reduce(function(y,g){var _=y,w=[];if(g.type==="add"||g.type==="put")for(var x=new Oe,C=g.values.length-1;0<=C;--C){var A,N=g.values[C],L=v(N);x.hasKey(L)||(A=b(N),(d&&O(A)?A.some(function(j){return sr(j,m)}):sr(A,m))&&(x.addKey(L),w.push(N)))}switch(g.type){case"add":var q=new Oe().addKeys(t.values?y.map(function(G){return v(G)}):y),_=y.concat(t.values?w.filter(function(G){return G=v(G),!q.hasKey(G)&&(q.addKey(G),!0)}):w.map(function(G){return v(G)}).filter(function(G){return!q.hasKey(G)&&(q.addKey(G),!0)}));break;case"put":var B=new Oe().addKeys(g.values.map(function(G){return v(G)}));_=y.filter(function(G){return!B.hasKey(t.values?v(G):G)}).concat(t.values?w:w.map(function(G){return v(G)}));break;case"delete":var M=new Oe().addKeys(g.keys);_=y.filter(function(G){return!M.hasKey(t.values?v(G):G)});break;case"deleteRange":var V=g.range;_=y.filter(function(G){return!sr(v(G),V)})}return _},e);return S===e?e:(S.sort(function(y,g){return ue(p(y),p(g))||ue(v(y),v(g))}),t.limit&&t.limit<1/0&&(S.length>t.limit?S.length=t.limit:e.length===t.limit&&S.length<t.limit&&(a.dirty=!0)),o?Object.freeze(S):S)}function aa(e,t){return ue(e.lower,t.lower)===0&&ue(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function io(e,t){return function(n,r,a,o){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=ue(n,r))===0){if(a&&o)return 0;if(a)return 1;if(o)return-1}return r}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,r,a,o){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=ue(n,r))===0){if(a&&o)return 0;if(a)return-1;if(o)return 1}return r}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function so(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var a,o;e.subscribers.delete(n),e.subscribers.size===0&&(a=e,o=t,setTimeout(function(){a.subscribers.size===0&&Ye(o,a)},3e3))})}var uo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return f(f({},e),{transaction:function(n,r,a){var o,c,d=e.transaction(n,r,a);return r==="readwrite"&&(c=(o=new AbortController).signal,a=function(m){return function(){if(o.abort(),r==="readwrite"){for(var v=new Set,b=0,p=n;b<p.length;b++){var S=p[b],y=vt["idb://".concat(t,"/").concat(S)];if(y){var g=e.table(S),_=y.optimisticOps.filter(function(G){return G.trans===d});if(d._explicit&&m&&d.mutatedParts)for(var w=0,x=Object.values(y.queries.query);w<x.length;w++)for(var C=0,A=(q=x[w]).slice();C<A.length;C++)er((B=A[C]).obsSet,d.mutatedParts)&&(Ye(q,B),B.subscribers.forEach(function(G){return v.add(G)}));else if(0<_.length){y.optimisticOps=y.optimisticOps.filter(function(G){return G.trans!==d});for(var N=0,L=Object.values(y.queries.query);N<L.length;N++)for(var q,B,M,V=0,j=(q=L[N]).slice();V<j.length;V++)(B=j[V]).res!=null&&d.mutatedParts&&(m&&!B.dirty?(M=Object.isFrozen(B.res),M=ra(B.res,B.req,_,g,B,M),B.dirty?(Ye(q,B),B.subscribers.forEach(function(G){return v.add(G)})):M!==B.res&&(B.res=M,B.promise=U.resolve({result:M}))):(B.dirty&&Ye(q,B),B.subscribers.forEach(function(G){return v.add(G)})))}}}v.forEach(function(G){return G()})}}},d.addEventListener("abort",a(!1),{signal:c}),d.addEventListener("error",a(!1),{signal:c}),d.addEventListener("complete",a(!0),{signal:c})),d},table:function(n){var r=e.table(n),a=r.schema.primaryKey;return f(f({},r),{mutate:function(o){var c=H.trans;if(a.outbound||c.db._options.cache==="disabled"||c.explicit||c.idbtrans.mode!=="readwrite")return r.mutate(o);var d=vt["idb://".concat(t,"/").concat(n)];return d?(c=r.mutate(o),o.type!=="add"&&o.type!=="put"||!(50<=o.values.length||ir(a,o).some(function(m){return m==null}))?(d.optimisticOps.push(o),o.mutatedParts&&wn(o.mutatedParts),c.then(function(m){0<m.numFailures&&(Ye(d.optimisticOps,o),(m=na(0,o,m))&&d.optimisticOps.push(m),o.mutatedParts&&wn(o.mutatedParts))}),c.catch(function(){Ye(d.optimisticOps,o),o.mutatedParts&&wn(o.mutatedParts)})):c.then(function(m){var v=na(0,f(f({},o),{values:o.values.map(function(b,p){var S;return m.failures[p]||(b=(S=a.keyPath)!==null&&S!==void 0&&S.includes(".")?Fe(b):f({},b),oe(b,a.keyPath,m.results[p])),b})}),m);d.optimisticOps.push(v),queueMicrotask(function(){return o.mutatedParts&&wn(o.mutatedParts)})}),c):r.mutate(o)},query:function(o){if(!ea(H,r)||!ta("query",o))return r.query(o);var c=((v=H.trans)===null||v===void 0?void 0:v.db._options.cache)==="immutable",p=H,d=p.requery,m=p.signal,v=function(g,_,w,x){var C=vt["idb://".concat(g,"/").concat(_)];if(!C)return[];if(!(_=C.queries[w]))return[null,!1,C,null];var A=_[(x.query?x.query.index.name:null)||""];if(!A)return[null,!1,C,null];switch(w){case"query":var N=A.find(function(L){return L.req.limit===x.limit&&L.req.values===x.values&&aa(L.req.query.range,x.query.range)});return N?[N,!0,C,A]:[A.find(function(L){return("limit"in L.req?L.req.limit:1/0)>=x.limit&&(!x.values||L.req.values)&&io(L.req.query.range,x.query.range)}),!1,C,A];case"count":return N=A.find(function(L){return aa(L.req.query.range,x.query.range)}),[N,!!N,C,A]}}(t,n,"query",o),b=v[0],p=v[1],S=v[2],y=v[3];return b&&p?b.obsSet=o.obsSet:(p=r.query(o).then(function(g){var _=g.result;if(b&&(b.res=_),c){for(var w=0,x=_.length;w<x;++w)Object.freeze(_[w]);Object.freeze(_)}else g.result=Fe(_);return g}).catch(function(g){return y&&b&&Ye(y,b),Promise.reject(g)}),b={obsSet:o.obsSet,promise:p,subscribers:new Set,type:"query",req:o,dirty:!1},y?y.push(b):(y=[b],(S=S||(vt["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[o.query.index.name||""]=y)),so(b,y,d,m),b.promise.then(function(g){return{result:ra(g.result,o,S?.optimisticOps,r,b,c)}})}})}})}};function Sn(e,t){return new Proxy(e,{get:function(n,r,a){return r==="db"?t:Reflect.get(n,r,a)}})}var He=(Te.prototype.version=function(e){if(isNaN(e)||e<.1)throw new E.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new E.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Qa),n.stores({}),this._state.autoSchema=!1,n)},Te.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||H.letThrough||this._vip)?e():new U(function(n,r){if(t._state.openComplete)return r(new E.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new E.DatabaseClosed);t.open().catch(Z)}t._state.dbReadyPromise.then(n,r)}).then(e)},Te.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:a}),e.sort(function(o,c){return o.level-c.level}),this},Te.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return r?a.create!==r:!!n&&a.name!==n})),this},Te.prototype.open=function(){var e=this;return ht(tt,function(){return to(e)})},Te.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=Et.indexOf(this);if(0<=t&&Et.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new U(function(n){e.dbReadyResolve=n}),e.openCanceller=new U(function(n,r){e.cancelOpen=r}))},Te.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new E.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new E.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},Te.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new U(function(a,o){function c(){t.close(e);var d=t._deps.indexedDB.deleteDatabase(t.name);d.onsuccess=ge(function(){var m,v,b;m=t._deps,v=t.name,b=m.indexedDB,m=m.IDBKeyRange,Qn(b)||v===sn||zn(b,m).delete(v).catch(Z),a()}),d.onerror=Ge(o),d.onblocked=t._fireOnBlocked}if(n)throw new E.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(c):c()})},Te.prototype.backendDB=function(){return this.idbdb},Te.prototype.isOpen=function(){return this.idbdb!==null},Te.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Te.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Te.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Te.prototype,"tables",{get:function(){var e=this;return R(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Te.prototype.transaction=function(){var e=(function(t,n,r){var a=arguments.length;if(a<2)throw new E.InvalidArgument("Too few arguments");for(var o=new Array(a-1);--a;)o[a-1]=arguments[a];return r=o.pop(),[t,ut(o),r]}).apply(this,arguments);return this._transaction.apply(this,e)},Te.prototype._transaction=function(e,t,n){var r=this,a=H.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var o,c,d=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(c=t.map(function(v){if(v=v instanceof r.Table?v.name:v,typeof v!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return v}),e=="r"||e===Kn)o=Kn;else{if(e!="rw"&&e!=qn)throw new E.InvalidArgument("Invalid transaction mode: "+e);o=qn}if(a){if(a.mode===Kn&&o===qn){if(!d)throw new E.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&c.forEach(function(v){if(a&&a.storeNames.indexOf(v)===-1){if(!d)throw new E.SubTransaction("Table "+v+" not included in parent transaction.");a=null}}),d&&a&&!a.active&&(a=null)}}catch(v){return a?a._promise(null,function(b,p){p(v)}):Se(v)}var m=(function v(b,p,S,y,g){return U.resolve().then(function(){var _=H.transless||H,w=b._createTransaction(p,S,b._dbSchema,y);if(w.explicit=!0,_={trans:w,transless:_},y)w.idbtrans=y.idbtrans;else try{w.create(),w.idbtrans._explicit=!0,b._state.PR1398_maxLoop=3}catch(A){return A.name===u.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return v(b,p,S,null,g)})):Se(A)}var x,C=Ke(g);return C&&xt(),_=U.follow(function(){var A;(x=g.call(w,w))&&(C?(A=rt.bind(null,null),x.then(A,A)):typeof x.next=="function"&&typeof x.throw=="function"&&(x=ar(x)))},_),(x&&typeof x.then=="function"?U.resolve(x).then(function(A){return w.active?A:Se(new E.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):_.then(function(){return x})).then(function(A){return y&&w._resolve(),w._completion.then(function(){return A})}).catch(function(A){return w._reject(A),Se(A)})})}).bind(null,this,o,c,a,n);return a?a._promise(o,m,"lock"):H.trans?ht(H.transless,function(){return r._whenReady(m)}):this._whenReady(m)},Te.prototype.table=function(e){if(!Y(this._allTables,e))throw new E.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Te);function Te(e,t){var n=this;this._middlewares={},this.verno=0;var r=Te.dependencies;this._options=t=f({addons:Te.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},r=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,o,c,d,m,v={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Z,dbReadyPromise:null,cancelOpen:Z,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};v.dbReadyPromise=new U(function(p){v.dbReadyResolve=p}),v.openCanceller=new U(function(p,S){v.cancelOpen=S}),this._state=v,this.name=e,this.on=Mt(this,"populate","blocked","versionchange","close",{ready:[_t,Z]}),this.once=function(p,S){var y=function(){for(var g=[],_=0;_<arguments.length;_++)g[_]=arguments[_];n.on(p).unsubscribe(y),S.apply(n,g)};return n.on(p,y)},this.on.ready.subscribe=J(this.on.ready.subscribe,function(p){return function(S,y){Te.vip(function(){var g,_=n._state;_.openComplete?(_.dbOpenError||U.resolve().then(S),y&&p(S)):_.onReadyBeingFired?(_.onReadyBeingFired.push(S),y&&p(S)):(p(S),g=n,y||p(function w(){g.on.ready.unsubscribe(S),g.on.ready.unsubscribe(w)}))})}}),this.Collection=(a=this,Kt(Ga.prototype,function(x,w){this.db=a;var y=kr,g=null;if(w)try{y=w()}catch(C){g=C}var _=x._ctx,w=_.table,x=w.hook.reading.fire;this._ctx={table:w,index:_.index,isPrimKey:!_.index||w.schema.primKey.keyPath&&_.index===w.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:g,or:_.or,valueMapper:x!==ye?x:null}})),this.Table=(o=this,Kt(Mr.prototype,function(p,S,y){this.db=o,this._tx=y,this.name=p,this.schema=S,this.hook=o._allTables[p]?o._allTables[p].hook:Mt(null,{creating:[et,Z],reading:[Ae,ye],updating:[qe,Z],deleting:[xe,Z]})})),this.Transaction=(c=this,Kt($a.prototype,function(p,S,y,g,_){var w=this;p!=="readonly"&&S.forEach(function(x){x=(x=y[x])===null||x===void 0?void 0:x.yProps,x&&(S=S.concat(x.map(function(C){return C.updatesTable})))}),this.db=c,this.mode=p,this.storeNames=S,this.schema=y,this.chromeTransactionDurability=g,this.idbtrans=null,this.on=Mt(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new U(function(x,C){w._resolve=x,w._reject=C}),this._completion.then(function(){w.active=!1,w.on.complete.fire()},function(x){var C=w.active;return w.active=!1,w.on.error.fire(x),w.parent?w.parent._reject(x):C&&w.idbtrans&&w.idbtrans.abort(),Se(x)})})),this.Version=(d=this,Kt(eo.prototype,function(p){this.db=d,this._cfg={version:p,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(m=this,Kt(Gr.prototype,function(p,S,y){if(this.db=m,this._ctx={table:p,index:S===":id"?null:S,or:y},this._cmp=this._ascending=ue,this._descending=function(g,_){return ue(_,g)},this._max=function(g,_){return 0<ue(g,_)?g:_},this._min=function(g,_){return ue(g,_)<0?g:_},this._IDBKeyRange=m._deps.IDBKeyRange,!this._IDBKeyRange)throw new E.MissingAPI})),this.on("versionchange",function(p){0<p.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(p){!p.newVersion||p.newVersion<p.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(p.oldVersion/10))}),this._maxKey=Ut(t.IDBKeyRange),this._createTransaction=function(p,S,y,g){return new n.Transaction(p,S,y,n._options.chromeTransactionDurability,g)},this._fireOnBlocked=function(p){n.on("blocked").fire(p),Et.filter(function(S){return S.name===n.name&&S!==n&&!S._state.vcFired}).map(function(S){return S.on("versionchange").fire(p)})},this.use(ao),this.use(uo),this.use(oo),this.use(no),this.use(ro);var b=new Proxy(this,{get:function(p,S,y){if(S==="_vip")return!0;if(S==="table")return function(_){return Sn(n.table(_),b)};var g=Reflect.get(p,S,y);return g instanceof Mr?Sn(g,b):S==="tables"?g.map(function(_){return Sn(_,b)}):S==="_createTransaction"?function(){return Sn(g.apply(this,arguments),b)}:g}});this.vip=b,r.forEach(function(p){return p(n)})}var Tn,Me=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",co=(ur.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},ur.prototype[Me]=function(){return this},ur);function ur(e){this._subscribe=e}try{Tn={indexedDB:I.indexedDB||I.mozIndexedDB||I.webkitIndexedDB||I.msIndexedDB,IDBKeyRange:I.IDBKeyRange||I.webkitIDBKeyRange}}catch{Tn={indexedDB:null,IDBKeyRange:null}}function oa(e){var t,n=!1,r=new co(function(a){var o=Ke(e),c,d=!1,m={},v={},b={get closed(){return d},unsubscribe:function(){d||(d=!0,c&&c.abort(),p&&it.storagemutated.unsubscribe(y))}};a.start&&a.start(b);var p=!1,S=function(){return Mn(g)},y=function(_){bn(m,_),er(v,m)&&S()},g=function(){var _,w,x;!d&&Tn.indexedDB&&(m={},_={},c&&c.abort(),c=new AbortController,x=function(C){var A=St();try{o&&xt();var N=nt(e,C);return N=o?N.finally(rt):N}finally{A&&Tt()}}(w={subscr:_,signal:c.signal,requery:S,querier:e,trans:null}),Promise.resolve(x).then(function(C){n=!0,t=C,d||w.signal.aborted||(m={},function(A){for(var N in A)if(Y(A,N))return;return 1}(v=_)||p||(it(Vt,y),p=!0),Mn(function(){return!d&&a.next&&a.next(C)}))},function(C){n=!1,["DatabaseClosedError","AbortError"].includes(C?.name)||d||Mn(function(){d||a.error&&a.error(C)})}))};return setTimeout(S,0),b});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var gt=He;function cr(e){var t=st;try{st=!0,it.storagemutated.fire(e),rr(e,!0)}finally{st=t}}ne(gt,f(f({},ce),{delete:function(e){return new gt(e,{addons:[]}).delete()},exists:function(e){return new gt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=gt.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(Qn(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(a){return a.name}).filter(function(a){return a!==sn})}):zn(n,t).toCollection().primaryKeys()).then(e)}catch{return Se(new E.MissingAPI)}var t,n},defineClass:function(){return function(e){K(this,e)}},ignoreTransaction:function(e){return H.trans?ht(H.transless,e):e()},vip:Jn,async:function(e){return function(){try{var t=ar(e.apply(this,arguments));return t&&typeof t.then=="function"?t:U.resolve(t)}catch(n){return Se(n)}}},spawn:function(e,t,n){try{var r=ar(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:U.resolve(r)}catch(a){return Se(a)}},currentTransaction:{get:function(){return H.trans||null}},waitFor:function(e,t){return t=U.resolve(typeof e=="function"?gt.ignoreTransaction(e):e).timeout(t||6e4),H.trans?H.trans.waitFor(t):t},Promise:U,debug:{get:function(){return Re},set:function(e){Ft(e)}},derive:F,extend:K,props:ne,override:J,Events:Mt,on:it,liveQuery:oa,extendObservabilitySet:bn,getByKeyPath:fe,setByKeyPath:oe,delByKeyPath:function(e,t){typeof t=="string"?oe(e,t,void 0):"length"in t&&[].map.call(t,function(n){oe(e,n,void 0)})},shallowClone:Ce,deepClone:Fe,getObjectDiff:or,cmp:ue,asap:ie,minKey:-1/0,addons:[],connections:Et,errnames:u,dependencies:Tn,cache:vt,semVer:"4.2.0",version:"4.2.0".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),gt.maxKey=Ut(gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(it(Vt,function(e){st||(e=new CustomEvent(Un,{detail:e}),st=!0,dispatchEvent(e),st=!1)}),addEventListener(Un,function(e){e=e.detail,st||cr(e)}));var $t,st=!1,ia=function(){};return typeof BroadcastChannel<"u"&&((ia=function(){($t=new BroadcastChannel(Un)).onmessage=function(e){return e.data&&cr(e.data)}})(),typeof $t.unref=="function"&&$t.unref(),it(Vt,function(e){st||$t.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!He.disableBfCache&&e.persisted){Re&&console.debug("Dexie: handling persisted pagehide"),$t?.close();for(var t=0,n=Et;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!He.disableBfCache&&e.persisted&&(Re&&console.debug("Dexie: handling persisted pageshow"),ia(),cr({all:new Oe(-1/0,[[]])}))})),U.rejectionMapper=function(e,t){return!e||e instanceof Je||e instanceof TypeError||e instanceof SyntaxError||!e.name||!T[e.name]?e:(t=new T[e.name](t||e.message,e),"stack"in e&&k(t,"stack",{get:function(){return this.inner.stack}}),t)},Ft(Re),f(He,Object.freeze({__proto__:null,Dexie:He,liveQuery:oa,Entity:Rr,cmp:ue,PropModification:qt,replacePrefix:function(e,t){return new qt({replacePrefix:[e,t]})},add:function(e){return new qt({add:e})},remove:function(e){return new qt({remove:e})},default:He,RangeSet:Oe,mergeRanges:Yt,rangesOverlap:Xr}),{default:He}),He})}(wr)),wr.exports}var Ci=Di();const _r=Fa(Ci),va=Symbol.for("Dexie"),wt=globalThis[va]||(globalThis[va]=_r);if(_r.semVer!==wt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${_r.semVer} and ${wt.semVer}`);const{liveQuery:cs,mergeRanges:ls,rangesOverlap:fs,RangeSet:ds,cmp:ps,Entity:hs,PropModification:ms,replacePrefix:ys,add:vs,remove:gs,DexieYProvider:bs}=wt;class Ai extends wt{constructor(...l){super(...l),this.upgrade()}async upgrade(){if(this.isOpen()){this.close(),ga(this),await this.open();return}ga(this)}}function ga(s){return s.version(1).stores({[At]:pr}),s.version(2).stores({[At]:pr,[hr]:ma}),s.version(2.1).stores({[At]:pr,[hr]:ma}).upgrade(l=>{l.table(hr).toCollection().modify(h=>{typeof h.file=="string"&&(h.file=new Blob([h.file],{type:"text/xml"}))})}),s}async function Oi(s){const{databaseInstance:l,records:h}=s,f=l.table(At);await l.transaction("rw",f,()=>f.bulkAdd(h))}async function Ni(s){if(await wt.exists(s))return await wt.delete(s)}const Ii={useBrowserApi:!0,chunkSize:32*1024,batchSize:2e3};async function mr({files:s,options:l=Ii}){const h=[];if(s.length===0)throw new Error("No files provided for import.");for(const f of s){if(!Fi(f)){console.error(`Unsupported file type: ${f.name}`);continue}f.size===0&&console.warn(`File is empty: ${f.name}`);const D=await Ri({file:f,options:l});h.push(D)}return h}function Fi(s){return hi.some(l=>s.name.toLowerCase().endsWith(l))}function ki(s){return s.name.replace(/\.[^.]+$/,"")}async function Ri(s){const{file:l,options:h}=s;try{const f=ki(l);await Ni(f);const D=new Ai(f);return h.useBrowserApi&&l.size!==0&&await Li({file:l,databaseInstance:D,options:{chunkSize:h.chunkSize,batchSize:h.batchSize}}),f}catch(f){throw console.error(`Error importing file ${l.name}:`,f),f}}async function Li(s){const{file:l,databaseInstance:h,options:f}=s,D=l.stream().getReader(),I=yi(),R=new TextDecoder,O=new Uint8Array(0);return await Sr({databaseInstance:h,reader:D,sax:I,textDecoder:R,buffer:O,options:f})}async function Sr(s){const{databaseInstance:l,reader:h,sax:f,textDecoder:D,buffer:I,options:R}=s,{chunkSize:O,batchSize:K}=R,{done:z,value:Q}=await h.read();if(z){if(I.length>0){const ne=D.decode(I);f.parser.write(ne)}return f.parser.close(),await ba({databaseInstance:l,sax:f,batchSize:0})}if(!Q)return await Sr(s);let Y=new Uint8Array(I.length+Q.length);for(Y.set(I),Y.set(Q,I.length);Y.length>=O;){const ne=Y.slice(0,O);Y=Y.slice(O);const W=D.decode(ne,{stream:!0});f.parser.write(W),await ba({databaseInstance:l,sax:f,batchSize:K})}return await Sr({...s,buffer:Y})}async function ba(s){const{databaseInstance:l,sax:h,batchSize:f}=s;if(h.getSize()>=f){const D=h.drainBatch(),I=fi({currentBatch:D});await Oi({databaseInstance:l,records:I})}}const Bi="_temp-idb-id",Mi={AccessControl:[],AccessPoint:["Text","Private","Server","LN","ServerAt","Services","GOOSESecurity","SMVSecurity","Labels"],Address:["P"],AllocationRole:["Text","FunctionRef"],AllocationRoleRef:["Text","FunctionalVariantRef"],AnalogueWiringParameters:["Text"],AnalogueWiringParametersRef:["Text"],Application:["Text","FunctionRole","FunctionalVariant","FunctionalVariantGroup","AllocationRoleRef","ApplicationSclRef"],ApplicationSclRef:["Text","SclFileReference"],Association:[],Authentication:[],BDA:["Text","Private","Val","Labels"],Bay:["Text","Private","Labels","LNode","PowerTransformer","GeneralEquipment","ConductingEquipment","ConnectivityNode","Function"],BayType:[],BehaviorDescription:["Text","InputVar","OutputVar","BehaviorReference"],BehaviorDescriptionRef:["Text","FunctionalVariantRef","InputVarRef","OutputVarRef"],BehaviorReference:["Text"],BinaryWiringParameters:["Text"],BinaryWiringParametersRef:["Text"],BitRate:[],CheckoutID:["SubCheckoutID"],ClientLN:[],ClientServices:["TimeSyncProt","GOOSEMcSecurity","SVMcSecurity","Security"],CommProt:[],Communication:["Text","Private","SubNetwork"],CommunicationServiceSpecifications:["Text","GooseParameters","SMVParameters","ReportParameters"],ConductingEquipment:["Text","Private","Labels","LNode","Terminal","SubEquipment","EqFunction"],ConfDataSet:[],ConfLNs:[],ConfLdName:[],ConfLogControl:[],ConfReportControl:[],ConfSG:[],ConfSigRef:[],ConnectedAP:["Text","Private","Address","GSE","SMV","PhysConn"],ConnectivityNode:["Text","Private","Labels","LNode"],ControlRef:["Text","BinaryWiringParametersRef","AnalogueWiringParametersRef"],ControllingLNode:["Text","BinaryWiringParametersRef","AnalogueWiringParametersRef"],DA:["Text","Private","Val","Labels","ProtNs"],DAI:["Text","Private","Val","Labels"],DAS:["Text","SubscriberLNode","ControllingLNode","ProcessEcho","LogParametersRef","Val","Labels"],DAType:["Text","Private","BDA","ProtNs","Labels"],DO:["Text","Private","Labels"],DOI:["Text","Private","SDI","DAI","Labels"],DOS:["Text","SDS","DAS","SubscriberLNode","ControllingLNode","ProcessEcho","LogParametersRef","Labels"],DOType:["Text","Private","SDO","DA","Labels"],DataObjectDirectory:[],DataSet:["Text","Private","FCDA"],DataSetDirectory:[],DataTypeTemplates:["LNodeType","DOType","DAType","EnumType"],DynAssociation:[],DynDataSet:[],EnumType:["Text","Private","EnumVal"],EnumVal:[],EqFunction:["Text","Private","Labels","LNode","GeneralEquipment","EqSubFunction"],EqSubFunction:["Text","Private","Labels","LNode","GeneralEquipment","EqSubFunction"],ExtCtrl:["Text","Private"],ExtRef:["Text","Private"],FCDA:[],FileHandling:[],Function:["Text","Private","Labels","LNode","SubFunction","GeneralEquipment","ConductingEquipment"],FunctionCatRef:["Text"],FunctionCategory:["Text","SubCategory","FunctionCatRef"],FunctionCategoryRef:["Text","FunctionalVariantRef"],FunctionRef:["Text","FunctionalVariantRef","SignalRole"],FunctionRole:["Text","FunctionalVariantRef","FunctionRoleContent"],FunctionRoleContent:["Text","FunctionRef","BehaviorDescriptionRef","ProcessResourceRef","VariableRef","FunctionCategoryRef","PowerSystemRelationRef"],FunctionSclRef:["Text","SclFileReference"],FunctionTemplate:["Text","LNode","SubFunctionTemplate","GeneralEquipment","ConductingEquipment"],FunctionalSubVariant:["Text","FunctionalSubVariant","VariableRef"],FunctionalVariant:["Text","FunctionalSubVariant","VariableRef"],FunctionalVariantGroup:["Text","FunctionalVariant"],FunctionalVariantRef:["Text"],GOOSE:[],GOOSEMcSecurity:[],GOOSESecurity:["Text","Private","Labels","Subject","IssuerName"],GSE:["Text","Private","Address","MinTime","MaxTime"],GSEControl:["Text","Private","IEDName","Protocol"],GSEDir:[],GSESettings:["McSecurity"],GSSE:[],GeneralEquipment:["Text","Private","Labels","LNode","EqFunction"],GetCBValues:[],GetDataObjectDefinition:[],GetDataSetValue:[],GetDirectory:[],GooseParameters:["Text","L2CommParameters","L3IPv4CommParameters","L3IPv6CommParameters"],GooseParametersRef:["Text"],Header:["Text","History","SourceFiles"],History:["Hitem"],Hitem:["SourceFiles"],IED:["Text","Private","Services","AccessPoint","KDC","IEDSourceFiles","MinRequestedSCDFiles","Labels"],IEDName:[],IEDSourceFiles:["Text","Private","SclFileReference"],InputVar:["Text"],InputVarRef:["Text","FunctionalVariantRef"],Inputs:["Text","Private","ExtRef"],IssuerName:[],KDC:[],L2CommParameters:["Text"],L3IPv4CommParameters:["Text"],L3IPv6CommParameters:["Text"],LDevice:["Text","Private","LN0","LN","AccessControl","Labels"],LN:["Text","Private","DataSet","ReportControl","LogControl","DOI","Inputs","Outputs","Log","Labels"],LN0:["Text","Private","DataSet","ReportControl","LogControl","DOI","Inputs","Outputs","Log","Labels","GSEControl","SampledValueControl","SettingControl"],LNode:["Text","Private","Labels"],LNodeDataRef:["Text","FunctionalVariantRef"],LNodeInputRef:["Text","FunctionalVariantRef"],LNodeInputs:["Text","SourceRef"],LNodeOutputRef:["Text","FunctionalVariantRef"],LNodeOutputs:["Text","ControlRef"],LNodeSpecNaming:["Text"],LNodeType:["Text","Private","DO","Labels"],Label:[],Labels:["Text","Private","Label"],Line:["Text","Private","Labels","LNode","GeneralEquipment","Function","Voltage","ConductingEquipment","ConnectivityNode"],Log:["Text","Private"],LogControl:["Text","Private","TrgOps"],LogParameters:["Text"],LogParametersRef:["Text"],LogSettings:[],MaxTime:[],McSecurity:[],MinRequestedSCDFile:[],MinRequestedSCDFiles:["Text","Private","MinRequestedSCDFile"],MinTime:[],MultiAPPerSubNet:[],NeutralPoint:["Text","Private"],OptFields:[],OutputVar:["Text"],OutputVarRef:["Text","FunctionalVariantRef"],Outputs:["Text","Private","ExtCtrl"],P:[],PhysConn:["Text","Private","P"],PowerSystemRelation:["Text"],PowerSystemRelationRef:["Text","FunctionalVariantRef"],PowerSystemRelations:["Text","PowerSystemRelation"],PowerTransformer:["Text","Private","Labels","LNode","TransformerWinding","SubEquipment","EqFunction"],Private:[],Process:["Text","Private","Labels","LNode","GeneralEquipment","Function","ConductingEquipment","Substation","Line","Process"],ProcessEcho:["Text"],ProcessResource:["Text","Resource"],ProcessResourceRef:["Text","FunctionalVariantRef"],ProcessResources:["Text","ProcessResource"],Project:["Text","ProjectProcessReference"],ProjectProcessReference:["Text"],ProtNs:[],Protocol:[],ReadWrite:[],RedProt:[],ReportControl:["Text","Private","TrgOps","OptFields","RptEnabled"],ReportParameters:["Text"],ReportParametersRef:["Text"],ReportSettings:[],Resource:[],RptEnabled:["Text","Private","ClientLN"],SCL:["Text","Private","Header","Substation","Communication","IED","DataTypeTemplates","Line","Process"],SCSM:[],SDI:["Text","Private","SDI","DAI","Labels"],SDO:["Text","Private","Labels"],SDS:["Text","SDS","DAS","SubscriberLNode","ControllingLNode","ProcessEcho","LogParametersRef","Labels"],SGEdit:[],SMV:["Text","Private","Address"],SMVParameters:["Text","L2CommParameters","L3IPv4CommParameters","L3IPv6CommParameters"],SMVParametersRef:["Text"],SMVSecurity:["Text","Private","Labels","Subject","IssuerName"],SMVSettings:["SmpRate","SamplesPerSec","SecPerSamples","McSecurity"],SMVsc:[],SVMcSecurity:[],SampledValueControl:["Text","Private","IEDName","SmvOpts","Protocol"],SamplesPerSec:[],SclFileReference:["Text","Private"],SecPerSamples:[],Security:[],Server:["Text","Private","Authentication","LDevice","Association"],ServerAt:["Text","Private"],ServiceSpecifications:["Text","GooseParameters","SMVParameters","ReportParameters","BinaryWiringParameters","AnalogueWiringParameters","LogParameters"],Services:["DynAssociation","SettingGroups","GetDirectory","GetDataObjectDefinition","DataObjectDirectory","GetDataSetValue","SetDataSetValue","DataSetDirectory","ConfDataSet","DynDataSet","ReadWrite","TimerActivatedControl","ConfReportControl","GetCBValues","ConfLogControl","ReportSettings","LogSettings","GSESettings","SMVSettings","GSEDir","GOOSE","GSSE","SMVsc","FileHandling","ConfLNs","ClientServices","ConfLdName","SupSubscription","ConfSigRef","ValueHandling","RedProt","TimeSyncProt","CommProt","SCSM","Security","MultiAPPerSubNet"],SetDataSetValue:[],SettingControl:["Text","Private"],SettingGroups:["SGEdit","ConfSG"],SignalRole:["Text","FunctionalVariantRef","LNodeInputRef","LNodeOutputRef","LNodeDataRef"],SmpRate:[],SmvOpts:[],SourceFiles:["Text","Private","SclFileReference"],SourceRef:["Text","GooseParametersRef","SMVParametersRef","ReportParametersRef","BinaryWiringParametersRef","AnalogueWiringParametersRef"],SubCategory:["Text","SubCategory","FunctionCatRef"],SubCheckoutID:["SubCheckoutID"],SubEquipment:["Text","Private","Labels","LNode","EqFunction"],SubFunction:["Text","Private","Labels","LNode","GeneralEquipment","ConductingEquipment","SubFunction"],SubFunctionTemplate:["Text","LNode","GeneralEquipment","ConductingEquipment","SubFunctionTemplate"],SubNetwork:["Text","Private","Labels","BitRate","ConnectedAP"],Subject:[],SubscriberLNode:["Text","GooseParametersRef","SMVParametersRef","ReportParametersRef","BinaryWiringParametersRef"],Substation:["Text","Private","Labels","LNode","PowerTransformer","GeneralEquipment","VoltageLevel","Function"],SupSubscription:[],TapChanger:["Text","Private","Labels","LNode","SubEquipment","EqFunction"],Terminal:["Text","Private"],Text:[],TimeSyncProt:[],TimerActivatedControl:[],TransformerWinding:["Text","Private","Labels","LNode","Terminal","SubEquipment","TapChanger","NeutralPoint","EqFunction"],TrgOps:[],Val:[],ValueHandling:[],Variable:["Text","VariableApplyTo"],VariableApplyTo:["Text"],VariableRef:["Text","FunctionalVariantRef"],Voltage:[],VoltageLevel:["Text","Private","Labels","LNode","PowerTransformer","GeneralEquipment","Voltage","Bay","Function"]};async function Ki(s){return qi({databaseName:s.databaseName,withDatabaseIds:!1})}async function qi(s){const{databaseName:l,withDatabaseIds:h}=s,f=new wt(l);await f.open();const D=await ji({databaseInstance:f,withDatabaseIds:h});if(!D)throw new Error("Failed to rebuild XML document from IndexedDB.");return{xmlDocument:D,filename:f.name+".scd"}}async function ji(s){const{databaseInstance:l,withDatabaseIds:h}=s;{const f=document.implementation.createDocument("http://www.iec.ch/61850/2003/SCL",null,null),D=await l.table(At).where({tagName:"SCL"}).first();if(!D)throw new Error("No SCL root element found in DB");const I=f.createElementNS(D.namespace.uri,D.tagName);return I.setAttribute("xmlns",D.namespace.uri),D.attributes&&La({document:f,element:I,attributes:D.attributes,isRoot:!0}),D.value&&(I.textContent=D.value.trim()),f.appendChild(I),await Ra({databaseInstance:l,withDatabaseIds:h,xmlDocument:f,databaseRecord:D,parentDomElement:I})}}async function Ra(s){const{databaseInstance:l,withDatabaseIds:h,xmlDocument:f,databaseRecord:D,parentDomElement:I}=s;if(!D.children)return;const R=D.children.map(z=>z.id),O=await l.table(At).bulkGet(R);Gi({childrenRecords:O,parentRecord:D});const K=Ui({parentTagName:D.tagName,childrenRecords:O});for(const z of K){const Q=Vi({document:f,record:z,withDatabaseIds:h});I.appendChild(Q),await Ra({databaseInstance:l,withDatabaseIds:h,xmlDocument:f,databaseRecord:z,parentDomElement:Q})}return s.xmlDocument}function Vi(s){const{document:l,record:h,withDatabaseIds:f}=s;let D;return h.namespace.uri===ka.default.uri?D=l.createElementNS(h.namespace.uri,h.tagName):(Ba({document:l,namespace:h.namespace}),D=l.createElementNS(h.namespace.uri,`${h.namespace.prefix}:${h.tagName}`)),h.attributes&&La({document:l,element:D,attributes:h.attributes,isRoot:!1}),h.value&&(D.textContent=h.value.trim()),f&&D.setAttribute(Bi,h.id),D}function La(s){const{document:l,element:h,attributes:f,isRoot:D}=s;for(const I of f)if(!(I.name==="xmlns"||I.name.startsWith("xmlns:")))if(mi(I)){const R=I.namespace?.prefix||"";if(R==="xmlns")continue;!D&&R&&Ba({document:l,namespace:I.namespace});const O=I.name.includes(":")&&I.name.split(":").pop()||I.name,K=R?`${R}:${O}`:O;h.setAttributeNS(I.namespace.uri,K,String(I.value))}else h.setAttribute(I.name,String(I.value))}function Ba(s){const{document:l,namespace:h}=s,f=l.documentElement;if(!f)return;const D="http://www.w3.org/2000/xmlns/";f.getAttributeNS(D,h.prefix)===null&&f.setAttributeNS(D,`xmlns:${h.prefix}`,h.uri)}function Ui(s){const{parentTagName:l,childrenRecords:h}=s,f=[],D=new Set(Mi[l]);if(!D.size)return h;const I=new Map,R=[];for(const O of D)I.set(O,[]);for(const O of h)D.has(O.tagName)?I.get(O.tagName)?.push(O):R.push(O);for(const O of D){const K=I.get(O);K&&K.length&&f.push(...K)}return f.push(...R),f}function Gi(s){const{childrenRecords:l,parentRecord:h}=s,f=l.map((D,I)=>D===void 0?I:-1).filter(D=>D!==-1);if(f.length>0){const D=f.map(I=>{const R=h.children[I];return`'${R.tagName}' (id: ${R.id})`});throw new Error(`Database corruption detected: Parent element '${h.tagName}' (id: ${h.id}) references ${f.length} non-existent child record(s): ${D.join(", ")}`)}}var Dn={exports:{}},yr={exports:{}},wa;function Wi(){return wa||(wa=1,function(s,l){Object.defineProperty(l,"__esModule",{value:!0}),l.ParsingError=void 0;class h extends Error{constructor($,ie){super($),this.cause=ie}}l.ParsingError=h;let f;function D(){return K(!1)||ne()||Y()||Q()||O(!1)}function I(){return F(/\s*/),K(!0)||Y()||z()||O(!1)}function R(){const J=O(!0),$=[];let ie,fe=I();for(;fe;){if(fe.node.type==="Element"){if(ie)throw new Error("Found multiple root nodes");ie=fe.node}fe.excluded||$.push(fe.node),fe=I()}if(!ie)throw new h("Failed to parse XML","Root Element not found");if(f.xml.length!==0)throw new h("Failed to parse XML","Not Well-Formed XML");return{declaration:J?J.node:null,root:ie,children:$}}function O(J){const $=F(J?/^<\?(xml(-stylesheet)?)\s*/:/^<\?([\w-:.]+)\s*/);if(!$)return;const ie={name:$[1],type:"ProcessingInstruction",attributes:{}};for(;!(X()||ae("?>"));){const fe=W();if(fe)ie.attributes[fe.name]=fe.value;else return}return F(/\?>/),{excluded:J?!1:f.options.filter(ie)===!1,node:ie}}function K(J){const $=F(/^<([^?!</>\s]+)\s*/);if(!$)return;const ie={type:"Element",name:$[1],attributes:{},children:[]},fe=J?!1:f.options.filter(ie)===!1;for(;!(X()||ae(">")||ae("?>")||ae("/>"));){const Ce=W();if(Ce)ie.attributes[Ce.name]=Ce.value;else return}if(F(/^\s*\/>/))return ie.children=null,{excluded:fe,node:ie};F(/\??>/);let oe=D();for(;oe;)oe.excluded||ie.children.push(oe.node),oe=D();if(f.options.strictMode){const Ce=`</${ie.name}>`;if(f.xml.startsWith(Ce))f.xml=f.xml.slice(Ce.length);else throw new h("Failed to parse XML",`Closing tag not matching "${Ce}"`)}else F(/^<\/[\w-:.\u00C0-\u00FF]+\s*>/);return{excluded:fe,node:ie}}function z(){const J=F(/^<!DOCTYPE\s+\S+\s+SYSTEM[^>]*>/)||F(/^<!DOCTYPE\s+\S+\s+PUBLIC[^>]*>/)||F(/^<!DOCTYPE\s+\S+\s*\[[^\]]*]>/)||F(/^<!DOCTYPE\s+\S+\s*>/);if(J){const $={type:"DocumentType",content:J[0]};return{excluded:f.options.filter($)===!1,node:$}}}function Q(){if(f.xml.startsWith("<![CDATA[")){const J=f.xml.indexOf("]]>");if(J>-1){const $=J+3,ie={type:"CDATA",content:f.xml.substring(0,$)};return f.xml=f.xml.slice($),{excluded:f.options.filter(ie)===!1,node:ie}}}}function Y(){const J=F(/^<!--[\s\S]*?-->/);if(J){const $={type:"Comment",content:J[0]};return{excluded:f.options.filter($)===!1,node:$}}}function ne(){const J=F(/^([^<]+)/);if(J){const $={type:"Text",content:J[1]};return{excluded:f.options.filter($)===!1,node:$}}}function W(){const J=F(/([^=]+)\s*=\s*("[^"]*"|'[^']*'|[^>\s]+)\s*/);if(J)return{name:J[1].trim(),value:k(J[2].trim())}}function k(J){return J.replace(/^['"]|['"]$/g,"")}function F(J){const $=f.xml.match(J);if($)return f.xml=f.xml.slice($[0].length),$}function X(){return f.xml.length===0}function ae(J){return f.xml.indexOf(J)===0}function be(J,$={}){J=J.trim();const ie=$.filter||(()=>!0);return f={xml:J,options:Object.assign(Object.assign({},$),{filter:ie,strictMode:$.strictMode===!0})},R()}s.exports=be,l.default=be}(yr,yr.exports)),yr.exports}var _a=Dn.exports,Sa;function Yi(){return Sa||(Sa=1,function(s,l){var h=_a&&_a.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(l,"__esModule",{value:!0});const f=h(Wi());function D(k){if(!k.options.indentation&&!k.options.lineSeparator)return;k.content+=k.options.lineSeparator;let F;for(F=0;F<k.level;F++)k.content+=k.options.indentation}function I(k){k.content=k.content.replace(/ +$/,"");let F;for(F=0;F<k.level;F++)k.content+=k.options.indentation}function R(k,F){k.content+=F}function O(k,F,X){if(typeof k.content=="string")K(k.content,F,X);else if(k.type==="Element")Q(k,F,X);else if(k.type==="ProcessingInstruction")ne(k,F);else throw new Error("Unknown node type: "+k.type)}function K(k,F,X){if(!X){const ae=k.trim();(F.options.lineSeparator||ae.length===0)&&(k=ae)}k.length>0&&(!X&&F.content.length>0&&D(F),R(F,k))}function z(k,F){const X="/"+k.join("/"),ae=k[k.length-1];return F.includes(ae)||F.includes(X)}function Q(k,F,X){if(F.path.push(k.name),!X&&F.content.length>0&&D(F),R(F,"<"+k.name),Y(F,k.attributes),k.children===null||F.options.forceSelfClosingEmptyTag&&k.children.length===0){const ae=F.options.whiteSpaceAtEndOfSelfclosingTag?" />":"/>";R(F,ae)}else if(k.children.length===0)R(F,"></"+k.name+">");else{const ae=k.children;R(F,">"),F.level++;let be=k.attributes["xml:space"]==="preserve"||X,J=!1;if(!be&&F.options.ignoredPaths&&(J=z(F.path,F.options.ignoredPaths),be=J),!be&&F.options.collapseContent){let $=!1,ie=!1,fe=!1;ae.forEach(function(oe,Ce){oe.type==="Text"?(oe.content.includes(`
`)?(ie=!0,oe.content=oe.content.trim()):(Ce===0||Ce===ae.length-1)&&!X&&oe.content.trim().length===0&&(oe.content=""),(oe.content.trim().length>0||ae.length===1)&&($=!0)):oe.type==="CDATA"?$=!0:fe=!0}),$&&(!fe||!ie)&&(be=!0)}ae.forEach(function($){O($,F,X||be)}),F.level--,!X&&!be&&D(F),J&&I(F),R(F,"</"+k.name+">")}F.path.pop()}function Y(k,F){Object.keys(F).forEach(function(X){const ae=F[X].replace(/"/g,"&quot;");R(k," "+X+'="'+ae+'"')})}function ne(k,F){F.content.length>0&&D(F),R(F,"<?"+k.name),Y(F,k.attributes),R(F,"?>")}function W(k,F={}){F.indentation="indentation"in F?F.indentation:"    ",F.collapseContent=F.collapseContent===!0,F.lineSeparator="lineSeparator"in F?F.lineSeparator:`\r
`,F.whiteSpaceAtEndOfSelfclosingTag=F.whiteSpaceAtEndOfSelfclosingTag===!0,F.throwOnFailure=F.throwOnFailure!==!1;try{const X=(0,f.default)(k,{filter:F.filter,strictMode:F.strictMode}),ae={content:"",level:0,options:F,path:[]};return X.declaration&&ne(X.declaration,ae),X.children.forEach(function(be){O(be,ae,!1)}),F.lineSeparator?ae.content.replace(/\r\n/g,`
`).replace(/\n/g,F.lineSeparator):ae.content}catch(X){if(F.throwOnFailure)throw X;return k}}W.minify=(k,F={})=>W(k,Object.assign(Object.assign({},F),{indentation:"",lineSeparator:""})),s.exports=W,l.default=W}(Dn,Dn.exports)),Dn.exports}var $i=Yi();const Hi=Fa($i);function Xi(s){return Hi(s)}const zi=An("file",()=>{const s=ca("currentActiveFileDatabaseName","",localStorage),l=ca("currentImportedDatabaseNames",[],localStorage),h=ze(!1);async function f(){const{promise:K,resolve:z}=Promise.withResolvers(),{open:Q,onChange:Y}=la({accept:"asd"});return Y(async ne=>{if(!ne||ne.length===0)return;const W=Array.from(ne),k=[];for(const X of W){const ae=X.name.replace(/\.[^.]+$/,"");(await(indexedDB.databases?.()||[])).some($=>$.name===ae)&&!window.confirm(`A file named "${ae}" already exists in the database. Do you want to replace it?`)||k.push(X)}if(k.length===0){z();return}const F=await mr({files:k});s.value=F[0],F.length&&console.info(`Files imported successfully: ${F.join(", ")}`),z()}),Q(),K}async function D(){try{if(!s.value)throw new Error("No active file to save - please open a file first");const K=await Ki({databaseName:s.value}),ne=`<?xml version="1.0" encoding="UTF-8"?>
`+new XMLSerializer().serializeToString(K.xmlDocument),W=Xi(ne),k=new Blob([W],{type:"application/xml"}),F=$o(k);if(!F.value)throw new Error("Failed to create object URL for the XML document");const X=document.createElement("a");X.href=F.value,X.download=K.filename,document.body.appendChild(X),X.click(),setTimeout(()=>{document.body.removeChild(X)},0)}catch(K){throw console.error("Error saving file:",K),K}}async function I(){const{promise:K,resolve:z}=Promise.withResolvers(),{open:Q,onChange:Y}=la({accept:"fsd"});return Y(async ne=>{if(!ne||ne.length===0)return;const W=Array.from(ne),k=await mr({files:W});l.value=[...l.value,...k],z()}),Q(),K}async function R(K){if((await(indexedDB.databases?.()||[])).some(X=>X.name===K)&&!window.confirm(`A file named "${K}" already exists in the database. Do you want to replace it?`))return;const Y=()=>crypto.randomUUID(),ne=`
				<?xml version="1.0" encoding="UTF-8"?>
				<SCL xmlns="http://www.iec.ch/61850/2003/SCL" version="2007" revision="C" release="5">
  				<Header id="${K}" version="0" revision="1" toolID="SeptKit Set" uuid="${Y()}"/>
					<Substation name="TEMPLATE" uuid="${Y()}">
						<VoltageLevel name="TEMPLATE" uuid="${Y()}">
						 <Bay name="TEMPLATE" uuid="${Y()}">
						 </Bay>
						</VoltageLevel>
					</Substation>
				</SCL>
				`,W=`${K}.xml`,k=new File([ne],W,{type:"text/xml"}),F=await mr({files:[k]});F.length&&(s.value=F[0],window.alert(`New Project Created: ${K}`)),h.value=!1}function O(){h.value=!0}return{currentActiveFileDatabaseName:s,currentImportedDatabaseNames:l,newFileModalOpen:h,openFiles:f,saveFile:D,importFiles:I,openNewFileModal:O,createNewFile:R}});let vr;function Qi(){return vr||(vr=Ji()),vr}function Ji(){return{activeFileName:Zi()}}function Zi(){let s=[],l;const h=zi();return Ot(()=>h.currentActiveFileDatabaseName,D),l=h.currentActiveFileDatabaseName,{get value(){return l},subscribe:f};function f(I){return s.push(I),function(){s=s.filter(O=>O!==I)}}function D(I){for(const R of s)R(I,l);l=I}}const es={class:"root",name:"widget-site"},ts=["id"],ns=go({__name:"widget-site",props:{widget:{},rootId:{}},setup(s){const l=s,h=Xo(),f=zo();let D=Qi();const I=bo("widget-root");async function R(O){if(!O){console.info({msg:"no startFnUrl yet"});return}const K=await ri(O);if(K){if(!I.value){console.error({msg:"could not find widget root",widgetRoot:I});return}I.value.innerHTML="",l.widget?.location==="mainArea"?h.unmountExtension=K(l.rootId,D):l.widget?.location==="primarySidebar"&&(f.unmountExtension=K(l.rootId,D))}}return xr(async()=>{l.widget?.startFnUrl&&R(l.widget.startFnUrl)}),(O,K)=>(So(),wo("div",es,[_o("div",{class:"widget-root h-full",ref:"widget-root",id:l.rootId},"",8,ts)]))}}),ws=Ho(ns,[["__scopeId","data-v-a1849e70"]]);function _s(s,l){const h=Ma(l);h.value=s}function Ss(s,l){const h=Ma(s);Ot(()=>h.value,f=>{f&&l(f)},{immediate:!0})}function Ma(s){const l=s;return l.widgetPortal||(l.widgetPortal=To({value:void 0})),l.widgetPortal}export{ws as W,Ho as _,Xo as a,os as b,zo as c,zi as d,Pr as e,ss as f,as as g,Ss as h,us as l,_s as s,is as u};
