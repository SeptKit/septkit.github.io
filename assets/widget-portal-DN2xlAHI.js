import{aC as ga,as as ba,a0 as wr,a7 as wa,af as oo,bC as Pt,a1 as io,aF as so,aR as Nn,bd as uo,aS as Qe,J as co,b5 as ze,q as He,bf as Le,bD as _r,bi as lo,ak as fo,bP as Pn,M as po,bs as ho,u as mo,v as yo,aK as vo,aQ as go}from"./index-CFCpF8Ds.js";function Er(s){return io()?(so(s),!0):!1}function ra(){const s=new Set,l=D=>{s.delete(D)};return{on:D=>{s.add(D);const K=()=>l(D);return Er(K),{off:K}},off:l,trigger:(...D)=>Promise.all(Array.from(s).map(K=>K(...D))),clear:()=>{s.clear()}}}const fr=new WeakMap,bo=(...s)=>{var l;const h=s[0],p=(l=wr())==null?void 0:l.proxy;if(p==null&&!wa())throw new Error("injectLocal must be called in setup");return p&&fr.has(p)&&h in fr.get(p)?fr.get(p)[h]:oo(...s)},_a=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const wo=Object.prototype.toString,_o=s=>wo.call(s)==="[object Object]",Ea=()=>{},Eo=(s,l)=>Object.prototype.hasOwnProperty.call(s,l);function To(...s){if(s.length!==1)return uo(...s);const l=s[0];return typeof l=="function"?Nn(co(()=>({get:l,set:Ea}))):Qe(l)}function xo(s,l){function h(...p){return new Promise((k,D)=>{Promise.resolve(s(()=>l.apply(this,p),{fn:l,thisArg:this,args:p})).then(k).catch(D)})}return h}const Ta=s=>s();function Oo(s=Ta,l={}){const{initialState:h="active"}=l,p=To(h==="active");function k(){p.value=!1}function D(){p.value=!0}const K=(...F)=>{p.value&&s(...F)};return{isActive:Nn(p),pause:k,resume:D,eventFilter:K}}function So(s,l){var h;if(typeof s=="number")return s+l;const p=((h=s.match(/^-?\d+\.?\d*/))==null?void 0:h[0])||"",k=s.slice(p.length),D=Number.parseFloat(p)+l;return Number.isNaN(D)?s:D+k}function Xt(s){return s.endsWith("rem")?Number.parseFloat(s)*16:Number.parseFloat(s)}function dr(s){return Array.isArray(s)?s:[s]}function Ao(s){return wr()}function No(s,l,h={}){const{eventFilter:p=Ta,...k}=h;return Pt(s,xo(p,l),k)}function Po(s,l,h={}){const{eventFilter:p,initialState:k="active",...D}=h,{eventFilter:K,pause:F,resume:q,isActive:Q}=Oo(p,{initialState:k});return{stop:No(s,l,{...D,eventFilter:K}),pause:F,resume:q,isActive:Q}}function xa(s,l=!0,h){Ao()?ga(s,h):l?s():ba(s)}function Co(s,l,h){return Pt(s,l,{...h,immediate:!0})}function Hi(s,l,h){let p;fo(h)?p={evaluating:h}:p={};const{lazy:k=!1,flush:D="pre",evaluating:K=void 0,shallow:F=!0,onError:q=Ea}=p,Q=ze(!k),H=F?ze(l):Qe(l);let $=0;return _r(async ne=>{if(!Q.value)return;$++;const G=$;let I=!1;K&&Promise.resolve().then(()=>{K.value=!0});try{const C=await s(z=>{ne(()=>{K&&(K.value=!1),I||z()})});G===$&&(H.value=C)}catch(C){q(C)}finally{K&&G===$&&(K.value=!1),I=!0}},{flush:D}),k?He(()=>(Q.value=!0,H.value)):H}const Qt=_a?window:void 0,Io=_a?window.document:void 0;function Oa(s){var l;const h=Le(s);return(l=h?.$el)!=null?l:h}function yr(...s){const l=[],h=()=>{l.forEach(F=>F()),l.length=0},p=(F,q,Q,H)=>(F.addEventListener(q,Q,H),()=>F.removeEventListener(q,Q,H)),k=He(()=>{const F=dr(Le(s[0])).filter(q=>q!=null);return F.every(q=>typeof q!="string")?F:void 0}),D=Co(()=>{var F,q;return[(q=(F=k.value)==null?void 0:F.map(Q=>Oa(Q)))!=null?q:[Qt].filter(Q=>Q!=null),dr(Le(k.value?s[1]:s[0])),dr(lo(k.value?s[2]:s[1])),Le(k.value?s[3]:s[2])]},([F,q,Q,H])=>{if(h(),!F?.length||!q?.length||!Q?.length)return;const $=_o(H)?{...H}:H;l.push(...F.flatMap(ne=>q.flatMap(G=>Q.map(I=>p(ne,G,I,$)))))},{flush:"post"}),K=()=>{D(),h()};return Er(h),K}function ko(){const s=ze(!1),l=wr();return l&&ga(()=>{s.value=!0},l),s}function Do(s){const l=ko();return He(()=>(l.value,!!s()))}const Fo=Symbol("vueuse-ssr-width");function Sa(){const s=wa()?bo(Fo,null):null;return typeof s=="number"?s:void 0}function Yt(s,l={}){const{window:h=Qt,ssrWidth:p=Sa()}=l,k=Do(()=>h&&"matchMedia"in h&&typeof h.matchMedia=="function"),D=ze(typeof p=="number"),K=ze(),F=ze(!1),q=Q=>{F.value=Q.matches};return _r(()=>{if(D.value){D.value=!k.value;const Q=Le(s).split(",");F.value=Q.some(H=>{const $=H.includes("not all"),ne=H.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),G=H.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let I=!!(ne||G);return ne&&I&&(I=p>=Xt(ne[1])),G&&I&&(I=p<=Xt(G[1])),$?!I:I});return}k.value&&(K.value=h.matchMedia(Le(s)),F.value=K.value.matches)}),yr(K,"change",q,{passive:!0}),He(()=>F.value)}const Ji={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};function Zi(s,l={}){function h(G,I){let C=Le(s[Le(G)]);return I!=null&&(C=So(C,I)),typeof C=="number"&&(C=`${C}px`),C}const{window:p=Qt,strategy:k="min-width",ssrWidth:D=Sa()}=l,K=typeof D=="number",F=K?ze(!1):{value:!0};K&&xa(()=>F.value=!!p);function q(G,I){return!F.value&&K?G==="min"?D>=Xt(I):D<=Xt(I):p?p.matchMedia(`(${G}-width: ${I})`).matches:!1}const Q=G=>Yt(()=>`(min-width: ${h(G)})`,l),H=G=>Yt(()=>`(max-width: ${h(G)})`,l),$=Object.keys(s).reduce((G,I)=>(Object.defineProperty(G,I,{get:()=>k==="min-width"?Q(I):H(I),enumerable:!0,configurable:!0}),G),{});function ne(){const G=Object.keys(s).map(I=>[I,$[I],Xt(h(I))]).sort((I,C)=>I[2]-C[2]);return He(()=>G.filter(([,I])=>I.value).map(([I])=>I))}return Object.assign($,{greaterOrEqual:Q,smallerOrEqual:H,greater(G){return Yt(()=>`(min-width: ${h(G,.1)})`,l)},smaller(G){return Yt(()=>`(max-width: ${h(G,-.1)})`,l)},between(G,I){return Yt(()=>`(min-width: ${h(G)}) and (max-width: ${h(I,-.1)})`,l)},isGreater(G){return q("min",h(G,.1))},isGreaterOrEqual(G){return q("min",h(G))},isSmaller(G){return q("max",h(G,-.1))},isSmallerOrEqual(G){return q("max",h(G))},isInBetween(G,I){return q("min",h(G))&&q("max",h(I,-.1))},current:ne,active(){const G=ne();return He(()=>G.value.length===0?"":G.value.at(k==="min-width"?-1:0))}})}const On=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sn="__vueuse_ssr_handlers__",Bo=Mo();function Mo(){return Sn in On||(On[Sn]=On[Sn]||{}),On[Sn]}function Ro(s,l){return Bo[s]||l}function Ko(s){return s==null?"any":s instanceof Set?"set":s instanceof Map?"map":s instanceof Date?"date":typeof s=="boolean"?"boolean":typeof s=="string"?"string":typeof s=="object"?"object":Number.isNaN(s)?"any":"number"}const qo={boolean:{read:s=>s==="true",write:s=>String(s)},object:{read:s=>JSON.parse(s),write:s=>JSON.stringify(s)},number:{read:s=>Number.parseFloat(s),write:s=>String(s)},any:{read:s=>s,write:s=>String(s)},string:{read:s=>s,write:s=>String(s)},map:{read:s=>new Map(JSON.parse(s)),write:s=>JSON.stringify(Array.from(s.entries()))},set:{read:s=>new Set(JSON.parse(s)),write:s=>JSON.stringify(Array.from(s))},date:{read:s=>new Date(s),write:s=>s.toISOString()}},aa="vueuse-storage";function oa(s,l,h,p={}){var k;const{flush:D="pre",deep:K=!0,listenToStorageChanges:F=!0,writeDefaults:q=!0,mergeDefaults:Q=!1,shallow:H,window:$=Qt,eventFilter:ne,onError:G=se=>{console.error(se)},initOnMounted:I}=p,C=(H?ze:Qe)(typeof l=="function"?l():l),z=He(()=>Le(s));if(!h)try{h=Ro("getDefaultStorage",()=>{var se;return(se=Qt)==null?void 0:se.localStorage})()}catch(se){G(se)}if(!h)return C;const ae=Le(l),be=Ko(ae),J=(k=p.serializer)!=null?k:qo[be],{pause:Y,resume:ie}=Po(C,()=>ut(C.value),{flush:D,deep:K,eventFilter:ne});Pt(z,()=>de(),{flush:D});let fe=!1;const oe=se=>{I&&!fe||de(se)},Ne=se=>{I&&!fe||De(se)};$&&F&&(h instanceof Storage?yr($,"storage",oe,{passive:!0}):yr($,aa,Ne)),I?xa(()=>{fe=!0,de()}):de();function S(se,me){if($){const Oe={key:z.value,oldValue:se,newValue:me,storageArea:h};$.dispatchEvent(h instanceof Storage?new StorageEvent("storage",Oe):new CustomEvent(aa,{detail:Oe}))}}function ut(se){try{const me=h.getItem(z.value);if(se==null)S(me,null),h.removeItem(z.value);else{const Oe=J.write(se);me!==Oe&&(h.setItem(z.value,Oe),S(me,Oe))}}catch(me){G(me)}}function Ue(se){const me=se?se.newValue:h.getItem(z.value);if(me==null)return q&&ae!=null&&h.setItem(z.value,J.write(ae)),ae;if(!se&&Q){const Oe=J.read(me);return typeof Q=="function"?Q(Oe,ae):be==="object"&&!Array.isArray(Oe)?{...ae,...Oe}:Oe}else return typeof me!="string"?me:J.read(me)}function de(se){if(!(se&&se.storageArea!==h)){if(se&&se.key==null){C.value=ae;return}if(!(se&&se.key!==z.value)){Y();try{se?.newValue!==J.write(C.value)&&(C.value=Ue(se))}catch(me){G(me)}finally{se?ba(ie):ie()}}}}function De(se){de(se.detail)}return C}const jo={multiple:!0,accept:"*",reset:!1,directory:!1};function Lo(s){if(!s)return null;if(s instanceof FileList)return s;const l=new DataTransfer;for(const h of s)l.items.add(h);return l.files}function ia(s={}){const{document:l=Io}=s,h=Qe(Lo(s.initialFiles)),{on:p,trigger:k}=ra(),{on:D,trigger:K}=ra();let F;l&&(F=Oa(s.input)||l.createElement("input"),F.type="file",F.onchange=H=>{const $=H.target;h.value=$.files,k(h.value)},F.oncancel=()=>{K()});const q=()=>{h.value=null,F&&F.value&&(F.value="",k(null))},Q=H=>{if(!F)return;const $={...jo,...s,...H};F.multiple=$.multiple,F.accept=$.accept,F.webkitdirectory=$.directory,Eo($,"capture")&&(F.capture=$.capture),$.reset&&q(),F.click()};return{files:Nn(h),open:Q,reset:q,onCancel:D,onChange:p}}function Uo(s){const l=ze(),h=()=>{l.value&&URL.revokeObjectURL(l.value),l.value=void 0};return Pt(()=>Le(s),p=>{h(),p&&(l.value=URL.createObjectURL(p))},{immediate:!0}),Er(h),Nn(l)}const Vo=(s,l)=>{const h=s.__vccOpts||s;for(const[p,k]of l)h[p]=k;return h},Tr=Pn("extension",()=>{const s=Qe(null),l=Qe([]);return{extensions:l,setExtensions:k,activeExtensionId:s,setActiveExtension:h,clearActiveExtension:p};function h(D){s.value=D}function p(){s.value=null}function k(D){l.value=D}}),Wo=Aa("mainArea"),Go=Aa("primarySidebar"),es=Pn("menuContributionStore",()=>{const s=Tr();return{contributions:He(()=>s.extensions.map(h=>h.contributions.filter(p=>p.type==="menu").map(p=>p)).flat())}});function Aa(s){return Pn(`${s}Store`,()=>{const l=Tr(),h=Qe(),p=Qe();return{widgets:He(()=>l.extensions.map(K=>K.contributions.filter(F=>F.type==="widget"&&F.location===s).map(F=>F)).flat()),get activeWidget(){return h},activateWidget:D,unmountExtension:p};function D(K){h.value=K}})}function Na(s,l){const h=new URL(l),p=s.replace("/",""),k=h.pathname.split("/").filter(Boolean);return k.push(p),k.unshift(h.origin),k.join("/")}async function ts(s){const l=Tr(),h=await $o(s);l.setExtensions(h)}async function $o(s){return(await Promise.allSettled(s.map(async h=>{const p=await Xo(h);return{id:p.name,version:p.version,label:p.displayName,contributions:[...p.contributes.customEditors?.map(k=>sa(k,h,"mainArea"))??[],...p.contributes.primarySidebars?.map(k=>sa(k,h,"primarySidebar"))??[],...p.contributes.menu?.map(k=>Yo(k,h))??[]]}}).filter(Boolean))).filter(h=>h.status==="fulfilled").map(h=>h.value)}function sa(s,l,h){const p=zo(s);return{id:s.id,type:"widget",label:s.displayName,icon:s.icon,location:h,startFnUrl:Na(s.entryPoint,l),iframe:p}}function Yo(s,l){return{id:s.id,type:"menu",label:s.displayName,icon:s.icon,menuPath:s.path??[],actionFnUrl:Na(s.entryPoint,l)}}async function Xo(s){try{const l=new URL("package.json",s).toString(),h=await fetch(l);if(!h.ok)throw new Error(`Failed to fetch package.json from ${l}`);return await h.json()}catch(l){throw console.error("Error fetching package.json:",l),l}}function zo(s){let l=!1;return s.iframe!==void 0&&(l=s.iframe??!1),l}async function Qo(s){const l=await import(s);if(!l.default)throw new Error(`Default export not found in the loaded module from ${s}`);return l.default}var Ho=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pa(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Jo(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var l=s.default;if(typeof l=="function"){var h=function p(){var k=!1;try{k=this instanceof p}catch{}return k?Reflect.construct(l,arguments,this.constructor):l.apply(this,arguments)};h.prototype=l.prototype}else h={};return Object.defineProperty(h,"__esModule",{value:!0}),Object.keys(s).forEach(function(p){var k=Object.getOwnPropertyDescriptor(s,p);Object.defineProperty(h,p,k.get?k:{enumerable:!0,get:function(){return s[p]}})}),h}var ua={};const Zo={},ei=Object.freeze(Object.defineProperty({__proto__:null,default:Zo},Symbol.toStringTag,{value:"Module"})),ca=Jo(ei);var la;function ti(){return la||(la=1,function(s){(function(l){l.parser=function(u,i){return new p(u,i)},l.SAXParser=p,l.SAXStream=H,l.createStream=Q,l.MAX_BUFFER_LENGTH=64*1024;var h=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];l.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function p(u,i){if(!(this instanceof p))return new p(u,i);var O=this;D(O),O.q=O.c="",O.bufferCheckPosition=l.MAX_BUFFER_LENGTH,O.opt=i||{},O.opt.lowercase=O.opt.lowercase||O.opt.lowercasetags,O.looseCase=O.opt.lowercase?"toLowerCase":"toUpperCase",O.tags=[],O.closed=O.closedRoot=O.sawRoot=!1,O.tag=O.error=null,O.strict=!!u,O.noscript=!!(u||O.opt.noscript),O.state=S.BEGIN,O.strictEntities=O.opt.strictEntities,O.ENTITIES=O.strictEntities?Object.create(l.XML_ENTITIES):Object.create(l.ENTITIES),O.attribList=[],O.opt.xmlns&&(O.ns=Object.create(C)),O.opt.unquotedAttributeValues===void 0&&(O.opt.unquotedAttributeValues=!u),O.trackPosition=O.opt.position!==!1,O.trackPosition&&(O.position=O.line=O.column=0),Ue(O,"onready")}Object.create||(Object.create=function(u){function i(){}i.prototype=u;var O=new i;return O}),Object.keys||(Object.keys=function(u){var i=[];for(var O in u)u.hasOwnProperty(O)&&i.push(O);return i});function k(u){for(var i=Math.max(l.MAX_BUFFER_LENGTH,10),O=0,T=0,ce=h.length;T<ce;T++){var Z=u[h[T]].length;if(Z>i)switch(h[T]){case"textNode":De(u);break;case"cdata":de(u,"oncdata",u.cdata),u.cdata="";break;case"script":de(u,"onscript",u.script),u.script="";break;default:me(u,"Max buffer length exceeded: "+h[T])}O=Math.max(O,Z)}var ye=l.MAX_BUFFER_LENGTH-O;u.bufferCheckPosition=ye+u.position}function D(u){for(var i=0,O=h.length;i<O;i++)u[h[i]]=""}function K(u){De(u),u.cdata!==""&&(de(u,"oncdata",u.cdata),u.cdata=""),u.script!==""&&(de(u,"onscript",u.script),u.script="")}p.prototype={end:function(){Oe(this)},write:Ze,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){K(this)}};var F;try{F=ca.Stream}catch{F=function(){}}F||(F=function(){});var q=l.EVENTS.filter(function(u){return u!=="error"&&u!=="end"});function Q(u,i){return new H(u,i)}function H(u,i){if(!(this instanceof H))return new H(u,i);F.apply(this),this._parser=new p(u,i),this.writable=!0,this.readable=!0;var O=this;this._parser.onend=function(){O.emit("end")},this._parser.onerror=function(T){O.emit("error",T),O._parser.error=null},this._decoder=null,q.forEach(function(T){Object.defineProperty(O,"on"+T,{get:function(){return O._parser["on"+T]},set:function(ce){if(!ce)return O.removeAllListeners(T),O._parser["on"+T]=ce,ce;O.on(T,ce)},enumerable:!0,configurable:!1})})}H.prototype=Object.create(F.prototype,{constructor:{value:H}}),H.prototype.write=function(u){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(u)){if(!this._decoder){var i=ca.StringDecoder;this._decoder=new i("utf8")}u=this._decoder.write(u)}return this._parser.write(u.toString()),this.emit("data",u),!0},H.prototype.end=function(u){return u&&u.length&&this.write(u),this._parser.end(),!0},H.prototype.on=function(u,i){var O=this;return!O._parser["on"+u]&&q.indexOf(u)!==-1&&(O._parser["on"+u]=function(){var T=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);T.splice(0,0,u),O.emit.apply(O,T)}),F.prototype.on.call(O,u,i)};var $="[CDATA[",ne="DOCTYPE",G="http://www.w3.org/XML/1998/namespace",I="http://www.w3.org/2000/xmlns/",C={xml:G,xmlns:I},z=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,ae=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,be=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,J=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function Y(u){return u===" "||u===`
`||u==="\r"||u==="	"}function ie(u){return u==='"'||u==="'"}function fe(u){return u===">"||Y(u)}function oe(u,i){return u.test(i)}function Ne(u,i){return!oe(u,i)}var S=0;l.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},l.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},l.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(l.ENTITIES).forEach(function(u){var i=l.ENTITIES[u],O=typeof i=="number"?String.fromCharCode(i):i;l.ENTITIES[u]=O});for(var ut in l.STATE)l.STATE[l.STATE[ut]]=ut;S=l.STATE;function Ue(u,i,O){u[i]&&u[i](O)}function de(u,i,O){u.textNode&&De(u),Ue(u,i,O)}function De(u){u.textNode=se(u.opt,u.textNode),u.textNode&&Ue(u,"ontext",u.textNode),u.textNode=""}function se(u,i){return u.trim&&(i=i.trim()),u.normalize&&(i=i.replace(/\s+/g," ")),i}function me(u,i){return De(u),u.trackPosition&&(i+=`
Line: `+u.line+`
Column: `+u.column+`
Char: `+u.c),i=new Error(i),u.error=i,Ue(u,"onerror",i),u}function Oe(u){return u.sawRoot&&!u.closedRoot&&he(u,"Unclosed root tag"),u.state!==S.BEGIN&&u.state!==S.BEGIN_WHITESPACE&&u.state!==S.TEXT&&me(u,"Unexpected end"),De(u),u.c="",u.closed=!0,Ue(u,"onend"),p.call(u,u.strict,u.opt),u}function he(u,i){if(typeof u!="object"||!(u instanceof p))throw new Error("bad call to strictFail");u.strict&&me(u,i)}function $e(u){u.strict||(u.tagName=u.tagName[u.looseCase]());var i=u.tags[u.tags.length-1]||u,O=u.tag={name:u.tagName,attributes:{}};u.opt.xmlns&&(O.ns=i.ns),u.attribList.length=0,de(u,"onopentagstart",O)}function Ve(u,i){var O=u.indexOf(":"),T=O<0?["",u]:u.split(":"),ce=T[0],Z=T[1];return i&&u==="xmlns"&&(ce="xmlns",Z=""),{prefix:ce,local:Z}}function Me(u){if(u.strict||(u.attribName=u.attribName[u.looseCase]()),u.attribList.indexOf(u.attribName)!==-1||u.tag.attributes.hasOwnProperty(u.attribName)){u.attribName=u.attribValue="";return}if(u.opt.xmlns){var i=Ve(u.attribName,!0),O=i.prefix,T=i.local;if(O==="xmlns")if(T==="xml"&&u.attribValue!==G)he(u,"xml: prefix must be bound to "+G+`
Actual: `+u.attribValue);else if(T==="xmlns"&&u.attribValue!==I)he(u,"xmlns: prefix must be bound to "+I+`
Actual: `+u.attribValue);else{var ce=u.tag,Z=u.tags[u.tags.length-1]||u;ce.ns===Z.ns&&(ce.ns=Object.create(Z.ns)),ce.ns[T]=u.attribValue}u.attribList.push([u.attribName,u.attribValue])}else u.tag.attributes[u.attribName]=u.attribValue,de(u,"onattribute",{name:u.attribName,value:u.attribValue});u.attribName=u.attribValue=""}function qe(u,i){if(u.opt.xmlns){var O=u.tag,T=Ve(u.tagName);O.prefix=T.prefix,O.local=T.local,O.uri=O.ns[T.prefix]||"",O.prefix&&!O.uri&&(he(u,"Unbound namespace prefix: "+JSON.stringify(u.tagName)),O.uri=T.prefix);var ce=u.tags[u.tags.length-1]||u;O.ns&&ce.ns!==O.ns&&Object.keys(O.ns).forEach(function(kt){de(u,"onopennamespace",{prefix:kt,uri:O.ns[kt]})});for(var Z=0,ye=u.attribList.length;Z<ye;Z++){var Pe=u.attribList[Z],we=Pe[0],et=Pe[1],xe=Ve(we,!0),je=xe.prefix,Cn=xe.local,_t=je===""?"":O.ns[je]||"",Be={name:we,value:et,prefix:je,local:Cn,uri:_t};je&&je!=="xmlns"&&!_t&&(he(u,"Unbound namespace prefix: "+JSON.stringify(je)),Be.uri=je),u.tag.attributes[we]=Be,de(u,"onattribute",Be)}u.attribList.length=0}u.tag.isSelfClosing=!!i,u.sawRoot=!0,u.tags.push(u.tag),de(u,"onopentag",u.tag),i||(!u.noscript&&u.tagName.toLowerCase()==="script"?u.state=S.SCRIPT:u.state=S.TEXT,u.tag=null,u.tagName=""),u.attribName=u.attribValue="",u.attribList.length=0}function Ct(u){if(!u.tagName){he(u,"Weird empty close tag."),u.textNode+="</>",u.state=S.TEXT;return}if(u.script){if(u.tagName!=="script"){u.script+="</"+u.tagName+">",u.tagName="",u.state=S.SCRIPT;return}de(u,"onscript",u.script),u.script=""}var i=u.tags.length,O=u.tagName;u.strict||(O=O[u.looseCase]());for(var T=O;i--;){var ce=u.tags[i];if(ce.name!==T)he(u,"Unexpected close tag");else break}if(i<0){he(u,"Unmatched closing tag: "+u.tagName),u.textNode+="</"+u.tagName+">",u.state=S.TEXT;return}u.tagName=O;for(var Z=u.tags.length;Z-- >i;){var ye=u.tag=u.tags.pop();u.tagName=u.tag.name,de(u,"onclosetag",u.tagName);var Pe={};for(var we in ye.ns)Pe[we]=ye.ns[we];var et=u.tags[u.tags.length-1]||u;u.opt.xmlns&&ye.ns!==et.ns&&Object.keys(ye.ns).forEach(function(xe){var je=ye.ns[xe];de(u,"onclosenamespace",{prefix:xe,uri:je})})}i===0&&(u.closedRoot=!0),u.tagName=u.attribValue=u.attribName="",u.attribList.length=0,u.state=S.TEXT}function Je(u){var i=u.entity,O=i.toLowerCase(),T,ce="";return u.ENTITIES[i]?u.ENTITIES[i]:u.ENTITIES[O]?u.ENTITIES[O]:(i=O,i.charAt(0)==="#"&&(i.charAt(1)==="x"?(i=i.slice(2),T=parseInt(i,16),ce=T.toString(16)):(i=i.slice(1),T=parseInt(i,10),ce=T.toString(10))),i=i.replace(/^0+/,""),isNaN(T)||ce.toLowerCase()!==i?(he(u,"Invalid character entity"),"&"+u.entity+";"):String.fromCodePoint(T))}function It(u,i){i==="<"?(u.state=S.OPEN_WAKA,u.startTagPosition=u.position):Y(i)||(he(u,"Non-whitespace before first tag."),u.textNode=i,u.state=S.TEXT)}function ct(u,i){var O="";return i<u.length&&(O=u.charAt(i)),O}function Ze(u){var i=this;if(this.error)throw this.error;if(i.closed)return me(i,"Cannot write after close. Assign an onready handler.");if(u===null)return Oe(i);typeof u=="object"&&(u=u.toString());for(var O=0,T="";T=ct(u,O++),i.c=T,!!T;)switch(i.trackPosition&&(i.position++,T===`
`?(i.line++,i.column=0):i.column++),i.state){case S.BEGIN:if(i.state=S.BEGIN_WHITESPACE,T==="\uFEFF")continue;It(i,T);continue;case S.BEGIN_WHITESPACE:It(i,T);continue;case S.TEXT:if(i.sawRoot&&!i.closedRoot){for(var ce=O-1;T&&T!=="<"&&T!=="&";)T=ct(u,O++),T&&i.trackPosition&&(i.position++,T===`
`?(i.line++,i.column=0):i.column++);i.textNode+=u.substring(ce,O-1)}T==="<"&&!(i.sawRoot&&i.closedRoot&&!i.strict)?(i.state=S.OPEN_WAKA,i.startTagPosition=i.position):(!Y(T)&&(!i.sawRoot||i.closedRoot)&&he(i,"Text data outside of root node."),T==="&"?i.state=S.TEXT_ENTITY:i.textNode+=T);continue;case S.SCRIPT:T==="<"?i.state=S.SCRIPT_ENDING:i.script+=T;continue;case S.SCRIPT_ENDING:T==="/"?i.state=S.CLOSE_TAG:(i.script+="<"+T,i.state=S.SCRIPT);continue;case S.OPEN_WAKA:if(T==="!")i.state=S.SGML_DECL,i.sgmlDecl="";else if(!Y(T))if(oe(z,T))i.state=S.OPEN_TAG,i.tagName=T;else if(T==="/")i.state=S.CLOSE_TAG,i.tagName="";else if(T==="?")i.state=S.PROC_INST,i.procInstName=i.procInstBody="";else{if(he(i,"Unencoded <"),i.startTagPosition+1<i.position){var Z=i.position-i.startTagPosition;T=new Array(Z).join(" ")+T}i.textNode+="<"+T,i.state=S.TEXT}continue;case S.SGML_DECL:if(i.sgmlDecl+T==="--"){i.state=S.COMMENT,i.comment="",i.sgmlDecl="";continue}i.doctype&&i.doctype!==!0&&i.sgmlDecl?(i.state=S.DOCTYPE_DTD,i.doctype+="<!"+i.sgmlDecl+T,i.sgmlDecl=""):(i.sgmlDecl+T).toUpperCase()===$?(de(i,"onopencdata"),i.state=S.CDATA,i.sgmlDecl="",i.cdata=""):(i.sgmlDecl+T).toUpperCase()===ne?(i.state=S.DOCTYPE,(i.doctype||i.sawRoot)&&he(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):T===">"?(de(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=S.TEXT):(ie(T)&&(i.state=S.SGML_DECL_QUOTED),i.sgmlDecl+=T);continue;case S.SGML_DECL_QUOTED:T===i.q&&(i.state=S.SGML_DECL,i.q=""),i.sgmlDecl+=T;continue;case S.DOCTYPE:T===">"?(i.state=S.TEXT,de(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=T,T==="["?i.state=S.DOCTYPE_DTD:ie(T)&&(i.state=S.DOCTYPE_QUOTED,i.q=T));continue;case S.DOCTYPE_QUOTED:i.doctype+=T,T===i.q&&(i.q="",i.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:T==="]"?(i.doctype+=T,i.state=S.DOCTYPE):T==="<"?(i.state=S.OPEN_WAKA,i.startTagPosition=i.position):ie(T)?(i.doctype+=T,i.state=S.DOCTYPE_DTD_QUOTED,i.q=T):i.doctype+=T;continue;case S.DOCTYPE_DTD_QUOTED:i.doctype+=T,T===i.q&&(i.state=S.DOCTYPE_DTD,i.q="");continue;case S.COMMENT:T==="-"?i.state=S.COMMENT_ENDING:i.comment+=T;continue;case S.COMMENT_ENDING:T==="-"?(i.state=S.COMMENT_ENDED,i.comment=se(i.opt,i.comment),i.comment&&de(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+T,i.state=S.COMMENT);continue;case S.COMMENT_ENDED:T!==">"?(he(i,"Malformed comment"),i.comment+="--"+T,i.state=S.COMMENT):i.doctype&&i.doctype!==!0?i.state=S.DOCTYPE_DTD:i.state=S.TEXT;continue;case S.CDATA:T==="]"?i.state=S.CDATA_ENDING:i.cdata+=T;continue;case S.CDATA_ENDING:T==="]"?i.state=S.CDATA_ENDING_2:(i.cdata+="]"+T,i.state=S.CDATA);continue;case S.CDATA_ENDING_2:T===">"?(i.cdata&&de(i,"oncdata",i.cdata),de(i,"onclosecdata"),i.cdata="",i.state=S.TEXT):T==="]"?i.cdata+="]":(i.cdata+="]]"+T,i.state=S.CDATA);continue;case S.PROC_INST:T==="?"?i.state=S.PROC_INST_ENDING:Y(T)?i.state=S.PROC_INST_BODY:i.procInstName+=T;continue;case S.PROC_INST_BODY:if(!i.procInstBody&&Y(T))continue;T==="?"?i.state=S.PROC_INST_ENDING:i.procInstBody+=T;continue;case S.PROC_INST_ENDING:T===">"?(de(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=S.TEXT):(i.procInstBody+="?"+T,i.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:oe(ae,T)?i.tagName+=T:($e(i),T===">"?qe(i):T==="/"?i.state=S.OPEN_TAG_SLASH:(Y(T)||he(i,"Invalid character in tag name"),i.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:T===">"?(qe(i,!0),Ct(i)):(he(i,"Forward-slash in opening tag not followed by >"),i.state=S.ATTRIB);continue;case S.ATTRIB:if(Y(T))continue;T===">"?qe(i):T==="/"?i.state=S.OPEN_TAG_SLASH:oe(z,T)?(i.attribName=T,i.attribValue="",i.state=S.ATTRIB_NAME):he(i,"Invalid attribute name");continue;case S.ATTRIB_NAME:T==="="?i.state=S.ATTRIB_VALUE:T===">"?(he(i,"Attribute without value"),i.attribValue=i.attribName,Me(i),qe(i)):Y(T)?i.state=S.ATTRIB_NAME_SAW_WHITE:oe(ae,T)?i.attribName+=T:he(i,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if(T==="=")i.state=S.ATTRIB_VALUE;else{if(Y(T))continue;he(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",de(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",T===">"?qe(i):oe(z,T)?(i.attribName=T,i.state=S.ATTRIB_NAME):(he(i,"Invalid attribute name"),i.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(Y(T))continue;ie(T)?(i.q=T,i.state=S.ATTRIB_VALUE_QUOTED):(i.opt.unquotedAttributeValues||me(i,"Unquoted attribute value"),i.state=S.ATTRIB_VALUE_UNQUOTED,i.attribValue=T);continue;case S.ATTRIB_VALUE_QUOTED:if(T!==i.q){T==="&"?i.state=S.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=T;continue}Me(i),i.q="",i.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:Y(T)?i.state=S.ATTRIB:T===">"?qe(i):T==="/"?i.state=S.OPEN_TAG_SLASH:oe(z,T)?(he(i,"No whitespace between attributes"),i.attribName=T,i.attribValue="",i.state=S.ATTRIB_NAME):he(i,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(!fe(T)){T==="&"?i.state=S.ATTRIB_VALUE_ENTITY_U:i.attribValue+=T;continue}Me(i),T===">"?qe(i):i.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(i.tagName)T===">"?Ct(i):oe(ae,T)?i.tagName+=T:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=S.SCRIPT):(Y(T)||he(i,"Invalid tagname in closing tag"),i.state=S.CLOSE_TAG_SAW_WHITE);else{if(Y(T))continue;Ne(z,T)?i.script?(i.script+="</"+T,i.state=S.SCRIPT):he(i,"Invalid tagname in closing tag."):i.tagName=T}continue;case S.CLOSE_TAG_SAW_WHITE:if(Y(T))continue;T===">"?Ct(i):he(i,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var ye,Pe;switch(i.state){case S.TEXT_ENTITY:ye=S.TEXT,Pe="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:ye=S.ATTRIB_VALUE_QUOTED,Pe="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:ye=S.ATTRIB_VALUE_UNQUOTED,Pe="attribValue";break}if(T===";"){var we=Je(i);i.opt.unparsedEntities&&!Object.values(l.XML_ENTITIES).includes(we)?(i.entity="",i.state=ye,i.write(we)):(i[Pe]+=we,i.entity="",i.state=ye)}else oe(i.entity.length?J:be,T)?i.entity+=T:(he(i,"Invalid character in entity name"),i[Pe]+="&"+i.entity+T,i.entity="",i.state=ye);continue;default:throw new Error(i,"Unknown state: "+i.state)}return i.position>=i.bufferCheckPosition&&k(i),i}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var u=String.fromCharCode,i=Math.floor,O=function(){var T=16384,ce=[],Z,ye,Pe=-1,we=arguments.length;if(!we)return"";for(var et="";++Pe<we;){var xe=Number(arguments[Pe]);if(!isFinite(xe)||xe<0||xe>1114111||i(xe)!==xe)throw RangeError("Invalid code point: "+xe);xe<=65535?ce.push(xe):(xe-=65536,Z=(xe>>10)+55296,ye=xe%1024+56320,ce.push(Z,ye)),(Pe+1===we||ce.length>T)&&(et+=u.apply(null,ce),ce.length=0)}return et};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:O,configurable:!0,writable:!0}):String.fromCodePoint=O}()})(s)}(ua)),ua}var ni=ti();const zt={};function ri(s){const{parentId:l,child:h}=s;zt[l]||(zt[l]=[]);const p={id:h.id,tagName:h.tagName};zt[l].push(p)}function ai(s){const{currentBatch:l}=s,h=[...l];for(const[p,k]of h.entries()){const D=zt[k.id]||[];D.length>0&&(h[p].children.push(...D),oi({parentId:k.id}))}return h}function oi(s){const{parentId:l}=s;delete zt[l]}function ii(s){return"prefix"in s&&"uri"in s&&!!s.prefix&&!!s.uri}const si=[".fsd",".asd",".ssd",".scd",".isd",".icd",".xml"],Ht="sclElements",fa="id, tagName, &attributes.uuid, &attributes.id, attributes.name, parent.id, parent.tagName, *children.id, *children.tagName",ui="attachedFiles",ci="id, filename, file",Ca={default:{prefix:"",uri:"http://www.iec.ch/61850/2003/SCL"}};function li(s){return s!==null&&typeof s=="object"&&"namespace"in s&&s.namespace!==null}function fi(){let s={defaultNamespace:null,stack:[],recordsBatch:[]};const l=ni.parser(!0,{lowercase:!1,trim:!0,normalize:!0,position:!1,xmlns:!0});l.onopentag=k=>s=di({node:k,state:s}),l.ontext=k=>s=pi({text:k,state:s}),l.onclosetag=()=>({updatedState:s}=hi({state:s})),l.onerror=mi;function h(){const k=s.recordsBatch;return s.recordsBatch=[],k}function p(){return s.recordsBatch.length}return{parser:l,drainBatch:h,getSize:p}}function di(s){const{node:l,state:h}=s,p={...h},k=yi(l);p.defaultNamespace||(p.defaultNamespace=vi(l));const D=gi(l,p.defaultNamespace),K=bi(l.attributes),F=wi(h.stack),q={id:crypto.randomUUID(),tagName:k,namespace:D,attributes:K,value:"",parent:F,children:[]};return p.stack.push(q),p}function pi(s){const{text:l,state:h}=s;return l&&h.stack.length>0&&(h.stack[h.stack.length-1].value+=l),h}function hi(s){const{state:l}=s,h=l.stack.at(-1);let p=l.stack.slice(0,-1);const k=[...l.recordsBatch];if(h){if(p.length){const D=p.length-1;p=p.map((K,F)=>F===D?{...K,children:[...K.children,{id:h.id,tagName:h.tagName}]}:K)}else h.parent&&ri({parentId:h.parent.id,child:{id:h.id,tagName:h.tagName}});k.push(h)}return{updatedState:{defaultNamespace:l.defaultNamespace,stack:p,recordsBatch:k}}}function mi(s){return new Error(`XML parsing error: ${s}`)}function yi(s){return s.local||null}function vi(s){if(s.name!=="SCL")throw new Error("Default namespace can only be set on SCL element");return s.attributes?.xmlns?.value?{prefix:"",uri:s.attributes.xmlns.value}:Ca.default}function gi(s,l){return ii(s)?{prefix:s.prefix,uri:s.uri}:l}function bi(s){return Object.values(s).map(l=>{const h=l.prefix&&l.uri?{prefix:l.prefix,uri:l.uri}:void 0;return{name:l.name,value:l.value,...h&&{namespace:h}}})}function wi(s){if(s.length===0)return null;const l=s[s.length-1];return l?{id:l.id,tagName:l.tagName}:null}var vr={exports:{}},_i=vr.exports,da;function Ei(){return da||(da=1,function(s,l){(function(h,p){s.exports=p()})(_i,function(){var h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])})(e,t)},p=function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function k(e,t,n){for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||((r=r||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var D=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ho,K=Object.keys,F=Array.isArray;function q(e,t){return typeof t!="object"||K(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||D.Promise||(D.Promise=Promise);var Q=Object.getPrototypeOf,H={}.hasOwnProperty;function $(e,t){return H.call(e,t)}function ne(e,t){typeof t=="function"&&(t=t(Q(e))),(typeof Reflect>"u"?K:Reflect.ownKeys)(t).forEach(function(n){I(e,n,t[n])})}var G=Object.defineProperty;function I(e,t,n,r){G(e,t,q(n&&$(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function C(e){return{from:function(t){return e.prototype=Object.create(t.prototype),I(e.prototype,"constructor",e),{extend:ne.bind(null,e.prototype)}}}}var z=Object.getOwnPropertyDescriptor,ae=[].slice;function be(e,t,n){return ae.call(e,t,n)}function J(e,t){return t(e)}function Y(e){if(!e)throw new Error("Assertion Failed")}function ie(e){D.setImmediate?setImmediate(e):setTimeout(e,0)}function fe(e,t){if(typeof t=="string"&&$(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,a=t.length;r<a;++r){var o=fe(e,t[r]);n.push(o)}return n}var c=t.indexOf(".");if(c!==-1){var f=e[t.substr(0,c)];return f==null?void 0:fe(f,t.substr(c+1))}}function oe(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Y(typeof n!="string"&&"length"in n);for(var r=0,a=t.length;r<a;++r)oe(e,t[r],n[r])}else{var o,c,f=t.indexOf(".");f!==-1?(o=t.substr(0,f),(c=t.substr(f+1))===""?n===void 0?F(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n:oe(f=!(f=e[o])||!$(e,o)?e[o]={}:f,c,n)):n===void 0?F(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Ne(e){var t,n={};for(t in e)$(e,t)&&(n[t]=e[t]);return n}var S=[].concat;function ut(e){return S.apply([],e)}var lt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ut([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return D[e]}),Ue=new Set(lt.map(function(e){return D[e]})),de=null;function De(e){return de=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var r=de.get(n);if(r)return r;if(F(n)){r=[],de.set(n,r);for(var a=0,o=n.length;a<o;++a)r.push(t(n[a]))}else if(Ue.has(n.constructor))r=n;else{var c,f=Q(n);for(c in r=f===Object.prototype?{}:Object.create(f),de.set(n,r),n)$(n,c)&&(r[c]=t(n[c]))}return r}(e),de=null,e}var se={}.toString;function me(e){return se.call(e).slice(8,-1)}var Oe=typeof Symbol<"u"?Symbol.iterator:"@@iterator",he=typeof Oe=="symbol"?function(e){var t;return e!=null&&(t=e[Oe])&&t.apply(e)}:function(){return null};function $e(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Ve={};function Me(e){var t,n,r,a;if(arguments.length===1){if(F(e))return e.slice();if(this===Ve&&typeof e=="string")return[e];if(a=he(e)){for(n=[];!(r=a.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var qe=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ft=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ke=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ft),Ct={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Je(e,t){this.name=e,this.message=t}function It(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,a){return a.indexOf(n)===r}).join(`
`)}function ct(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=It(e,t)}function Ze(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=It(e,this.failures)}C(Je).from(Error).extend({toString:function(){return this.name+": "+this.message}}),C(ct).from(Je),C(Ze).from(Je);var u=Ke.reduce(function(e,t){return e[t]=t+"Error",e},{}),i=Je,O=Ke.reduce(function(e,t){var n=t+"Error";function r(a,o){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(o?`
 `+o:""),this.inner=o||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=Ct[t]||n,this.inner=null)}return C(r).from(i),e[t]=r,e},{});O.Syntax=SyntaxError,O.Type=TypeError,O.Range=RangeError;var T=Ft.reduce(function(e,t){return e[t+"Error"]=O[t],e},{}),ce=Ke.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=O[t]),e},{});function Z(){}function ye(e){return e}function Pe(e,t){return e==null||e===ye?t:function(n){return t(e(n))}}function we(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function et(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?we(r,this.onsuccess):r),a&&(this.onerror=this.onerror?we(a,this.onerror):a),o!==void 0?o:n}}function xe(e,t){return e===Z?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?we(n,this.onsuccess):n),r&&(this.onerror=this.onerror?we(r,this.onerror):r)}}function je(e,t){return e===Z?t:function(n){var r=e.apply(this,arguments);q(n,r);var a=this.onsuccess,o=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?we(a,this.onsuccess):a),o&&(this.onerror=this.onerror?we(o,this.onerror):o),r===void 0?n===void 0?void 0:n:q(r,n)}}function Cn(e,t){return e===Z?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function _t(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,a=arguments.length,o=new Array(a);a--;)o[a]=arguments[a];return n.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}ce.ModifyError=ct,ce.DexieError=Je,ce.BulkError=Ze;var Be=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function kt(e){Be=e}var Dt={},xr=100,lt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Q(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Q(t),e]}(),Ft=lt[0],Ke=lt[1],lt=lt[2],Ke=Ke&&Ke.then,ft=Ft&&Ft.constructor,In=!!lt,Bt=function(e,t){Mt.push([e,t]),Jt&&(queueMicrotask(Ba),Jt=!1)},kn=!0,Jt=!0,dt=[],Zt=[],Dn=ye,tt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Z,pgp:!1,env:{},finalize:Z},X=tt,Mt=[],pt=0,en=[];function V(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=X;if(typeof e!="function"){if(e!==Dt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Bn(this,this._value))}this._state=null,this._value=null,++t.ref,function n(r,a){try{a(function(o){if(r._state===null){if(o===r)throw new TypeError("A promise cannot be resolved with itself.");var c=r._lib&&Et();o&&typeof o.then=="function"?n(r,function(f,m){o instanceof V?o._then(f,m):o.then(f,m)}):(r._state=!0,r._value=o,Sr(r)),c&&Tt()}},Bn.bind(null,r))}catch(o){Bn(r,o)}}(this,e)}var Fn={get:function(){var e=X,t=an;function n(r,a){var o=this,c=!e.global&&(e!==X||t!==an),f=c&&!rt(),m=new V(function(v,b){Mn(o,new Or(Nr(r,e,c,f),Nr(a,e,c,f),v,b,e))});return this._consoleTask&&(m._consoleTask=this._consoleTask),m}return n.prototype=Dt,n},set:function(e){I(this,"then",e&&e.prototype===Dt?Fn:{get:function(){return e},set:Fn.set})}};function Or(e,t,n,r,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=a}function Bn(e,t){var n,r;Zt.push(t),e._state===null&&(n=e._lib&&Et(),t=Dn(t),e._state=!1,e._value=t,r=e,dt.some(function(a){return a._value===r._value})||dt.push(r),Sr(e),n&&Tt())}function Sr(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Mn(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),pt===0&&(++pt,Bt(function(){--pt==0&&Rn()},[]))}function Mn(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++pt,Bt(Fa,[n,e,t])}else e._listeners.push(t)}function Fa(e,t,n){try{var r,a=t._value;!t._state&&Zt.length&&(Zt=[]),r=Be&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),t._state||Zt.indexOf(a)!==-1||function(o){for(var c=dt.length;c;)if(dt[--c]._value===o._value)return dt.splice(c,1)}(t),n.resolve(r)}catch(o){n.reject(o)}finally{--pt==0&&Rn(),--n.psd.ref||n.psd.finalize()}}function Ba(){ht(tt,function(){Et()&&Tt()})}function Et(){var e=kn;return Jt=kn=!1,e}function Tt(){var e,t,n;do for(;0<Mt.length;)for(e=Mt,Mt=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<Mt.length);Jt=kn=!0}function Rn(){var e=dt;dt=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=en.slice(0),n=t.length;n;)t[--n]()}function tn(e){return new V(Dt,!1,e)}function ge(e,t){var n=X;return function(){var r=Et(),a=X;try{return at(n,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{at(a,!1),r&&Tt()}}}ne(V.prototype,{then:Fn,_then:function(e,t){Mn(this,new Or(null,null,e,t,X))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:tn)(r)}):this.then(null,function(r){return(r&&r.name===t?n:tn)(r)})},finally:function(e){return this.then(function(t){return V.resolve(e()).then(function(){return t})},function(t){return V.resolve(e()).then(function(){return tn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new V(function(r,a){var o=setTimeout(function(){return a(new O.Timeout(t))},e);n.then(r,a).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&I(V.prototype,Symbol.toStringTag,"Dexie.Promise"),tt.env=Ar(),ne(V,{all:function(){var e=Me.apply(null,arguments).map(on);return new V(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(a,o){return V.resolve(a).then(function(c){e[o]=c,--r||t(e)},n)})})},resolve:function(e){return e instanceof V?e:e&&typeof e.then=="function"?new V(function(t,n){e.then(t,n)}):new V(Dt,!0,e)},reject:tn,race:function(){var e=Me.apply(null,arguments).map(on);return new V(function(t,n){e.map(function(r){return V.resolve(r).then(t,n)})})},PSD:{get:function(){return X},set:function(e){return X=e}},totalEchoes:{get:function(){return an}},newPSD:nt,usePSD:ht,scheduler:{get:function(){return Bt},set:function(e){Bt=e}},rejectionMapper:{get:function(){return Dn},set:function(e){Dn=e}},follow:function(e,t){return new V(function(n,r){return nt(function(a,o){var c=X;c.unhandleds=[],c.onunhandled=o,c.finalize=we(function(){var f,m=this;f=function(){m.unhandleds.length===0?a():o(m.unhandleds[0])},en.push(function v(){f(),en.splice(en.indexOf(v),1)}),++pt,Bt(function(){--pt==0&&Rn()},[])},c.finalize),e()},t,n,r)})}}),ft&&(ft.allSettled&&I(V,"allSettled",function(){var e=Me.apply(null,arguments).map(on);return new V(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(a,o){return V.resolve(a).then(function(c){return r[o]={status:"fulfilled",value:c}},function(c){return r[o]={status:"rejected",reason:c}}).then(function(){return--n||t(r)})})})}),ft.any&&typeof AggregateError<"u"&&I(V,"any",function(){var e=Me.apply(null,arguments).map(on);return new V(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,a=new Array(r);e.forEach(function(o,c){return V.resolve(o).then(function(f){return t(f)},function(f){a[c]=f,--r||n(new AggregateError(a))})})})}),ft.withResolvers&&(V.withResolvers=ft.withResolvers));var Se={awaits:0,echoes:0,id:0},Ma=0,nn=[],rn=0,an=0,Ra=0;function nt(e,t,n,r){var a=X,o=Object.create(a);return o.parent=a,o.ref=0,o.global=!1,o.id=++Ra,tt.env,o.env=In?{Promise:V,PromiseProp:{value:V,configurable:!0,writable:!0},all:V.all,race:V.race,allSettled:V.allSettled,any:V.any,resolve:V.resolve,reject:V.reject}:{},t&&q(o,t),++a.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()},r=ht(o,e,n,r),o.ref===0&&o.finalize(),r}function xt(){return Se.id||(Se.id=++Ma),++Se.awaits,Se.echoes+=xr,Se.id}function rt(){return!!Se.awaits&&(--Se.awaits==0&&(Se.id=0),Se.echoes=Se.awaits*xr,!0)}function on(e){return Se.echoes&&e&&e.constructor===ft?(xt(),e.then(function(t){return rt(),t},function(t){return rt(),Ee(t)})):e}function Ka(){var e=nn[nn.length-1];nn.pop(),at(e,!1)}function at(e,t){var n,r=X;(t?!Se.echoes||rn++&&e===X:!rn||--rn&&e===X)||queueMicrotask(t?(function(a){++an,Se.echoes&&--Se.echoes!=0||(Se.echoes=Se.awaits=Se.id=0),nn.push(X),at(a,!0)}).bind(null,e):Ka),e!==X&&(X=e,r===tt&&(tt.env=Ar()),In&&(n=tt.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(D,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Ar(){var e=D.Promise;return In?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(D,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ht(e,t,n,r,a){var o=X;try{return at(e,!0),t(n,r,a)}finally{at(o,!1)}}function Nr(e,t,n,r){return typeof e!="function"?e:function(){var a=X;n&&xt(),at(t,!0);try{return e.apply(this,arguments)}finally{at(a,!1),r&&queueMicrotask(rt)}}}function Kn(e){Promise===ft&&Se.echoes===0?rn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Ke).indexOf("[native code]")===-1&&(xt=rt=Z);var Ee=V.reject,mt="￿",Ye="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Pr="String expected.",Ot=[],sn="__dbnames",qn="readonly",jn="readwrite";function yt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Cr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function un(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=De(t))[e],t}}function Ir(){throw O.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ue(e,t){try{var n=kr(e),r=kr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(a,o){for(var c=a.length,f=o.length,m=c<f?c:f,v=0;v<m;++v)if(a[v]!==o[v])return a[v]<o[v]?-1:1;return c===f?0:c<f?-1:1}(Dr(e),Dr(t));case"Array":return function(a,o){for(var c=a.length,f=o.length,m=c<f?c:f,v=0;v<m;++v){var b=ue(a[v],o[v]);if(b!==0)return b}return c===f?0:c<f?-1:1}(e,t)}}catch{}return NaN}function kr(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=me(e),e==="ArrayBuffer"?"binary":e)}function Dr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function cn(e,t,n){var r=e.schema.yProps;return r?(t&&0<n.numFailures&&(t=t.filter(function(a,o){return!n.failures[o]})),Promise.all(r.map(function(a){return a=a.updatesTable,t?e.db.table(a).where("k").anyOf(t).delete():e.db.table(a).clear()})).then(function(){return n})):n}var Fr=(ve.prototype._trans=function(e,t,n){var r=this._tx||X.trans,a=this.name,o=Be&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function c(v,b,d){if(!d.schema[a])throw new O.NotFound("Table "+a+" not part of transaction");return t(d.idbtrans,d)}var f=Et();try{var m=r&&r.db._novip===this.db._novip?r===X.trans?r._promise(e,c,n):nt(function(){return r._promise(e,c,n)},{trans:r,transless:X.transless||X}):function v(b,d,E,y){if(b.idbdb&&(b._state.openComplete||X.letThrough||b._vip)){var g=b._createTransaction(d,E,b._dbSchema);try{g.create(),b._state.PR1398_maxLoop=3}catch(_){return _.name===u.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return v(b,d,E,y)})):Ee(_)}return g._promise(d,function(_,w){return nt(function(){return X.trans=g,y(_,w,g)})}).then(function(_){if(d==="readwrite")try{g.idbtrans.commit()}catch{}return d==="readonly"?_:g._completion.then(function(){return _})})}if(b._state.openComplete)return Ee(new O.DatabaseClosed(b._state.dbOpenError));if(!b._state.isBeingOpened){if(!b._state.autoOpen)return Ee(new O.DatabaseClosed);b.open().catch(Z)}return b._state.dbReadyPromise.then(function(){return v(b,d,E,y)})}(this.db,e,[this.name],c);return o&&(m._consoleTask=o,m=m.catch(function(v){return console.trace(v),Ee(v)})),m}finally{f&&Tt()}},ve.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Ee(new O.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(a){return n.hook.reading.fire(a)})}).then(t)},ve.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(F(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=K(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(f){if(f.compound&&t.every(function(v){return 0<=f.keyPath.indexOf(v)})){for(var m=0;m<t.length;++m)if(t.indexOf(f.keyPath[m])===-1)return!1;return!0}return!1}).sort(function(f,m){return f.keyPath.length-m.keyPath.length})[0];if(n&&this.db._maxKey!==mt){var o=n.keyPath.slice(0,t.length);return this.where(o).equals(o.map(function(m){return e[m]}))}!n&&Be&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName;function a(f,m){return ue(f,m)===0}var c=t.reduce(function(d,m){var v=d[0],b=d[1],d=r[m],E=e[m];return[v||d,v||!d?yt(b,d&&d.multi?function(y){return y=fe(y,m),F(y)&&y.some(function(g){return a(E,g)})}:function(y){return a(E,fe(y,m))}):b]},[null,null]),o=c[0],c=c[1];return o?this.where(o.name).equals(e[o.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")},ve.prototype.filter=function(e){return this.toCollection().and(e)},ve.prototype.count=function(e){return this.toCollection().count(e)},ve.prototype.offset=function(e){return this.toCollection().offset(e)},ve.prototype.limit=function(e){return this.toCollection().limit(e)},ve.prototype.each=function(e){return this.toCollection().each(e)},ve.prototype.toArray=function(e){return this.toCollection().toArray(e)},ve.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ve.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,F(e)?"[".concat(e.join("+"),"]"):e))},ve.prototype.reverse=function(){return this.toCollection().reverse()},ve.prototype.mapToClass=function(e){var t,n=this.db,r=this.name;function a(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Ir&&(function(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function b(){this.constructor=m}h(m,v),m.prototype=v===null?Object.create(v):(b.prototype=v.prototype,new b)}(a,t=e),Object.defineProperty(a.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),a.prototype.table=function(){return r},e=a);for(var o=new Set,c=e.prototype;c;c=Q(c))Object.getOwnPropertyNames(c).forEach(function(m){return o.add(m)});function f(m){if(!m)return m;var v,b=Object.create(e.prototype);for(v in m)if(!o.has(v))try{b[v]=m[v]}catch{}return b}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=f,this.hook("reading",f),e},ve.prototype.defineClass=function(){return this.mapToClass(function(e){q(this,e)})},ve.prototype.add=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,o=r.keyPath,c=e;return o&&a&&(c=un(o)(e)),this._trans("readwrite",function(f){return n.core.mutate({trans:f,type:"add",keys:t!=null?[t]:null,values:[c]})}).then(function(f){return f.numFailures?V.reject(f.failures[0]):f.lastResult}).then(function(f){if(o)try{oe(e,o,f)}catch{}return f})},ve.prototype.update=function(e,t){return typeof e!="object"||F(e)?this.where(":id").equals(e).modify(t):(e=fe(e,this.schema.primKey.keyPath),e===void 0?Ee(new O.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},ve.prototype.put=function(e,t){var n=this,r=this.schema.primKey,a=r.auto,o=r.keyPath,c=e;return o&&a&&(c=un(o)(e)),this._trans("readwrite",function(f){return n.core.mutate({trans:f,type:"put",values:[c],keys:t!=null?[t]:null})}).then(function(f){return f.numFailures?V.reject(f.failures[0]):f.lastResult}).then(function(f){if(o)try{oe(e,o,f)}catch{}return f})},ve.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(r){return cn(t,[e],r)}).then(function(r){return r.numFailures?V.reject(r.failures[0]):void 0})})},ve.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Cr}).then(function(n){return cn(e,null,n)})}).then(function(t){return t.numFailures?V.reject(t.failures[0]):void 0})},ve.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(a){return t.hook.reading.fire(a)})})})},ve.prototype.bulkAdd=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,o=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var v=r.schema.primKey,f=v.auto,v=v.keyPath;if(v&&a)throw new O.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new O.InvalidArgument("Arguments objects and keys must have the same length");var m=e.length,v=v&&f?e.map(un(v)):e;return r.core.mutate({trans:c,type:"add",keys:a,values:v,wantResults:o}).then(function(g){var d=g.numFailures,E=g.results,y=g.lastResult,g=g.failures;if(d===0)return o?E:y;throw new Ze("".concat(r.name,".bulkAdd(): ").concat(d," of ").concat(m," operations failed"),g)})})},ve.prototype.bulkPut=function(e,t,n){var r=this,a=Array.isArray(t)?t:void 0,o=(n=n||(a?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var v=r.schema.primKey,f=v.auto,v=v.keyPath;if(v&&a)throw new O.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new O.InvalidArgument("Arguments objects and keys must have the same length");var m=e.length,v=v&&f?e.map(un(v)):e;return r.core.mutate({trans:c,type:"put",keys:a,values:v,wantResults:o}).then(function(g){var d=g.numFailures,E=g.results,y=g.lastResult,g=g.failures;if(d===0)return o?E:y;throw new Ze("".concat(r.name,".bulkPut(): ").concat(d," of ").concat(m," operations failed"),g)})})},ve.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(c){return c.key}),a=e.map(function(c){return c.changes}),o=[];return this._trans("readwrite",function(c){return n.getMany({trans:c,keys:r,cache:"clone"}).then(function(f){var m=[],v=[];e.forEach(function(d,E){var y=d.key,g=d.changes,_=f[E];if(_){for(var w=0,x=Object.keys(g);w<x.length;w++){var A=x[w],N=g[A];if(A===t.schema.primKey.keyPath){if(ue(N,y)!==0)throw new O.Constraint("Cannot update primary key in bulkUpdate()")}else oe(_,A,N)}o.push(E),m.push(y),v.push(_)}});var b=m.length;return n.mutate({trans:c,type:"put",keys:m,values:v,updates:{keys:r,changeSpecs:a}}).then(function(d){var E=d.numFailures,y=d.failures;if(E===0)return b;for(var g=0,_=Object.keys(y);g<_.length;g++){var w,x=_[g],A=o[Number(x)];A!=null&&(w=y[x],delete y[x],y[A]=w)}throw new Ze("".concat(t.name,".bulkUpdate(): ").concat(E," of ").concat(b," operations failed"),y)})})})},ve.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e}).then(function(a){return cn(t,e,a)})}).then(function(c){var a=c.numFailures,o=c.lastResult,c=c.failures;if(a===0)return o;throw new Ze("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(n," operations failed"),c)})},ve);function ve(){}function Rt(e){function t(c,f){if(f){for(var m=arguments.length,v=new Array(m-1);--m;)v[m-1]=arguments[m];return n[c].subscribe.apply(null,v),e}if(typeof c=="string")return n[c]}var n={};t.addEventType=o;for(var r=1,a=arguments.length;r<a;++r)o(arguments[r]);return t;function o(c,f,m){if(typeof c!="object"){var v;f=f||Cn;var b={subscribers:[],fire:m=m||Z,subscribe:function(d){b.subscribers.indexOf(d)===-1&&(b.subscribers.push(d),b.fire=f(b.fire,d))},unsubscribe:function(d){b.subscribers=b.subscribers.filter(function(E){return E!==d}),b.fire=b.subscribers.reduce(f,m)}};return n[c]=t[c]=b}K(v=c).forEach(function(d){var E=v[d];if(F(E))o(d,v[d][0],v[d][1]);else{if(E!=="asap")throw new O.InvalidArgument("Invalid event config");var y=o(d,ye,function(){for(var g=arguments.length,_=new Array(g);g--;)_[g]=arguments[g];y.subscribers.forEach(function(w){ie(function(){w.apply(null,_)})})})}})}}function Kt(e,t){return C(t).from({prototype:e}),t}function St(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Ln(e,t){e.filter=yt(e.filter,t)}function Un(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return yt(r(),t())}:t,e.justLimit=n&&!r}function ln(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new O.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Br(e,t,n){var r=ln(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function fn(e,t,n,r){var a=e.replayFilter?yt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},c=function(f,m,v){var b,d;a&&!a(m,v,function(E){return m.stop(E)},function(E){return m.fail(E)})||((d=""+(b=m.primaryKey))=="[object ArrayBuffer]"&&(d=""+new Uint8Array(b)),$(o,d)||(o[d]=!0,t(f,m,v)))};return Promise.all([e.or._iterate(c,n),Mr(Br(e,r,n),e.algorithm,c,!e.keysOnly&&e.valueMapper)])}return Mr(Br(e,r,n),yt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function Mr(e,t,n,r){var a=ge(r?function(o,c,f){return n(r(o),c,f)}:n);return e.then(function(o){if(o)return o.start(function(){var c=function(){return o.continue()};t&&!t(o,function(f){return c=f},function(f){o.stop(f),c=Z},function(f){o.fail(f),c=Z})||a(o.value,o,function(f){return c=f}),c()})})}var qt=(Rr.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(F(n))return k(k([],F(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var r=t.remove;if(F(r))return F(e)?e.filter(function(a){return!r.includes(a)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},Rr);function Rr(e){this["@@propmod"]=e}var qa=(pe.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Ee.bind(null,n.error)):n.table._trans("readonly",e).then(t)},pe.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Ee.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},pe.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=yt(t.algorithm,e)},pe.prototype._iterate=function(e,t){return fn(this._ctx,e,t,this._ctx.table.core)},pe.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&q(n,e),t._ctx=n,t},pe.prototype.raw=function(){return this._ctx.valueMapper=null,this},pe.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return fn(t,e,n,t.table.core)})},pe.prototype.count=function(e){var t=this;return this._read(function(n){var r=t._ctx,a=r.table.core;if(St(r,!0))return a.count({trans:n,query:{index:ln(r,a.schema),range:r.range}}).then(function(c){return Math.min(c,r.limit)});var o=0;return fn(r,function(){return++o,!1},n,a).then(function(){return o})}).then(e)},pe.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],a=n.length-1;function o(m,v){return v?o(m[n[v]],v-1):m[r]}var c=this._ctx.dir==="next"?1:-1;function f(m,v){return ue(o(m,a),o(v,a))*c}return this.toArray(function(m){return m.sort(f)}).then(t)},pe.prototype.toArray=function(e){var t=this;return this._read(function(n){var r=t._ctx;if(r.dir==="next"&&St(r,!0)&&0<r.limit){var a=r.valueMapper,o=ln(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:o,range:r.range}}).then(function(f){return f=f.result,a?f.map(a):f})}var c=[];return fn(r,function(f){return c.push(f)},n,r.table.core).then(function(){return c})},e)},pe.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,St(t)?Un(t,function(){var n=e;return function(r,a){return n===0||(n===1?--n:a(function(){r.advance(n),n=0}),!1)}}):Un(t,function(){var n=e;return function(){return--n<0}})),this},pe.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Un(this._ctx,function(){var t=e;return function(n,r,a){return--t<=0&&r(a),0<=t}},!0),this},pe.prototype.until=function(e,t){return Ln(this._ctx,function(n,r,a){return!e(n.value)||(r(a),t)}),this},pe.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},pe.prototype.last=function(e){return this.reverse().first(e)},pe.prototype.filter=function(e){var t;return Ln(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=yt(t.isMatch,e),this},pe.prototype.and=function(e){return this.filter(e)},pe.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},pe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},pe.prototype.desc=function(){return this.reverse()},pe.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},pe.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},pe.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},pe.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,a){n.push(a.key)}).then(function(){return n}).then(e)},pe.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&St(t,!0)&&0<t.limit)return this._read(function(r){var a=ln(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,a){n.push(a.primaryKey)}).then(function(){return n}).then(e)},pe.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},pe.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},pe.prototype.lastKey=function(e){return this.reverse().firstKey(e)},pe.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return Ln(this._ctx,function(a){var r=a.primaryKey.toString(),a=$(t,r);return t[r]=!0,!a}),this},pe.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var a,o,c;c=typeof e=="function"?e:(a=K(e),o=a.length,function(x){for(var A=!1,N=0;N<o;++N){var P=a[N],B=e[P],j=fe(x,P);B instanceof qt?(oe(x,P,B.execute(j)),A=!0):j!==B&&(oe(x,P,B),A=!0)}return A});var f=n.table.core,d=f.schema.primaryKey,m=d.outbound,v=d.extractKey,b=200,d=t.db._options.modifyChunkSize;d&&(b=typeof d=="object"?d[f.name]||d["*"]||200:d);function E(x,P){var N=P.failures,P=P.numFailures;g+=x-P;for(var B=0,j=K(N);B<j.length;B++){var M=j[B];y.push(N[M])}}var y=[],g=0,_=[],w=e===Kr;return t.clone().primaryKeys().then(function(x){function A(P){var B=Math.min(b,x.length-P),j=x.slice(P,P+B);return(w?Promise.resolve([]):f.getMany({trans:r,keys:j,cache:"immutable"})).then(function(M){var R=[],U=[],L=m?[]:null,W=w?j:[];if(!w)for(var re=0;re<B;++re){var le=M[re],te={value:De(le),primKey:x[P+re]};c.call(te,te.value,te)!==!1&&(te.value==null?W.push(x[P+re]):m||ue(v(le),v(te.value))===0?(U.push(te.value),m&&L.push(x[P+re])):(W.push(x[P+re]),R.push(te.value)))}return Promise.resolve(0<R.length&&f.mutate({trans:r,type:"add",values:R}).then(function(_e){for(var ee in _e.failures)W.splice(parseInt(ee),1);E(R.length,_e)})).then(function(){return(0<U.length||N&&typeof e=="object")&&f.mutate({trans:r,type:"put",keys:L,values:U,criteria:N,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<P}).then(function(_e){return E(U.length,_e)})}).then(function(){return(0<W.length||N&&w)&&f.mutate({trans:r,type:"delete",keys:W,criteria:N,isAdditionalChunk:0<P}).then(function(_e){return cn(n.table,W,_e)}).then(function(_e){return E(W.length,_e)})}).then(function(){return x.length>P+B&&A(P+b)})})}var N=St(n)&&n.limit===1/0&&(typeof e!="function"||w)&&{index:n.index,range:n.range};return A(0).then(function(){if(0<y.length)throw new ct("Error modifying one or more objects",y,g,_);return x.length})})})},pe.prototype.delete=function(){var e=this._ctx,t=e.range;return!St(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Kr):this._write(function(n){var r=e.table.core.schema.primaryKey,a=t;return e.table.core.count({trans:n,query:{index:r,range:a}}).then(function(o){return e.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(function(m){var f=m.failures,m=m.numFailures;if(m)throw new ct("Could not delete some values",Object.keys(f).map(function(v){return f[v]}),o-m);return o-m})})})},pe);function pe(){}var Kr=function(e,t){return t.value=null};function ja(e,t){return e<t?-1:e===t?0:1}function La(e,t){return t<e?-1:e===t?0:1}function Re(e,t,n){return e=e instanceof jr?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function At(e){return new e.Collection(e,function(){return qr("")}).limit(0)}function dn(e,t,n,r){var a,o,c,f,m,v,b,d=n.length;if(!n.every(function(g){return typeof g=="string"}))return Re(e,Pr);function E(g){a=g==="next"?function(w){return w.toUpperCase()}:function(w){return w.toLowerCase()},o=g==="next"?function(w){return w.toLowerCase()}:function(w){return w.toUpperCase()},c=g==="next"?ja:La;var _=n.map(function(w){return{lower:o(w),upper:a(w)}}).sort(function(w,x){return c(w.lower,x.lower)});f=_.map(function(w){return w.upper}),m=_.map(function(w){return w.lower}),b=(v=g)==="next"?"":r}E("next"),e=new e.Collection(e,function(){return ot(f[0],m[d-1]+r)}),e._ondirectionchange=function(g){E(g)};var y=0;return e._addAlgorithm(function(g,_,w){var x=g.key;if(typeof x!="string")return!1;var A=o(x);if(t(A,m,y))return!0;for(var N=null,P=y;P<d;++P){var B=function(j,M,R,U,L,W){for(var re=Math.min(j.length,U.length),le=-1,te=0;te<re;++te){var _e=M[te];if(_e!==U[te])return L(j[te],R[te])<0?j.substr(0,te)+R[te]+R.substr(te+1):L(j[te],U[te])<0?j.substr(0,te)+U[te]+R.substr(te+1):0<=le?j.substr(0,le)+M[le]+R.substr(le+1):null;L(j[te],_e)<0&&(le=te)}return re<U.length&&W==="next"?j+R.substr(j.length):re<j.length&&W==="prev"?j.substr(0,R.length):le<0?null:j.substr(0,le)+U[le]+R.substr(le+1)}(x,A,f[P],m[P],c,v);B===null&&N===null?y=P+1:(N===null||0<c(N,B))&&(N=B)}return _(N!==null?function(){g.continue(N+b)}:w),!1}),e}function ot(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function qr(e){return{type:1,lower:e,upper:e}}var jr=(Object.defineProperty(Ae.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ae.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?At(this):new this.Collection(this,function(){return ot(e,t,!n,!r)})}catch{return Re(this,Ye)}},Ae.prototype.equals=function(e){return e==null?Re(this,Ye):new this.Collection(this,function(){return qr(e)})},Ae.prototype.above=function(e){return e==null?Re(this,Ye):new this.Collection(this,function(){return ot(e,void 0,!0)})},Ae.prototype.aboveOrEqual=function(e){return e==null?Re(this,Ye):new this.Collection(this,function(){return ot(e,void 0,!1)})},Ae.prototype.below=function(e){return e==null?Re(this,Ye):new this.Collection(this,function(){return ot(void 0,e,!1,!0)})},Ae.prototype.belowOrEqual=function(e){return e==null?Re(this,Ye):new this.Collection(this,function(){return ot(void 0,e)})},Ae.prototype.startsWith=function(e){return typeof e!="string"?Re(this,Pr):this.between(e,e+mt,!0,!0)},Ae.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):dn(this,function(t,n){return t.indexOf(n[0])===0},[e],mt)},Ae.prototype.equalsIgnoreCase=function(e){return dn(this,function(t,n){return t===n[0]},[e],"")},Ae.prototype.anyOfIgnoreCase=function(){var e=Me.apply(Ve,arguments);return e.length===0?At(this):dn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},Ae.prototype.startsWithAnyOfIgnoreCase=function(){var e=Me.apply(Ve,arguments);return e.length===0?At(this):dn(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,mt)},Ae.prototype.anyOf=function(){var e=this,t=Me.apply(Ve,arguments),n=this._cmp;try{t.sort(n)}catch{return Re(this,Ye)}if(t.length===0)return At(this);var r=new this.Collection(this,function(){return ot(t[0],t[t.length-1])});r._ondirectionchange=function(o){n=o==="next"?e._ascending:e._descending,t.sort(n)};var a=0;return r._addAlgorithm(function(o,c,f){for(var m=o.key;0<n(m,t[a]);)if(++a===t.length)return c(f),!1;return n(m,t[a])===0||(c(function(){o.continue(t[a])}),!1)}),r},Ae.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ae.prototype.noneOf=function(){var e=Me.apply(Ve,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Re(this,Ye)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Ae.prototype.inAnyRange=function(x,t){var n=this,r=this._cmp,a=this._ascending,o=this._descending,c=this._min,f=this._max;if(x.length===0)return At(this);if(!x.every(function(A){return A[0]!==void 0&&A[1]!==void 0&&a(A[0],A[1])<=0}))return Re(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",O.InvalidArgument);var m=!t||t.includeLowers!==!1,v=t&&t.includeUppers===!0,b,d=a;function E(A,N){return d(A[0],N[0])}try{(b=x.reduce(function(A,N){for(var P=0,B=A.length;P<B;++P){var j=A[P];if(r(N[0],j[1])<0&&0<r(N[1],j[0])){j[0]=c(j[0],N[0]),j[1]=f(j[1],N[1]);break}}return P===B&&A.push(N),A},[])).sort(E)}catch{return Re(this,Ye)}var y=0,g=v?function(A){return 0<a(A,b[y][1])}:function(A){return 0<=a(A,b[y][1])},_=m?function(A){return 0<o(A,b[y][0])}:function(A){return 0<=o(A,b[y][0])},w=g,x=new this.Collection(this,function(){return ot(b[0][0],b[b.length-1][1],!m,!v)});return x._ondirectionchange=function(A){d=A==="next"?(w=g,a):(w=_,o),b.sort(E)},x._addAlgorithm(function(A,N,P){for(var B,j=A.key;w(j);)if(++y===b.length)return N(P),!1;return!g(B=j)&&!_(B)||(n._cmp(j,b[y][1])===0||n._cmp(j,b[y][0])===0||N(function(){d===a?A.continue(b[y][0]):A.continue(b[y][1])}),!1)}),x},Ae.prototype.startsWithAnyOf=function(){var e=Me.apply(Ve,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?At(this):this.inAnyRange(e.map(function(t){return[t,t+mt]})):Re(this,"startsWithAnyOf() only works with strings")},Ae);function Ae(){}function We(e){return ge(function(t){return jt(t),e(t.target.error),!1})}function jt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Lt="storagemutated",Vn="x-storagemutated-1",it=Rt(null,Lt),Ua=(Ge.prototype._lock=function(){return Y(!X.global),++this._reculock,this._reculock!==1||X.global||(X.lockOwnerFor=this),this},Ge.prototype._unlock=function(){if(Y(!X.global),--this._reculock==0)for(X.global||(X.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{ht(e[1],e[0])}catch{}}return this},Ge.prototype._locked=function(){return this._reculock&&X.lockOwnerFor!==this},Ge.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(Y(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new O.DatabaseClosed(r);case"MissingAPIError":throw new O.MissingAPI(r.message,r);default:throw new O.OpenFailed(r)}if(!this.active)throw new O.TransactionInactive;return Y(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ge(function(a){jt(a),t._reject(e.error)}),e.onabort=ge(function(a){jt(a),t.active&&t._reject(new O.Abort(e.error)),t.active=!1,t.on("abort").fire(a)}),e.oncomplete=ge(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&it.storagemutated.fire(e.mutatedParts)}),this},Ge.prototype._promise=function(e,t,n){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return Ee(new O.ReadOnly("Transaction is readonly"));if(!this.active)return Ee(new O.TransactionInactive);if(this._locked())return new V(function(o,c){r._blockedFuncs.push([function(){r._promise(e,t,n).then(o,c)},X])});if(n)return nt(function(){var o=new V(function(c,f){r._lock();var m=t(c,f,r);m&&m.then&&m.then(c,f)});return o.finally(function(){return r._unlock()}),o._lib=!0,o});var a=new V(function(o,c){var f=t(o,c,r);f&&f.then&&f.then(o,c)});return a._lib=!0,a},Ge.prototype._root=function(){return this.parent?this.parent._root():this},Ge.prototype.waitFor=function(e){var t,n=this._root(),r=V.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=o)}());var a=n._waitingFor;return new V(function(o,c){r.then(function(f){return n._waitingQueue.push(ge(o.bind(null,f)))},function(f){return n._waitingQueue.push(ge(c.bind(null,f)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},Ge.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new O.Abort))},Ge.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if($(t,e))return t[e];var n=this.schema[e];if(!n)throw new O.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},Ge);function Ge(){}function Wn(e,t,n,r,a,o,c,f){return{name:e,keyPath:t,unique:n,multi:r,auto:a,compound:o,src:(n&&!c?"&":"")+(r?"*":"")+(a?"++":"")+Lr(t),type:f}}function Lr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Gn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(a){return[a.name,a]},n.reduce(function(a,o,c){return c=r(o,c),c&&(a[c[0]]=c[1]),a},{}))};var r}var Ut=function(e){try{return e.only([[]]),Ut=function(){return[[]]},[[]]}catch{return Ut=function(){return mt},mt}};function $n(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return fe(n,t)}:function(n){return fe(n,e)};var t}function Ur(e){return[].slice.call(e)}var Va=0;function Vt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Wa(e,t,m){function r(w){if(w.type===3)return null;if(w.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=w.lower,g=w.upper,_=w.lowerOpen,w=w.upperOpen;return y===void 0?g===void 0?null:t.upperBound(g,!!w):g===void 0?t.lowerBound(y,!!_):t.bound(y,g,!!_,!!w)}function a(E){var y,g=E.name;return{name:g,schema:E,mutate:function(_){var w=_.trans,x=_.type,A=_.keys,N=_.values,P=_.range;return new Promise(function(B,j){B=ge(B);var M=w.objectStore(g),R=M.keyPath==null,U=x==="put"||x==="add";if(!U&&x!=="delete"&&x!=="deleteRange")throw new Error("Invalid operation type: "+x);var L,W=(A||N||{length:1}).length;if(A&&N&&A.length!==N.length)throw new Error("Given keys array must have same length as given values array.");if(W===0)return B({numFailures:0,failures:{},results:[],lastResult:void 0});function re(Fe){++_e,jt(Fe)}var le=[],te=[],_e=0;if(x==="deleteRange"){if(P.type===4)return B({numFailures:_e,failures:te,results:[],lastResult:void 0});P.type===3?le.push(L=M.clear()):le.push(L=M.delete(r(P)))}else{var R=U?R?[N,A]:[N,null]:[A,null],ee=R[0],Ie=R[1];if(U)for(var ke=0;ke<W;++ke)le.push(L=Ie&&Ie[ke]!==void 0?M[x](ee[ke],Ie[ke]):M[x](ee[ke])),L.onerror=re;else for(ke=0;ke<W;++ke)le.push(L=M[x](ee[ke])),L.onerror=re}function xn(Fe){Fe=Fe.target.result,le.forEach(function(bt,lr){return bt.error!=null&&(te[lr]=bt.error)}),B({numFailures:_e,failures:te,results:x==="delete"?A:le.map(function(bt){return bt.result}),lastResult:Fe})}L.onerror=function(Fe){re(Fe),xn(Fe)},L.onsuccess=xn})},getMany:function(_){var w=_.trans,x=_.keys;return new Promise(function(A,N){A=ge(A);for(var P,B=w.objectStore(g),j=x.length,M=new Array(j),R=0,U=0,L=function(le){le=le.target,M[le._pos]=le.result,++U===R&&A(M)},W=We(N),re=0;re<j;++re)x[re]!=null&&((P=B.get(x[re]))._pos=re,P.onsuccess=L,P.onerror=W,++R);R===0&&A(M)})},get:function(_){var w=_.trans,x=_.key;return new Promise(function(A,N){A=ge(A);var P=w.objectStore(g).get(x);P.onsuccess=function(B){return A(B.target.result)},P.onerror=We(N)})},query:(y=v,function(_){return new Promise(function(w,x){w=ge(w);var A,N,P,R=_.trans,B=_.values,j=_.limit,L=_.query,M=j===1/0?void 0:j,U=L.index,L=L.range,R=R.objectStore(g),U=U.isPrimaryKey?R:R.index(U.name),L=r(L);if(j===0)return w({result:[]});y?((M=B?U.getAll(L,M):U.getAllKeys(L,M)).onsuccess=function(W){return w({result:W.target.result})},M.onerror=We(x)):(A=0,N=!B&&"openKeyCursor"in U?U.openKeyCursor(L):U.openCursor(L),P=[],N.onsuccess=function(W){var re=N.result;return re?(P.push(B?re.value:re.primaryKey),++A===j?w({result:P}):void re.continue()):w({result:P})},N.onerror=We(x))})}),openCursor:function(_){var w=_.trans,x=_.values,A=_.query,N=_.reverse,P=_.unique;return new Promise(function(B,j){B=ge(B);var U=A.index,M=A.range,R=w.objectStore(g),R=U.isPrimaryKey?R:R.index(U.name),U=N?P?"prevunique":"prev":P?"nextunique":"next",L=!x&&"openKeyCursor"in R?R.openKeyCursor(r(M),U):R.openCursor(r(M),U);L.onerror=We(j),L.onsuccess=ge(function(W){var re,le,te,_e,ee=L.result;ee?(ee.___id=++Va,ee.done=!1,re=ee.continue.bind(ee),le=(le=ee.continuePrimaryKey)&&le.bind(ee),te=ee.advance.bind(ee),_e=function(){throw new Error("Cursor not stopped")},ee.trans=w,ee.stop=ee.continue=ee.continuePrimaryKey=ee.advance=function(){throw new Error("Cursor not started")},ee.fail=ge(j),ee.next=function(){var Ie=this,ke=1;return this.start(function(){return ke--?Ie.continue():Ie.stop()}).then(function(){return Ie})},ee.start=function(Ie){function ke(){if(L.result)try{Ie()}catch(Fe){ee.fail(Fe)}else ee.done=!0,ee.start=function(){throw new Error("Cursor behind last entry")},ee.stop()}var xn=new Promise(function(Fe,bt){Fe=ge(Fe),L.onerror=We(bt),ee.fail=bt,ee.stop=function(lr){ee.stop=ee.continue=ee.continuePrimaryKey=ee.advance=_e,Fe(lr)}});return L.onsuccess=ge(function(Fe){L.onsuccess=ke,ke()}),ee.continue=re,ee.continuePrimaryKey=le,ee.advance=te,ke(),xn},B(ee)):B(null)},j)})},count:function(_){var w=_.query,x=_.trans,A=w.index,N=w.range;return new Promise(function(P,B){var j=x.objectStore(g),M=A.isPrimaryKey?j:j.index(A.name),j=r(N),M=j?M.count(j):M.count();M.onsuccess=ge(function(R){return P(R.target.result)}),M.onerror=We(B)})}}}var o,c,f,b=(c=m,f=Ur((o=e).objectStoreNames),{schema:{name:o.name,tables:f.map(function(E){return c.objectStore(E)}).map(function(E){var y=E.keyPath,w=E.autoIncrement,g=F(y),_={},w={name:E.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y==null,compound:g,keyPath:y,autoIncrement:w,unique:!0,extractKey:$n(y)},indexes:Ur(E.indexNames).map(function(x){return E.index(x)}).map(function(P){var A=P.name,N=P.unique,B=P.multiEntry,P=P.keyPath,B={name:A,compound:F(P),keyPath:P,unique:N,multiEntry:B,extractKey:$n(P)};return _[Vt(P)]=B}),getIndexByKeyPath:function(x){return _[Vt(x)]}};return _[":id"]=w.primaryKey,y!=null&&(_[Vt(y)]=w.primaryKey),w})},hasGetAll:0<f.length&&"getAll"in c.objectStore(f[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),m=b.schema,v=b.hasGetAll,b=m.tables.map(a),d={};return b.forEach(function(E){return d[E.name]=E}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(E){if(!d[E])throw new Error("Table '".concat(E,"' not found"));return d[E]},MIN_KEY:-1/0,MAX_KEY:Ut(t),schema:m}}function Ga(e,t,n,r){var a=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=Wa(t,a,r),e.dbcore.reduce(function(o,c){return c=c.create,p(p({},o),c(o))},r))}}function pn(e,r){var n=r.db,r=Ga(e._middlewares,n,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(a){var o=a.name;e.core.schema.tables.some(function(c){return c.name===o})&&(a.core=e.core.table(o),e[o]instanceof e.Table&&(e[o].core=a.core))})}function hn(e,t,n,r){n.forEach(function(a){var o=r[a];t.forEach(function(c){var f=function m(v,b){return z(v,b)||(v=Q(v))&&m(v,b)}(c,a);(!f||"value"in f&&f.value===void 0)&&(c===e.Transaction.prototype||c instanceof e.Transaction?I(c,a,{get:function(){return this.table(a)},set:function(m){G(this,a,{value:m,writable:!0,configurable:!0,enumerable:!0})}}):c[a]=new e.Table(a,o))})})}function Yn(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function $a(e,t){return e._cfg.version-t._cfg.version}function Ya(e,t,n,r){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=Gn("$meta",Wr("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,a);o.create(n),o._completion.catch(r);var c=o._reject.bind(o),f=X.transless||X;nt(function(){return X.trans=o,X.transless=f,t!==0?(pn(e,n),v=t,((m=o).storeNames.includes("$meta")?m.table("$meta").get("version").then(function(b){return b??v}):V.resolve(v)).then(function(b){return E=b,y=o,g=n,_=[],b=(d=e)._versions,w=d._dbSchema=yn(0,d.idbdb,g),(b=b.filter(function(x){return x._cfg.version>=E})).length!==0?(b.forEach(function(x){_.push(function(){var A=w,N=x._cfg.dbschema;vn(d,A,g),vn(d,N,g),w=d._dbSchema=N;var P=Xn(A,N);P.add.forEach(function(U){zn(g,U[0],U[1].primKey,U[1].indexes)}),P.change.forEach(function(U){if(U.recreate)throw new O.Upgrade("Not yet support for changing primary key");var L=g.objectStore(U.name);U.add.forEach(function(W){return mn(L,W)}),U.change.forEach(function(W){L.deleteIndex(W.name),mn(L,W)}),U.del.forEach(function(W){return L.deleteIndex(W)})});var B=x._cfg.contentUpgrade;if(B&&x._cfg.version>E){pn(d,g),y._memoizedTables={};var j=Ne(N);P.del.forEach(function(U){j[U]=A[U]}),Yn(d,[d.Transaction.prototype]),hn(d,[d.Transaction.prototype],K(j),j),y.schema=j;var M,R=qe(B);return R&&xt(),P=V.follow(function(){var U;(M=B(y))&&R&&(U=rt.bind(null,null),M.then(U,U))}),M&&typeof M.then=="function"?V.resolve(M):P.then(function(){return M})}}),_.push(function(A){var N,P,B=x._cfg.dbschema;N=B,P=A,[].slice.call(P.db.objectStoreNames).forEach(function(j){return N[j]==null&&P.db.deleteObjectStore(j)}),Yn(d,[d.Transaction.prototype]),hn(d,[d.Transaction.prototype],d._storeNames,d._dbSchema),y.schema=d._dbSchema}),_.push(function(A){d.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(d.idbdb.version/10)===x._cfg.version?(d.idbdb.deleteObjectStore("$meta"),delete d._dbSchema.$meta,d._storeNames=d._storeNames.filter(function(N){return N!=="$meta"})):A.objectStore("$meta").put(x._cfg.version,"version"))})}),function x(){return _.length?V.resolve(_.shift()(y.idbtrans)).then(x):V.resolve()}().then(function(){Vr(w,g)})):V.resolve();var d,E,y,g,_,w}).catch(c)):(K(a).forEach(function(b){zn(n,b,a[b].primKey,a[b].indexes)}),pn(e,n),void V.follow(function(){return e.on.populate.fire(o)}).catch(c));var m,v})}function Xa(e,t){Vr(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=yn(0,e.idbdb,t);vn(e,e._dbSchema,t);for(var r=0,a=Xn(n,e._dbSchema).change;r<a.length;r++){var o=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var f=t.objectStore(c.name);c.add.forEach(function(m){Be&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(m.src)),mn(f,m)})}(a[r]);if(typeof o=="object")return o.value}}function Xn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var a=e[n],o=t[n];if(a){var c={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||a.primKey.auto!==o.primKey.auto)c.recreate=!0,r.change.push(c);else{var f=a.idxByName,m=o.idxByName,v=void 0;for(v in f)m[v]||c.del.push(v);for(v in m){var b=f[v],d=m[v];b?b.src!==d.src&&c.change.push(d):c.add.push(d)}(0<c.del.length||0<c.add.length||0<c.change.length)&&r.change.push(c)}}else r.add.push([n,o])}return r}function zn(e,t,n,r){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(o){return mn(a,o)}),a}function Vr(e,t){K(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(Be&&console.debug("Dexie: Creating missing table",n),zn(t,n,e[n].primKey,e[n].indexes))})}function mn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function yn(e,t,n){var r={};return be(t.objectStoreNames,0).forEach(function(a){for(var o=n.objectStore(a),c=Wn(Lr(v=o.keyPath),v||"",!0,!1,!!o.autoIncrement,v&&typeof v!="string",!0),f=[],m=0;m<o.indexNames.length;++m){var b=o.index(o.indexNames[m]),v=b.keyPath,b=Wn(b.name,v,!!b.unique,!!b.multiEntry,!1,v&&typeof v!="string",!1);f.push(b)}r[a]=Gn(a,c,f)}),r}function vn(e,t,n){for(var r=n.db.objectStoreNames,a=0;a<r.length;++a){var o=r[a],c=n.objectStore(o);e._hasGetAll="getAll"in c;for(var f=0;f<c.indexNames.length;++f){var m=c.indexNames[f],v=c.index(m).keyPath,b=typeof v=="string"?v:"["+be(v).join("+")+"]";!t[o]||(v=t[o].idxByName[b])&&(v.name=m,delete t[o].idxByName[b],t[o].idxByName[m]=v)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&D.WorkerGlobalScope&&D instanceof D.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Wr(e){return e.split(",").map(function(t,n){var o=t.split(":"),r=(a=o[1])===null||a===void 0?void 0:a.trim(),a=(t=o[0].trim()).replace(/([&*]|\+\+)/g,""),o=/^\[/.test(a)?a.match(/^\[(.*)\]$/)[1].split("+"):a;return Wn(a,o||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),F(o),n===0,r)})}var za=(Nt.prototype._createTableSchema=Gn,Nt.prototype._parseIndexSyntax=Wr,Nt.prototype._parseStoresSpec=function(e,t){var n=this;K(e).forEach(function(r){if(e[r]!==null){var a=n._parseIndexSyntax(e[r]),o=a.shift();if(!o)throw new O.Schema("Invalid schema for table "+r+": "+e[r]);if(o.unique=!0,o.multi)throw new O.Schema("Primary key cannot be multiEntry*");a.forEach(function(c){if(c.auto)throw new O.Schema("Only primary key can be marked as autoIncrement (++)");if(!c.keyPath)throw new O.Schema("Index must have a name and cannot be an empty string")}),a=n._createTableSchema(r,o,a),t[r]=a}})},Nt.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?q(this._cfg.storesSource,n):n;var n=t._versions,r={},a={};return n.forEach(function(o){q(r,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(r,a)}),t._dbSchema=a,Yn(t,[t._allTables,t,t.Transaction.prototype]),hn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],K(a),a),t._storeNames=K(a),this},Nt.prototype.upgrade=function(e){return this._cfg.contentUpgrade=_t(this._cfg.contentUpgrade||Z,e),this},Nt);function Nt(){}function Qn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Xe(sn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Hn(e){return e&&typeof e.databases=="function"}function Jn(e){return nt(function(){return X.letThrough=!0,e()})}function Zn(e){return!("from"in e)}var Ce=function(e,t){if(!this){var n=new Ce;return e&&"d"in e&&q(n,e),n}q(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Wt(e,t,n){var r=ue(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(Zn(e))return q(e,{from:t,to:n,d:1});var a=e.l,r=e.r;if(ue(n,e.from)<0)return a?Wt(a,t,n):e.l={from:t,to:n,d:1,l:null,r:null},$r(e);if(0<ue(t,e.to))return r?Wt(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},$r(e);ue(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<ue(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,a&&!e.l&&Gt(e,a),r&&n&&Gt(e,r)}}function Gt(e,t){Zn(t)||function n(r,m){var o=m.from,c=m.to,f=m.l,m=m.r;Wt(r,o,c),f&&n(r,f),m&&n(r,m)}(e,t)}function Gr(e,t){var n=gn(t),r=n.next();if(r.done)return!1;for(var a=r.value,o=gn(e),c=o.next(a.from),f=c.value;!r.done&&!c.done;){if(ue(f.from,a.to)<=0&&0<=ue(f.to,a.from))return!0;ue(a.from,f.from)<0?a=(r=n.next(f.from)).value:f=(c=o.next(a.from)).value}return!1}function gn(e){var t=Zn(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&ue(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||ue(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function $r(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),a=1<r?"r":r<-1?"l":"";a&&(t=a=="r"?"l":"r",n=p({},e),r=e[a],e.from=r.from,e.to=r.to,e[a]=r[a],n[a]=r[t],(e[t]=n).d=Yr(n)),e.d=Yr(e)}function Yr(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function bn(e,t){return K(t).forEach(function(n){e[n]?Gt(e[n],t[n]):e[n]=function r(a){var o,c,f={};for(o in a)$(a,o)&&(c=a[o],f[o]=!c||typeof c!="object"||Ue.has(c.constructor)?c:r(c));return f}(t[n])}),e}function er(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&Gr(t[n],e[n])})}ne(Ce.prototype,((Ke={add:function(e){return Gt(this,e),this},addKey:function(e){return Wt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Wt(t,n,n)}),this},hasKey:function(e){var t=gn(this).next(e).value;return t&&ue(t.from,e)<=0&&0<=ue(t.to,e)}})[Oe]=function(){return gn(this)},Ke));var vt={},tr={},nr=!1;function wn(e){bn(tr,e),nr||(nr=!0,setTimeout(function(){nr=!1,rr(tr,!(tr={}))},0))}function rr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,a=Object.values(vt);r<a.length;r++)Xr(c=a[r],e,n,t);else for(var o in e){var c,f=/^idb\:\/\/(.*)\/(.*)\//.exec(o);f&&(o=f[1],f=f[2],(c=vt["idb://".concat(o,"/").concat(f)])&&Xr(c,e,n,t))}n.forEach(function(m){return m()})}function Xr(e,t,n,r){for(var a=[],o=0,c=Object.entries(e.queries.query);o<c.length;o++){for(var f=c[o],m=f[0],v=[],b=0,d=f[1];b<d.length;b++){var E=d[b];er(t,E.obsSet)?E.subscribers.forEach(function(w){return n.add(w)}):r&&v.push(E)}r&&a.push([m,v])}if(r)for(var y=0,g=a;y<g.length;y++){var _=g[y],m=_[0],v=_[1];e.queries.query[m]=v}}function Qa(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Ee(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,a=Math.round(10*e.verno),o=!1;function c(){if(t.openCanceller!==r)throw new O.DatabaseClosed("db.open() was cancelled")}function f(){return new V(function(E,y){if(c(),!n)throw new O.MissingAPI;var g=e.name,_=t.autoSchema||!a?n.open(g):n.open(g,a);if(!_)throw new O.MissingAPI;_.onerror=We(y),_.onblocked=ge(e._fireOnBlocked),_.onupgradeneeded=ge(function(w){var x;b=_.transaction,t.autoSchema&&!e._options.allowEmptyDB?(_.onerror=jt,b.abort(),_.result.close(),(x=n.deleteDatabase(g)).onsuccess=x.onerror=ge(function(){y(new O.NoSuchDatabase("Database ".concat(g," doesnt exist")))})):(b.onerror=We(y),w=w.oldVersion>Math.pow(2,62)?0:w.oldVersion,d=w<1,e.idbdb=_.result,o&&Xa(e,b),Ya(e,w/10,b,y))},y),_.onsuccess=ge(function(){b=null;var w,x,A,N,P,B=e.idbdb=_.result,j=be(B.objectStoreNames);if(0<j.length)try{var M=B.transaction((N=j).length===1?N[0]:N,"readonly");if(t.autoSchema)x=B,A=M,(w=e).verno=x.version/10,A=w._dbSchema=yn(0,x,A),w._storeNames=be(x.objectStoreNames,0),hn(w,[w._allTables],K(A),A);else if(vn(e,e._dbSchema,M),((P=Xn(yn(0,(P=e).idbdb,M),P._dbSchema)).add.length||P.change.some(function(R){return R.add.length||R.change.length}))&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),B.close(),a=B.version+1,o=!0,E(f());pn(e,M)}catch{}Ot.push(e),B.onversionchange=ge(function(R){t.vcFired=!0,e.on("versionchange").fire(R)}),B.onclose=ge(function(R){e.on("close").fire(R)}),d&&(P=e._deps,M=g,B=P.indexedDB,P=P.IDBKeyRange,Hn(B)||M===sn||Qn(B,P).put({name:M}).catch(Z)),E()},y)}).catch(function(E){switch(E?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),f();break;case"VersionError":if(0<a)return a=0,f()}return V.reject(E)})}var m,v=t.dbReadyResolve,b=null,d=!1;return V.race([r,(typeof navigator>"u"?V.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(E){function y(){return indexedDB.databases().finally(E)}m=setInterval(y,100),y()}).finally(function(){return clearInterval(m)}):Promise.resolve()).then(f)]).then(function(){return c(),t.onReadyBeingFired=[],V.resolve(Jn(function(){return e.on.ready.fire(e.vip)})).then(function E(){if(0<t.onReadyBeingFired.length){var y=t.onReadyBeingFired.reduce(_t,Z);return t.onReadyBeingFired=[],V.resolve(Jn(function(){return y(e.vip)})).then(E)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(E){t.dbOpenError=E;try{b&&b.abort()}catch{}return r===t.openCanceller&&e._close(),Ee(E)}).finally(function(){t.openComplete=!0,v()}).then(function(){var E;return d&&(E={},e.tables.forEach(function(y){y.schema.indexes.forEach(function(g){g.name&&(E["idb://".concat(e.name,"/").concat(y.name,"/").concat(g.name)]=new Ce(-1/0,[[[]]]))}),E["idb://".concat(e.name,"/").concat(y.name,"/")]=E["idb://".concat(e.name,"/").concat(y.name,"/:dels")]=new Ce(-1/0,[[[]]])}),it(Lt).fire(E),rr(E,!0)),e})}function ar(e){function t(o){return e.next(o)}var n=a(t),r=a(function(o){return e.throw(o)});function a(o){return function(m){var f=o(m),m=f.value;return f.done?m:m&&typeof m.then=="function"?m.then(n,r):F(m)?Promise.all(m).then(n,r):n(m)}}return a(t)()}function _n(e,t,n){for(var r=F(e)?e.slice():[e],a=0;a<n;++a)r.push(t);return r}var Ha={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return p(p({},e),{table:function(t){var n=e.table(t),r=n.schema,a={},o=[];function c(d,E,y){var g=Vt(d),_=a[g]=a[g]||[],w=d==null?0:typeof d=="string"?1:d.length,x=0<E,x=p(p({},y),{name:x?"".concat(g,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:x,keyTail:E,keyLength:w,extractKey:$n(d),unique:!x&&y.unique});return _.push(x),x.isPrimaryKey||o.push(x),1<w&&c(w===2?d[0]:d.slice(0,w-1),E+1,y),_.sort(function(A,N){return A.keyTail-N.keyTail}),x}t=c(r.primaryKey.keyPath,0,r.primaryKey),a[":id"]=[t];for(var f=0,m=r.indexes;f<m.length;f++){var v=m[f];c(v.keyPath,0,v)}function b(d){var E,y=d.query.index;return y.isVirtual?p(p({},d),{query:{index:y.lowLevelIndex,range:(E=d.query.range,y=y.keyTail,{type:E.type===1?2:E.type,lower:_n(E.lower,E.lowerOpen?e.MAX_KEY:e.MIN_KEY,y),lowerOpen:!0,upper:_n(E.upper,E.upperOpen?e.MIN_KEY:e.MAX_KEY,y),upperOpen:!0})}}):d}return p(p({},n),{schema:p(p({},r),{primaryKey:t,indexes:o,getIndexByKeyPath:function(d){return(d=a[Vt(d)])&&d[0]}}),count:function(d){return n.count(b(d))},query:function(d){return n.query(b(d))},openCursor:function(d){var E=d.query.index,y=E.keyTail,g=E.isVirtual,_=E.keyLength;return g?n.openCursor(b(d)).then(function(x){return x&&w(x)}):n.openCursor(d);function w(x){return Object.create(x,{continue:{value:function(A){A!=null?x.continue(_n(A,d.reverse?e.MAX_KEY:e.MIN_KEY,y)):d.unique?x.continue(x.key.slice(0,_).concat(d.reverse?e.MIN_KEY:e.MAX_KEY,y)):x.continue()}},continuePrimaryKey:{value:function(A,N){x.continuePrimaryKey(_n(A,e.MAX_KEY,y),N)}},primaryKey:{get:function(){return x.primaryKey}},key:{get:function(){var A=x.key;return _===1?A[0]:A.slice(0,_)}},value:{get:function(){return x.value}}})}}})}})}};function or(e,t,n,r){return n=n||{},r=r||"",K(e).forEach(function(a){var o,c,f;$(t,a)?(o=e[a],c=t[a],typeof o=="object"&&typeof c=="object"&&o&&c?(f=me(o))!==me(c)?n[r+a]=t[a]:f==="Object"?or(o,c,n,r+a+"."):o!==c&&(n[r+a]=t[a]):o!==c&&(n[r+a]=t[a])):n[r+a]=void 0}),K(t).forEach(function(a){$(e,a)||(n[r+a]=t[a])}),n}function ir(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ja={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return p(p({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return p(p({},n),{mutate:function(a){var o=X.trans,c=o.table(t).hook,f=c.deleting,m=c.creating,v=c.updating;switch(a.type){case"add":if(m.fire===Z)break;return o._promise("readwrite",function(){return b(a)},!0);case"put":if(m.fire===Z&&v.fire===Z)break;return o._promise("readwrite",function(){return b(a)},!0);case"delete":if(f.fire===Z)break;return o._promise("readwrite",function(){return b(a)},!0);case"deleteRange":if(f.fire===Z)break;return o._promise("readwrite",function(){return function d(E,y,g){return n.query({trans:E,values:!1,query:{index:r,range:y},limit:g}).then(function(_){var w=_.result;return b({type:"delete",keys:w,trans:E}).then(function(x){return 0<x.numFailures?Promise.reject(x.failures[0]):w.length<g?{failures:[],numFailures:0,lastResult:void 0}:d(E,p(p({},y),{lower:w[w.length-1],lowerOpen:!0}),g)})})}(a.trans,a.range,1e4)},!0)}return n.mutate(a);function b(d){var E,y,g,_=X.trans,w=d.keys||ir(r,d);if(!w)throw new Error("Keys missing");return(d=d.type==="add"||d.type==="put"?p(p({},d),{keys:w}):p({},d)).type!=="delete"&&(d.values=k([],d.values)),d.keys&&(d.keys=k([],d.keys)),E=n,g=w,((y=d).type==="add"?Promise.resolve([]):E.getMany({trans:y.trans,keys:g,cache:"immutable"})).then(function(x){var A=w.map(function(N,P){var B,j,M,R=x[P],U={onerror:null,onsuccess:null};return d.type==="delete"?f.fire.call(U,N,R,_):d.type==="add"||R===void 0?(B=m.fire.call(U,N,d.values[P],_),N==null&&B!=null&&(d.keys[P]=N=B,r.outbound||oe(d.values[P],r.keyPath,N))):(B=or(R,d.values[P]),(j=v.fire.call(U,B,N,R,_))&&(M=d.values[P],Object.keys(j).forEach(function(L){$(M,L)?M[L]=j[L]:oe(M,L,j[L])}))),U});return n.mutate(d).then(function(N){for(var P=N.failures,B=N.results,j=N.numFailures,N=N.lastResult,M=0;M<w.length;++M){var R=(B||w)[M],U=A[M];R==null?U.onerror&&U.onerror(P[M]):U.onsuccess&&U.onsuccess(d.type==="put"&&x[M]?d.values[M]:R)}return{failures:P,results:B,numFailures:j,lastResult:N}}).catch(function(N){return A.forEach(function(P){return P.onerror&&P.onerror(N)}),Promise.reject(N)})})}}})}})}};function zr(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],a=0,o=0;a<t.keys.length&&o<e.length;++a)ue(t.keys[a],e[o])===0&&(r.push(n?De(t.values[a]):t.values[a]),++o);return r.length===e.length?r:null}catch{return null}}var Za={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return p(p({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var a=zr(r.keys,r.trans._cache,r.cache==="clone");return a?V.resolve(a):n.getMany(r).then(function(o){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?De(o):o},o})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function Qr(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Hr(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var eo={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new Ce(e.MIN_KEY,e.MAX_KEY);return p(p({},e),{transaction:function(r,a,o){if(X.subscr&&a!=="readonly")throw new O.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(X.querier));return e.transaction(r,a,o)},table:function(r){var a=e.table(r),o=a.schema,c=o.primaryKey,d=o.indexes,f=c.extractKey,m=c.outbound,v=c.autoIncrement&&d.filter(function(y){return y.compound&&y.keyPath.includes(c.keyPath)}),b=p(p({},a),{mutate:function(y){function g(L){return L="idb://".concat(t,"/").concat(r,"/").concat(L),N[L]||(N[L]=new Ce)}var _,w,x,A=y.trans,N=y.mutatedParts||(y.mutatedParts={}),P=g(""),B=g(":dels"),j=y.type,U=y.type==="deleteRange"?[y.range]:y.type==="delete"?[y.keys]:y.values.length<50?[ir(c,y).filter(function(L){return L}),y.values]:[],M=U[0],R=U[1],U=y.trans._cache;return F(M)?(P.addKeys(M),(U=j==="delete"||M.length===R.length?zr(M,U):null)||B.addKeys(M),(U||R)&&(_=g,w=U,x=R,o.indexes.forEach(function(L){var W=_(L.name||"");function re(te){return te!=null?L.extractKey(te):null}function le(te){return L.multiEntry&&F(te)?te.forEach(function(_e){return W.addKey(_e)}):W.addKey(te)}(w||x).forEach(function(te,Ie){var ee=w&&re(w[Ie]),Ie=x&&re(x[Ie]);ue(ee,Ie)!==0&&(ee!=null&&le(ee),Ie!=null&&le(Ie))})}))):M?(R={from:(R=M.lower)!==null&&R!==void 0?R:e.MIN_KEY,to:(R=M.upper)!==null&&R!==void 0?R:e.MAX_KEY},B.add(R),P.add(R)):(P.add(n),B.add(n),o.indexes.forEach(function(L){return g(L.name).add(n)})),a.mutate(y).then(function(L){return!M||y.type!=="add"&&y.type!=="put"||(P.addKeys(L.results),v&&v.forEach(function(W){for(var re=y.values.map(function(ee){return W.extractKey(ee)}),le=W.keyPath.findIndex(function(ee){return ee===c.keyPath}),te=0,_e=L.results.length;te<_e;++te)re[te][le]=L.results[te];g(W.name).addKeys(re)})),A.mutatedParts=bn(A.mutatedParts||{},N),L})}}),d=function(g){var _=g.query,g=_.index,_=_.range;return[g,new Ce((g=_.lower)!==null&&g!==void 0?g:e.MIN_KEY,(_=_.upper)!==null&&_!==void 0?_:e.MAX_KEY)]},E={get:function(y){return[c,new Ce(y.key)]},getMany:function(y){return[c,new Ce().addKeys(y.keys)]},count:d,query:d,openCursor:d};return K(E).forEach(function(y){b[y]=function(g){var _=X.subscr,w=!!_,x=Qr(X,a)&&Hr(y,g)?g.obsSet={}:_;if(w){var A=function(R){return R="idb://".concat(t,"/").concat(r,"/").concat(R),x[R]||(x[R]=new Ce)},N=A(""),P=A(":dels"),_=E[y](g),w=_[0],_=_[1];if((y==="query"&&w.isPrimaryKey&&!g.values?P:A(w.name||"")).add(_),!w.isPrimaryKey){if(y!=="count"){var B=y==="query"&&m&&g.values&&a.query(p(p({},g),{values:!1}));return a[y].apply(this,arguments).then(function(R){if(y==="query"){if(m&&g.values)return B.then(function(re){return re=re.result,N.addKeys(re),R});var U=g.values?R.result.map(f):R.result;(g.values?N:P).addKeys(U)}else if(y==="openCursor"){var L=R,W=g.values;return L&&Object.create(L,{key:{get:function(){return P.addKey(L.primaryKey),L.key}},primaryKey:{get:function(){var re=L.primaryKey;return P.addKey(re),re}},value:{get:function(){return W&&N.addKey(L.primaryKey),L.value}}})}return R})}P.add(n)}}return a[y].apply(this,arguments)}}),b}})}};function Jr(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=p({},t),F(t.keys)&&(t.keys=t.keys.filter(function(a,o){return!(o in n.failures)})),"values"in t&&F(t.values)&&(t.values=t.values.filter(function(a,o){return!(o in n.failures)})),t)}function sr(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<ue(n,r.lower):0<=ue(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?ue(e,t.upper)<0:ue(e,t.upper)<=0));var n,r}function Zr(e,t,E,r,a,o){if(!E||E.length===0)return e;var c=t.query.index,f=c.multiEntry,m=t.query.range,v=r.schema.primaryKey.extractKey,b=c.extractKey,d=(c.lowLevelIndex||c).extractKey,E=E.reduce(function(y,g){var _=y,w=[];if(g.type==="add"||g.type==="put")for(var x=new Ce,A=g.values.length-1;0<=A;--A){var N,P=g.values[A],B=v(P);x.hasKey(B)||(N=b(P),(f&&F(N)?N.some(function(L){return sr(L,m)}):sr(N,m))&&(x.addKey(B),w.push(P)))}switch(g.type){case"add":var j=new Ce().addKeys(t.values?y.map(function(W){return v(W)}):y),_=y.concat(t.values?w.filter(function(W){return W=v(W),!j.hasKey(W)&&(j.addKey(W),!0)}):w.map(function(W){return v(W)}).filter(function(W){return!j.hasKey(W)&&(j.addKey(W),!0)}));break;case"put":var M=new Ce().addKeys(g.values.map(function(W){return v(W)}));_=y.filter(function(W){return!M.hasKey(t.values?v(W):W)}).concat(t.values?w:w.map(function(W){return v(W)}));break;case"delete":var R=new Ce().addKeys(g.keys);_=y.filter(function(W){return!R.hasKey(t.values?v(W):W)});break;case"deleteRange":var U=g.range;_=y.filter(function(W){return!sr(v(W),U)})}return _},e);return E===e?e:(E.sort(function(y,g){return ue(d(y),d(g))||ue(v(y),v(g))}),t.limit&&t.limit<1/0&&(E.length>t.limit?E.length=t.limit:e.length===t.limit&&E.length<t.limit&&(a.dirty=!0)),o?Object.freeze(E):E)}function ea(e,t){return ue(e.lower,t.lower)===0&&ue(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function to(e,t){return function(n,r,a,o){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=ue(n,r))===0){if(a&&o)return 0;if(a)return 1;if(o)return-1}return r}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,r,a,o){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=ue(n,r))===0){if(a&&o)return 0;if(a)return-1;if(o)return 1}return r}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function no(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var a,o;e.subscribers.delete(n),e.subscribers.size===0&&(a=e,o=t,setTimeout(function(){a.subscribers.size===0&&$e(o,a)},3e3))})}var ro={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return p(p({},e),{transaction:function(n,r,a){var o,c,f=e.transaction(n,r,a);return r==="readwrite"&&(c=(o=new AbortController).signal,a=function(m){return function(){if(o.abort(),r==="readwrite"){for(var v=new Set,b=0,d=n;b<d.length;b++){var E=d[b],y=vt["idb://".concat(t,"/").concat(E)];if(y){var g=e.table(E),_=y.optimisticOps.filter(function(W){return W.trans===f});if(f._explicit&&m&&f.mutatedParts)for(var w=0,x=Object.values(y.queries.query);w<x.length;w++)for(var A=0,N=(j=x[w]).slice();A<N.length;A++)er((M=N[A]).obsSet,f.mutatedParts)&&($e(j,M),M.subscribers.forEach(function(W){return v.add(W)}));else if(0<_.length){y.optimisticOps=y.optimisticOps.filter(function(W){return W.trans!==f});for(var P=0,B=Object.values(y.queries.query);P<B.length;P++)for(var j,M,R,U=0,L=(j=B[P]).slice();U<L.length;U++)(M=L[U]).res!=null&&f.mutatedParts&&(m&&!M.dirty?(R=Object.isFrozen(M.res),R=Zr(M.res,M.req,_,g,M,R),M.dirty?($e(j,M),M.subscribers.forEach(function(W){return v.add(W)})):R!==M.res&&(M.res=R,M.promise=V.resolve({result:R}))):(M.dirty&&$e(j,M),M.subscribers.forEach(function(W){return v.add(W)})))}}}v.forEach(function(W){return W()})}}},f.addEventListener("abort",a(!1),{signal:c}),f.addEventListener("error",a(!1),{signal:c}),f.addEventListener("complete",a(!0),{signal:c})),f},table:function(n){var r=e.table(n),a=r.schema.primaryKey;return p(p({},r),{mutate:function(o){var c=X.trans;if(a.outbound||c.db._options.cache==="disabled"||c.explicit||c.idbtrans.mode!=="readwrite")return r.mutate(o);var f=vt["idb://".concat(t,"/").concat(n)];return f?(c=r.mutate(o),o.type!=="add"&&o.type!=="put"||!(50<=o.values.length||ir(a,o).some(function(m){return m==null}))?(f.optimisticOps.push(o),o.mutatedParts&&wn(o.mutatedParts),c.then(function(m){0<m.numFailures&&($e(f.optimisticOps,o),(m=Jr(0,o,m))&&f.optimisticOps.push(m),o.mutatedParts&&wn(o.mutatedParts))}),c.catch(function(){$e(f.optimisticOps,o),o.mutatedParts&&wn(o.mutatedParts)})):c.then(function(m){var v=Jr(0,p(p({},o),{values:o.values.map(function(b,d){var E;return m.failures[d]||(b=(E=a.keyPath)!==null&&E!==void 0&&E.includes(".")?De(b):p({},b),oe(b,a.keyPath,m.results[d])),b})}),m);f.optimisticOps.push(v),queueMicrotask(function(){return o.mutatedParts&&wn(o.mutatedParts)})}),c):r.mutate(o)},query:function(o){if(!Qr(X,r)||!Hr("query",o))return r.query(o);var c=((v=X.trans)===null||v===void 0?void 0:v.db._options.cache)==="immutable",d=X,f=d.requery,m=d.signal,v=function(g,_,w,x){var A=vt["idb://".concat(g,"/").concat(_)];if(!A)return[];if(!(_=A.queries[w]))return[null,!1,A,null];var N=_[(x.query?x.query.index.name:null)||""];if(!N)return[null,!1,A,null];switch(w){case"query":var P=N.find(function(B){return B.req.limit===x.limit&&B.req.values===x.values&&ea(B.req.query.range,x.query.range)});return P?[P,!0,A,N]:[N.find(function(B){return("limit"in B.req?B.req.limit:1/0)>=x.limit&&(!x.values||B.req.values)&&to(B.req.query.range,x.query.range)}),!1,A,N];case"count":return P=N.find(function(B){return ea(B.req.query.range,x.query.range)}),[P,!!P,A,N]}}(t,n,"query",o),b=v[0],d=v[1],E=v[2],y=v[3];return b&&d?b.obsSet=o.obsSet:(d=r.query(o).then(function(g){var _=g.result;if(b&&(b.res=_),c){for(var w=0,x=_.length;w<x;++w)Object.freeze(_[w]);Object.freeze(_)}else g.result=De(_);return g}).catch(function(g){return y&&b&&$e(y,b),Promise.reject(g)}),b={obsSet:o.obsSet,promise:d,subscribers:new Set,type:"query",req:o,dirty:!1},y?y.push(b):(y=[b],(E=E||(vt["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[o.query.index.name||""]=y)),no(b,y,f,m),b.promise.then(function(g){return{result:Zr(g.result,o,E?.optimisticOps,r,b,c)}})}})}})}};function En(e,t){return new Proxy(e,{get:function(n,r,a){return r==="db"?t:Reflect.get(n,r,a)}})}var Xe=(Te.prototype.version=function(e){if(isNaN(e)||e<.1)throw new O.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new O.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort($a),n.stores({}),this._state.autoSchema=!1,n)},Te.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||X.letThrough||this._vip)?e():new V(function(n,r){if(t._state.openComplete)return r(new O.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new O.DatabaseClosed);t.open().catch(Z)}t._state.dbReadyPromise.then(n,r)}).then(e)},Te.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,a=e.name;return a&&this.unuse({stack:t,name:a}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:a}),e.sort(function(o,c){return o.level-c.level}),this},Te.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return r?a.create!==r:!!n&&a.name!==n})),this},Te.prototype.open=function(){var e=this;return ht(tt,function(){return Qa(e)})},Te.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=Ot.indexOf(this);if(0<=t&&Ot.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new V(function(n){e.dbReadyResolve=n}),e.openCanceller=new V(function(n,r){e.cancelOpen=r}))},Te.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new O.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new O.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},Te.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new V(function(a,o){function c(){t.close(e);var f=t._deps.indexedDB.deleteDatabase(t.name);f.onsuccess=ge(function(){var m,v,b;m=t._deps,v=t.name,b=m.indexedDB,m=m.IDBKeyRange,Hn(b)||v===sn||Qn(b,m).delete(v).catch(Z),a()}),f.onerror=We(o),f.onblocked=t._fireOnBlocked}if(n)throw new O.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(c):c()})},Te.prototype.backendDB=function(){return this.idbdb},Te.prototype.isOpen=function(){return this.idbdb!==null},Te.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Te.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Te.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Te.prototype,"tables",{get:function(){var e=this;return K(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Te.prototype.transaction=function(){var e=(function(t,n,r){var a=arguments.length;if(a<2)throw new O.InvalidArgument("Too few arguments");for(var o=new Array(a-1);--a;)o[a-1]=arguments[a];return r=o.pop(),[t,ut(o),r]}).apply(this,arguments);return this._transaction.apply(this,e)},Te.prototype._transaction=function(e,t,n){var r=this,a=X.trans;a&&a.db===this&&e.indexOf("!")===-1||(a=null);var o,c,f=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(c=t.map(function(v){if(v=v instanceof r.Table?v.name:v,typeof v!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return v}),e=="r"||e===qn)o=qn;else{if(e!="rw"&&e!=jn)throw new O.InvalidArgument("Invalid transaction mode: "+e);o=jn}if(a){if(a.mode===qn&&o===jn){if(!f)throw new O.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&c.forEach(function(v){if(a&&a.storeNames.indexOf(v)===-1){if(!f)throw new O.SubTransaction("Table "+v+" not included in parent transaction.");a=null}}),f&&a&&!a.active&&(a=null)}}catch(v){return a?a._promise(null,function(b,d){d(v)}):Ee(v)}var m=(function v(b,d,E,y,g){return V.resolve().then(function(){var _=X.transless||X,w=b._createTransaction(d,E,b._dbSchema,y);if(w.explicit=!0,_={trans:w,transless:_},y)w.idbtrans=y.idbtrans;else try{w.create(),w.idbtrans._explicit=!0,b._state.PR1398_maxLoop=3}catch(N){return N.name===u.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return v(b,d,E,null,g)})):Ee(N)}var x,A=qe(g);return A&&xt(),_=V.follow(function(){var N;(x=g.call(w,w))&&(A?(N=rt.bind(null,null),x.then(N,N)):typeof x.next=="function"&&typeof x.throw=="function"&&(x=ar(x)))},_),(x&&typeof x.then=="function"?V.resolve(x).then(function(N){return w.active?N:Ee(new O.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):_.then(function(){return x})).then(function(N){return y&&w._resolve(),w._completion.then(function(){return N})}).catch(function(N){return w._reject(N),Ee(N)})})}).bind(null,this,o,c,a,n);return a?a._promise(o,m,"lock"):X.trans?ht(X.transless,function(){return r._whenReady(m)}):this._whenReady(m)},Te.prototype.table=function(e){if(!$(this._allTables,e))throw new O.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Te);function Te(e,t){var n=this;this._middlewares={},this.verno=0;var r=Te.dependencies;this._options=t=p({addons:Te.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},r=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,o,c,f,m,v={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Z,dbReadyPromise:null,cancelOpen:Z,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};v.dbReadyPromise=new V(function(d){v.dbReadyResolve=d}),v.openCanceller=new V(function(d,E){v.cancelOpen=E}),this._state=v,this.name=e,this.on=Rt(this,"populate","blocked","versionchange","close",{ready:[_t,Z]}),this.once=function(d,E){var y=function(){for(var g=[],_=0;_<arguments.length;_++)g[_]=arguments[_];n.on(d).unsubscribe(y),E.apply(n,g)};return n.on(d,y)},this.on.ready.subscribe=J(this.on.ready.subscribe,function(d){return function(E,y){Te.vip(function(){var g,_=n._state;_.openComplete?(_.dbOpenError||V.resolve().then(E),y&&d(E)):_.onReadyBeingFired?(_.onReadyBeingFired.push(E),y&&d(E)):(d(E),g=n,y||d(function w(){g.on.ready.unsubscribe(E),g.on.ready.unsubscribe(w)}))})}}),this.Collection=(a=this,Kt(qa.prototype,function(x,w){this.db=a;var y=Cr,g=null;if(w)try{y=w()}catch(A){g=A}var _=x._ctx,w=_.table,x=w.hook.reading.fire;this._ctx={table:w,index:_.index,isPrimKey:!_.index||w.schema.primKey.keyPath&&_.index===w.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:g,or:_.or,valueMapper:x!==ye?x:null}})),this.Table=(o=this,Kt(Fr.prototype,function(d,E,y){this.db=o,this._tx=y,this.name=d,this.schema=E,this.hook=o._allTables[d]?o._allTables[d].hook:Rt(null,{creating:[et,Z],reading:[Pe,ye],updating:[je,Z],deleting:[xe,Z]})})),this.Transaction=(c=this,Kt(Ua.prototype,function(d,E,y,g,_){var w=this;d!=="readonly"&&E.forEach(function(x){x=(x=y[x])===null||x===void 0?void 0:x.yProps,x&&(E=E.concat(x.map(function(A){return A.updatesTable})))}),this.db=c,this.mode=d,this.storeNames=E,this.schema=y,this.chromeTransactionDurability=g,this.idbtrans=null,this.on=Rt(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new V(function(x,A){w._resolve=x,w._reject=A}),this._completion.then(function(){w.active=!1,w.on.complete.fire()},function(x){var A=w.active;return w.active=!1,w.on.error.fire(x),w.parent?w.parent._reject(x):A&&w.idbtrans&&w.idbtrans.abort(),Ee(x)})})),this.Version=(f=this,Kt(za.prototype,function(d){this.db=f,this._cfg={version:d,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(m=this,Kt(jr.prototype,function(d,E,y){if(this.db=m,this._ctx={table:d,index:E===":id"?null:E,or:y},this._cmp=this._ascending=ue,this._descending=function(g,_){return ue(_,g)},this._max=function(g,_){return 0<ue(g,_)?g:_},this._min=function(g,_){return ue(g,_)<0?g:_},this._IDBKeyRange=m._deps.IDBKeyRange,!this._IDBKeyRange)throw new O.MissingAPI})),this.on("versionchange",function(d){0<d.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(d){!d.newVersion||d.newVersion<d.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(d.oldVersion/10))}),this._maxKey=Ut(t.IDBKeyRange),this._createTransaction=function(d,E,y,g){return new n.Transaction(d,E,y,n._options.chromeTransactionDurability,g)},this._fireOnBlocked=function(d){n.on("blocked").fire(d),Ot.filter(function(E){return E.name===n.name&&E!==n&&!E._state.vcFired}).map(function(E){return E.on("versionchange").fire(d)})},this.use(Za),this.use(ro),this.use(eo),this.use(Ha),this.use(Ja);var b=new Proxy(this,{get:function(d,E,y){if(E==="_vip")return!0;if(E==="table")return function(_){return En(n.table(_),b)};var g=Reflect.get(d,E,y);return g instanceof Fr?En(g,b):E==="tables"?g.map(function(_){return En(_,b)}):E==="_createTransaction"?function(){return En(g.apply(this,arguments),b)}:g}});this.vip=b,r.forEach(function(d){return d(n)})}var Tn,Ke=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ao=(ur.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},ur.prototype[Ke]=function(){return this},ur);function ur(e){this._subscribe=e}try{Tn={indexedDB:D.indexedDB||D.mozIndexedDB||D.webkitIndexedDB||D.msIndexedDB,IDBKeyRange:D.IDBKeyRange||D.webkitIDBKeyRange}}catch{Tn={indexedDB:null,IDBKeyRange:null}}function ta(e){var t,n=!1,r=new ao(function(a){var o=qe(e),c,f=!1,m={},v={},b={get closed(){return f},unsubscribe:function(){f||(f=!0,c&&c.abort(),d&&it.storagemutated.unsubscribe(y))}};a.start&&a.start(b);var d=!1,E=function(){return Kn(g)},y=function(_){bn(m,_),er(v,m)&&E()},g=function(){var _,w,x;!f&&Tn.indexedDB&&(m={},_={},c&&c.abort(),c=new AbortController,x=function(A){var N=Et();try{o&&xt();var P=nt(e,A);return P=o?P.finally(rt):P}finally{N&&Tt()}}(w={subscr:_,signal:c.signal,requery:E,querier:e,trans:null}),Promise.resolve(x).then(function(A){n=!0,t=A,f||w.signal.aborted||(m={},function(N){for(var P in N)if($(N,P))return;return 1}(v=_)||d||(it(Lt,y),d=!0),Kn(function(){return!f&&a.next&&a.next(A)}))},function(A){n=!1,["DatabaseClosedError","AbortError"].includes(A?.name)||f||Kn(function(){f||a.error&&a.error(A)})}))};return setTimeout(E,0),b});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var gt=Xe;function cr(e){var t=st;try{st=!0,it.storagemutated.fire(e),rr(e,!0)}finally{st=t}}ne(gt,p(p({},ce),{delete:function(e){return new gt(e,{addons:[]}).delete()},exists:function(e){return new gt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=gt.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(Hn(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(a){return a.name}).filter(function(a){return a!==sn})}):Qn(n,t).toCollection().primaryKeys()).then(e)}catch{return Ee(new O.MissingAPI)}var t,n},defineClass:function(){return function(e){q(this,e)}},ignoreTransaction:function(e){return X.trans?ht(X.transless,e):e()},vip:Jn,async:function(e){return function(){try{var t=ar(e.apply(this,arguments));return t&&typeof t.then=="function"?t:V.resolve(t)}catch(n){return Ee(n)}}},spawn:function(e,t,n){try{var r=ar(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:V.resolve(r)}catch(a){return Ee(a)}},currentTransaction:{get:function(){return X.trans||null}},waitFor:function(e,t){return t=V.resolve(typeof e=="function"?gt.ignoreTransaction(e):e).timeout(t||6e4),X.trans?X.trans.waitFor(t):t},Promise:V,debug:{get:function(){return Be},set:function(e){kt(e)}},derive:C,extend:q,props:ne,override:J,Events:Rt,on:it,liveQuery:ta,extendObservabilitySet:bn,getByKeyPath:fe,setByKeyPath:oe,delByKeyPath:function(e,t){typeof t=="string"?oe(e,t,void 0):"length"in t&&[].map.call(t,function(n){oe(e,n,void 0)})},shallowClone:Ne,deepClone:De,getObjectDiff:or,cmp:ue,asap:ie,minKey:-1/0,addons:[],connections:Ot,errnames:u,dependencies:Tn,cache:vt,semVer:"4.2.0",version:"4.2.0".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),gt.maxKey=Ut(gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(it(Lt,function(e){st||(e=new CustomEvent(Vn,{detail:e}),st=!0,dispatchEvent(e),st=!1)}),addEventListener(Vn,function(e){e=e.detail,st||cr(e)}));var $t,st=!1,na=function(){};return typeof BroadcastChannel<"u"&&((na=function(){($t=new BroadcastChannel(Vn)).onmessage=function(e){return e.data&&cr(e.data)}})(),typeof $t.unref=="function"&&$t.unref(),it(Lt,function(e){st||$t.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Xe.disableBfCache&&e.persisted){Be&&console.debug("Dexie: handling persisted pagehide"),$t?.close();for(var t=0,n=Ot;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Xe.disableBfCache&&e.persisted&&(Be&&console.debug("Dexie: handling persisted pageshow"),na(),cr({all:new Ce(-1/0,[[]])}))})),V.rejectionMapper=function(e,t){return!e||e instanceof Je||e instanceof TypeError||e instanceof SyntaxError||!e.name||!T[e.name]?e:(t=new T[e.name](t||e.message,e),"stack"in e&&I(t,"stack",{get:function(){return this.inner.stack}}),t)},kt(Be),p(Xe,Object.freeze({__proto__:null,Dexie:Xe,liveQuery:ta,Entity:Ir,cmp:ue,PropModification:qt,replacePrefix:function(e,t){return new qt({replacePrefix:[e,t]})},add:function(e){return new qt({add:e})},remove:function(e){return new qt({remove:e})},default:Xe,RangeSet:Ce,mergeRanges:Gt,rangesOverlap:Gr}),{default:Xe}),Xe})}(vr)),vr.exports}var Ti=Ei();const gr=Pa(Ti),pa=Symbol.for("Dexie"),wt=globalThis[pa]||(globalThis[pa]=gr);if(gr.semVer!==wt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${gr.semVer} and ${wt.semVer}`);const{liveQuery:ns,mergeRanges:rs,rangesOverlap:as,RangeSet:os,cmp:is,Entity:ss,PropModification:us,replacePrefix:cs,add:ls,remove:fs,DexieYProvider:ds}=wt;function xi(s){const l=new wt(s);return l.version(1).stores({[Ht]:fa}),l.version(2).stores({[Ht]:fa,[ui]:ci}),l}async function Oi(s){const{databaseInstance:l,records:h}=s,p=l.table(Ht);await l.transaction("rw",p,()=>p.bulkAdd(h))}async function Si(s){if(await wt.exists(s))return await wt.delete(s)}const Ai={useBrowserApi:!0,chunkSize:32*1024,batchSize:2e3};async function pr({files:s,options:l=Ai}){const h=[];if(s.length===0)throw new Error("No files provided for import.");for(const p of s){if(!Ni(p)){console.error(`Unsupported file type: ${p.name}`);continue}p.size===0&&console.warn(`File is empty: ${p.name}`);const k=await Ci({file:p,options:l});h.push(k)}return h}function Ni(s){return si.some(l=>s.name.toLowerCase().endsWith(l))}function Pi(s){return s.name.replace(/\.[^.]+$/,"")}async function Ci(s){const{file:l,options:h}=s;try{const p=Pi(l);await Si(p);const k=xi(p);return h.useBrowserApi&&l.size!==0&&await Ii({file:l,databaseInstance:k,options:{chunkSize:h.chunkSize,batchSize:h.batchSize}}),p}catch(p){throw console.error(`Error importing file ${l.name}:`,p),p}}async function Ii(s){const{file:l,databaseInstance:h,options:p}=s,k=l.stream().getReader(),D=fi(),K=new TextDecoder,F=new Uint8Array(0);return await br({databaseInstance:h,reader:k,sax:D,textDecoder:K,buffer:F,options:p})}async function br(s){const{databaseInstance:l,reader:h,sax:p,textDecoder:k,buffer:D,options:K}=s,{chunkSize:F,batchSize:q}=K,{done:Q,value:H}=await h.read();if(Q){if(D.length>0){const ne=k.decode(D);p.parser.write(ne)}return p.parser.close(),await ha({databaseInstance:l,sax:p,batchSize:0})}if(!H)return await br(s);let $=new Uint8Array(D.length+H.length);for($.set(D),$.set(H,D.length);$.length>=F;){const ne=$.slice(0,F);$=$.slice(F);const G=k.decode(ne,{stream:!0});p.parser.write(G),await ha({databaseInstance:l,sax:p,batchSize:q})}return await br({...s,buffer:$})}async function ha(s){const{databaseInstance:l,sax:h,batchSize:p}=s;if(h.getSize()>=p){const k=h.drainBatch(),D=ai({currentBatch:k});await Oi({databaseInstance:l,records:D})}}const ki="_temp-idb-id";async function Di(s){return Fi({databaseName:s.databaseName,withDatabaseIds:!1})}async function Fi(s){const{databaseName:l,withDatabaseIds:h}=s,p=new wt(l);await p.open();const k=await Bi({databaseInstance:p,withDatabaseIds:h});if(!k)throw new Error("Failed to rebuild XML document from IndexedDB.");return{xmlDocument:k,filename:p.name+".scd"}}async function Bi(s){const{databaseInstance:l,withDatabaseIds:h}=s;{const p=document.implementation.createDocument("http://www.iec.ch/61850/2003/SCL",null,null),k=await l.table(Ht).where({tagName:"SCL"}).first();if(!k)throw new Error("No SCL root element found in DB");const D=p.createElementNS(k.namespace.uri,k.tagName);return D.setAttribute("xmlns",k.namespace.uri),k.attributes&&ka({document:p,element:D,attributes:k.attributes,isRoot:!0}),k.value&&(D.textContent=k.value.trim()),p.appendChild(D),await Ia({databaseInstance:l,withDatabaseIds:h,xmlDocument:p,databaseRecord:k,parentDomElement:D})}}async function Ia(s){const{databaseInstance:l,withDatabaseIds:h,xmlDocument:p,databaseRecord:k,parentDomElement:D}=s;if(!k.children)return;const K=k.children.map(q=>q.id),F=await l.table(Ht).bulkGet(K);for(const q of F){if(!q)continue;const Q=Mi({document:p,record:q,withDatabaseIds:h});D.appendChild(Q),await Ia({databaseInstance:l,withDatabaseIds:h,xmlDocument:p,databaseRecord:q,parentDomElement:Q})}return s.xmlDocument}function Mi(s){const{document:l,record:h,withDatabaseIds:p}=s;let k;return h.namespace.uri===Ca.default.uri?k=l.createElementNS(h.namespace.uri,h.tagName):k=l.createElementNS(h.namespace.uri,`${h.namespace.prefix}:${h.tagName}`),h.attributes&&ka({document:l,element:k,attributes:h.attributes,isRoot:!1}),h.value&&(k.textContent=h.value.trim()),p&&k.setAttribute(ki,h.id),k}function ka(s){const{document:l,element:h,attributes:p,isRoot:k}=s;for(const D of p)D.name!=="xmlns"&&(li(D)?(k||Ri({document:l,namespace:D.namespace}),h.setAttributeNS(D.namespace.uri,D.name,String(D.value))):h.setAttribute(D.name,String(D.value)))}function Ri(s){const{document:l,namespace:h}=s,p=l.documentElement;p&&(p.getAttribute(`xmlns:${h.prefix}`)!==null||p.setAttribute(`xmlns:${h.prefix}`,h.uri))}var An={exports:{}},hr={exports:{}},ma;function Ki(){return ma||(ma=1,function(s,l){Object.defineProperty(l,"__esModule",{value:!0}),l.ParsingError=void 0;class h extends Error{constructor(Y,ie){super(Y),this.cause=ie}}l.ParsingError=h;let p;function k(){return q(!1)||ne()||$()||H()||F(!1)}function D(){return C(/\s*/),q(!0)||$()||Q()||F(!1)}function K(){const J=F(!0),Y=[];let ie,fe=D();for(;fe;){if(fe.node.type==="Element"){if(ie)throw new Error("Found multiple root nodes");ie=fe.node}fe.excluded||Y.push(fe.node),fe=D()}if(!ie)throw new h("Failed to parse XML","Root Element not found");if(p.xml.length!==0)throw new h("Failed to parse XML","Not Well-Formed XML");return{declaration:J?J.node:null,root:ie,children:Y}}function F(J){const Y=C(J?/^<\?(xml(-stylesheet)?)\s*/:/^<\?([\w-:.]+)\s*/);if(!Y)return;const ie={name:Y[1],type:"ProcessingInstruction",attributes:{}};for(;!(z()||ae("?>"));){const fe=G();if(fe)ie.attributes[fe.name]=fe.value;else return}return C(/\?>/),{excluded:J?!1:p.options.filter(ie)===!1,node:ie}}function q(J){const Y=C(/^<([^?!</>\s]+)\s*/);if(!Y)return;const ie={type:"Element",name:Y[1],attributes:{},children:[]},fe=J?!1:p.options.filter(ie)===!1;for(;!(z()||ae(">")||ae("?>")||ae("/>"));){const Ne=G();if(Ne)ie.attributes[Ne.name]=Ne.value;else return}if(C(/^\s*\/>/))return ie.children=null,{excluded:fe,node:ie};C(/\??>/);let oe=k();for(;oe;)oe.excluded||ie.children.push(oe.node),oe=k();if(p.options.strictMode){const Ne=`</${ie.name}>`;if(p.xml.startsWith(Ne))p.xml=p.xml.slice(Ne.length);else throw new h("Failed to parse XML",`Closing tag not matching "${Ne}"`)}else C(/^<\/[\w-:.\u00C0-\u00FF]+\s*>/);return{excluded:fe,node:ie}}function Q(){const J=C(/^<!DOCTYPE\s+\S+\s+SYSTEM[^>]*>/)||C(/^<!DOCTYPE\s+\S+\s+PUBLIC[^>]*>/)||C(/^<!DOCTYPE\s+\S+\s*\[[^\]]*]>/)||C(/^<!DOCTYPE\s+\S+\s*>/);if(J){const Y={type:"DocumentType",content:J[0]};return{excluded:p.options.filter(Y)===!1,node:Y}}}function H(){if(p.xml.startsWith("<![CDATA[")){const J=p.xml.indexOf("]]>");if(J>-1){const Y=J+3,ie={type:"CDATA",content:p.xml.substring(0,Y)};return p.xml=p.xml.slice(Y),{excluded:p.options.filter(ie)===!1,node:ie}}}}function $(){const J=C(/^<!--[\s\S]*?-->/);if(J){const Y={type:"Comment",content:J[0]};return{excluded:p.options.filter(Y)===!1,node:Y}}}function ne(){const J=C(/^([^<]+)/);if(J){const Y={type:"Text",content:J[1]};return{excluded:p.options.filter(Y)===!1,node:Y}}}function G(){const J=C(/([^=]+)\s*=\s*("[^"]*"|'[^']*'|[^>\s]+)\s*/);if(J)return{name:J[1].trim(),value:I(J[2].trim())}}function I(J){return J.replace(/^['"]|['"]$/g,"")}function C(J){const Y=p.xml.match(J);if(Y)return p.xml=p.xml.slice(Y[0].length),Y}function z(){return p.xml.length===0}function ae(J){return p.xml.indexOf(J)===0}function be(J,Y={}){J=J.trim();const ie=Y.filter||(()=>!0);return p={xml:J,options:Object.assign(Object.assign({},Y),{filter:ie,strictMode:Y.strictMode===!0})},K()}s.exports=be,l.default=be}(hr,hr.exports)),hr.exports}var ya=An.exports,va;function qi(){return va||(va=1,function(s,l){var h=ya&&ya.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(l,"__esModule",{value:!0});const p=h(Ki());function k(I){if(!I.options.indentation&&!I.options.lineSeparator)return;I.content+=I.options.lineSeparator;let C;for(C=0;C<I.level;C++)I.content+=I.options.indentation}function D(I){I.content=I.content.replace(/ +$/,"");let C;for(C=0;C<I.level;C++)I.content+=I.options.indentation}function K(I,C){I.content+=C}function F(I,C,z){if(typeof I.content=="string")q(I.content,C,z);else if(I.type==="Element")H(I,C,z);else if(I.type==="ProcessingInstruction")ne(I,C);else throw new Error("Unknown node type: "+I.type)}function q(I,C,z){if(!z){const ae=I.trim();(C.options.lineSeparator||ae.length===0)&&(I=ae)}I.length>0&&(!z&&C.content.length>0&&k(C),K(C,I))}function Q(I,C){const z="/"+I.join("/"),ae=I[I.length-1];return C.includes(ae)||C.includes(z)}function H(I,C,z){if(C.path.push(I.name),!z&&C.content.length>0&&k(C),K(C,"<"+I.name),$(C,I.attributes),I.children===null||C.options.forceSelfClosingEmptyTag&&I.children.length===0){const ae=C.options.whiteSpaceAtEndOfSelfclosingTag?" />":"/>";K(C,ae)}else if(I.children.length===0)K(C,"></"+I.name+">");else{const ae=I.children;K(C,">"),C.level++;let be=I.attributes["xml:space"]==="preserve"||z,J=!1;if(!be&&C.options.ignoredPaths&&(J=Q(C.path,C.options.ignoredPaths),be=J),!be&&C.options.collapseContent){let Y=!1,ie=!1,fe=!1;ae.forEach(function(oe,Ne){oe.type==="Text"?(oe.content.includes(`
`)?(ie=!0,oe.content=oe.content.trim()):(Ne===0||Ne===ae.length-1)&&!z&&oe.content.trim().length===0&&(oe.content=""),(oe.content.trim().length>0||ae.length===1)&&(Y=!0)):oe.type==="CDATA"?Y=!0:fe=!0}),Y&&(!fe||!ie)&&(be=!0)}ae.forEach(function(Y){F(Y,C,z||be)}),C.level--,!z&&!be&&k(C),J&&D(C),K(C,"</"+I.name+">")}C.path.pop()}function $(I,C){Object.keys(C).forEach(function(z){const ae=C[z].replace(/"/g,"&quot;");K(I," "+z+'="'+ae+'"')})}function ne(I,C){C.content.length>0&&k(C),K(C,"<?"+I.name),$(C,I.attributes),K(C,"?>")}function G(I,C={}){C.indentation="indentation"in C?C.indentation:"    ",C.collapseContent=C.collapseContent===!0,C.lineSeparator="lineSeparator"in C?C.lineSeparator:`\r
`,C.whiteSpaceAtEndOfSelfclosingTag=C.whiteSpaceAtEndOfSelfclosingTag===!0,C.throwOnFailure=C.throwOnFailure!==!1;try{const z=(0,p.default)(I,{filter:C.filter,strictMode:C.strictMode}),ae={content:"",level:0,options:C,path:[]};return z.declaration&&ne(z.declaration,ae),z.children.forEach(function(be){F(be,ae,!1)}),C.lineSeparator?ae.content.replace(/\r\n/g,`
`).replace(/\n/g,C.lineSeparator):ae.content}catch(z){if(C.throwOnFailure)throw z;return I}}G.minify=(I,C={})=>G(I,Object.assign(Object.assign({},C),{indentation:"",lineSeparator:""})),s.exports=G,l.default=G}(An,An.exports)),An.exports}var ji=qi();const Li=Pa(ji);function Ui(s){return Li(s)}const Vi=Pn("file",()=>{const s=oa("currentActiveFileDatabaseName","",localStorage),l=oa("currentImportedDatabaseNames",[],localStorage),h=Qe(!1);async function p(){const{promise:q,resolve:Q}=Promise.withResolvers(),{open:H,onChange:$}=ia({accept:"asd"});return $(async ne=>{if(!ne||ne.length===0)return;const G=Array.from(ne),I=[];for(const z of G){const ae=z.name.replace(/\.[^.]+$/,"");(await(indexedDB.databases?.()||[])).some(Y=>Y.name===ae)&&!window.confirm(`A file named "${ae}" already exists in the database. Do you want to replace it?`)||I.push(z)}if(I.length===0){Q();return}const C=await pr({files:I});s.value=C[0],C.length&&console.info(`Files imported successfully: ${C.join(", ")}`),Q()}),H(),q}async function k(){try{if(!s.value)throw new Error("No active file to save - please open a file first");const q=await Di({databaseName:s.value}),ne=`<?xml version="1.0" encoding="UTF-8"?>
`+new XMLSerializer().serializeToString(q.xmlDocument),G=Ui(ne),I=new Blob([G],{type:"application/xml"}),C=Uo(I);if(!C.value)throw new Error("Failed to create object URL for the XML document");const z=document.createElement("a");z.href=C.value,z.download=q.filename,document.body.appendChild(z),z.click(),setTimeout(()=>{document.body.removeChild(z)},0)}catch(q){throw console.error("Error saving file:",q),q}}async function D(){const{promise:q,resolve:Q}=Promise.withResolvers(),{open:H,onChange:$}=ia({accept:"fsd"});return $(async ne=>{if(!ne||ne.length===0)return;const G=Array.from(ne),I=await pr({files:G});l.value=[...l.value,...I],Q()}),H(),q}async function K(q){if((await(indexedDB.databases?.()||[])).some(z=>z.name===q)&&!window.confirm(`A file named "${q}" already exists in the database. Do you want to replace it?`))return;const $=()=>crypto.randomUUID(),ne=`
				<?xml version="1.0" encoding="UTF-8"?>
				<SCL xmlns="http://www.iec.ch/61850/2003/SCL" version="2007" revision="C" release="5">
  				<Header id="${q}" version="0" revision="1" toolID="SeptKit Set" uuid="${$()}"/>
					<Substation name="TEMPLATE" uuid="${$()}">
						<VoltageLevel name="TEMPLATE" uuid="${$()}">
						 <Bay name="TEMPLATE" uuid="${$()}">
						 </Bay>
						</VoltageLevel>
					</Substation>
				</SCL>
				`,G=`${q}.xml`,I=new File([ne],G,{type:"text/xml"}),C=await pr({files:[I]});C.length&&(s.value=C[0],window.alert(`New Project Created: ${q}`)),h.value=!1}function F(){h.value=!0}return{currentActiveFileDatabaseName:s,currentImportedDatabaseNames:l,newFileModalOpen:h,openFiles:p,saveFile:k,importFiles:D,openNewFileModal:F,createNewFile:K}});let mr;function Wi(){return mr||(mr=Gi()),mr}function Gi(){return{activeFileName:$i()}}function $i(){let s=[],l;const h=Vi();return Pt(()=>h.currentActiveFileDatabaseName,k),l=h.currentActiveFileDatabaseName,{get value(){return l},subscribe:p};function p(D){return s.push(D),function(){s=s.filter(F=>F!==D)}}function k(D){for(const K of s)K(D,l);l=D}}const Yi={class:"root",name:"widget-site"},Xi=["id"],zi=po({__name:"widget-site",props:{widget:{},rootId:{}},setup(s){const l=s,h=Wo(),p=Go();let k=Wi();const D=ho("widget-root");async function K(F){if(!F){console.info({msg:"no startFnUrl yet"});return}const q=await Qo(F);if(q){if(!D.value){console.error({msg:"could not find widget root",widgetRoot:D});return}D.value.innerHTML="",l.widget?.location==="mainArea"?h.unmountExtension=q(l.rootId,k):l.widget?.location==="primarySidebar"&&(p.unmountExtension=q(l.rootId,k))}}return _r(async()=>{l.widget?.startFnUrl&&K(l.widget.startFnUrl)}),(F,q)=>(vo(),mo("div",Yi,[yo("div",{class:"widget-root h-full",ref:"widget-root",id:l.rootId}," ",8,Xi)]))}}),ps=Vo(zi,[["__scopeId","data-v-a1849e70"]]);function hs(s,l){const h=Da(l);h.value=s}function ms(s,l){const h=Da(s);Pt(()=>h.value,p=>{p&&l(p)},{immediate:!0})}function Da(s){const l=s;return l.widgetPortal||(l.widgetPortal=go({value:void 0})),l.widgetPortal}export{ps as W,Vo as _,Wo as a,Ji as b,Go as c,Vi as d,es as e,Hi as f,ms as g,ts as l,hs as s,Zi as u};
